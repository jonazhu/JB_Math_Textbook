

<!DOCTYPE html>


<html lang="en" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>5. Systems of First-Order Differential Equations &#8212; An Introduction to Python Jupyter Notebooks for College Math Teachers</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="../../_static/styles/bootstrap.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=e353d410970836974a52" rel="stylesheet" />

  
  <link href="../../_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=e353d410970836974a52" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" href="../../_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=e353d410970836974a52" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52" />

    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script src="../../_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../_static/togglebutton.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../../_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'Undergrad/DifEq/DE5';</script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="6. Laplace Transforms" href="DE6.html" />
    <link rel="prev" title="4. Second-Order Differential Equations" href="DE4.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
  

<a class="navbar-brand logo" href="../../intro.html">
  
  
  
  
    
    
      
    
    
    <img src="../../_static/logo.png" class="logo__image only-light" alt="Logo image"/>
    <script>document.write(`<img src="../../_static/logo.png" class="logo__image only-dark" alt="Logo image"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../../intro.html">
                    An Introduction to  Python Jupyter Notebooks for College Math Teachers
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">PREFACE</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../JMM23.html">JMM 2023</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../PatternsSOLUTION.html">Patterns</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">BLACKBOARD MATH PUZZLES</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../elementary.html">Math on a Blackboard</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Elementary/Arithmetic/arithmetic.html">Arithmetic</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Elementary/Arithmetic/pascal.html">Pascal’s Triangle</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Elementary/Fractions/fractions.html">Fractions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Elementary/Vectors/vectors.html">Vectors</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Elementary/Subsets/subsets.html">Subsets</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Elementary/Polar/polar.html">Polar Coordinates</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Elementary/Cylindrical/cylindrical.html">Cylindrical Coordinates</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Elementary/Symmetry/alphabet.html">Symmetry</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Elementary/Fractals/fractals.html">Fractals</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Elementary/Discrete/trees/trees.html">Trees</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Elementary/Circuits/circuits.html">Circuits</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">GETTING STARTED WITH JNBS</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../PreCollege/GettingStarted/start.html">0. Getting Started with Jupyter Notebooks (JNBs)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../PreCollege/GettingStarted/Functions.html">1. Functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../PreCollege/GettingStarted/numpy.html">2 The Numerical Python (numpy) Library</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../PreCollege/GettingStarted/pandas.html">3 Pandas</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../PreCollege/GettingStarted/matplotlib.html">4 Matplotlib</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../PreCollege/GettingStarted/if.html">5. if Conditional Statements</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../PreCollege/GettingStarted/for.html">6. For Loops</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../PreCollege/GettingStarted/dataframes.html">7. Dataframes</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">PRE-COLLEGE STEAM OUTREACH Paul Isihara</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../DD.html">Data Detectives</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Celestial.html">Celestial Ministries  Outreach Program</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../PreCollege/Celestial/jnb1.html">1 Functions- Michael Jordan’s Highest Scoring Game</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../PreCollege/Celestial/jnb2.html">2 How bad is COVID by Chicago Zipcode</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../PreCollege/Celestial/jnb3.html">3. Pixel Images</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../PreCollege/Celestial/jnb4.html">4. Random Number Approximation of Pi</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../PreCollege/Celestial/jnb5.html">5. Name That Tune!</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../PreCollege/Celestial/jnb6.html">6. Word Clouds</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../PreCollege/Celestial/jnb7.html">7. Mapping Famous Chicagoans</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../PreCollege/Celestial/jnb8.html">8. Predicting Exemplary K-8 Chicago Schools</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../PreCollege/Celestial/jnb9.html">9. Simulating Formula One</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../PreCollege/Celestial/jnb10.html">10. It’s Christmas</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../PreCollege/Celestial/demo.html">11. After School Program Demo</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">PYTHON PROGRAMMING GUIDE Thomas VanDrunen</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../Intropy.html">Transition to College Curriculum</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Programming/Introduction_to_Python.html">Introduction to Python</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">PROBABILITY MODELS Laura Gross, Yiheng Liang</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../Prob.html">Probability Models</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../ProbStat/ProbIntro/chapter%20probability%20gross%20and%20liang_2023_06_08.html">Introduction</a></li>


<li class="toctree-l1"><a class="reference internal" href="../../ProbStat/ProbIntro/drivethru.html">Random Number Simulation of a Drive Thru</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">EXPLORATORY DATA ANALYSIS Laura Gross, Yiheng Liang</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../ExpDat/ExpData.html">0. Introduction</a></li>




</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">STATISTICAL INFERENCE Peter Jantsch, Claire Wagner</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../Stat.html">Statistical Inference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../ProbStat/StatInf/00_Instructor_Notes.html">Introduction and Instructor Notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../ProbStat/StatInf/01_Foundations.html">Foundations of Statistical Inference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../ProbStat/StatInf/02_Inference_Categorical.html">Hypothesis Testing for Categorical Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../ProbStat/StatInf/03_Inference_Numerical.html">Hypothesis Testing for Numerical Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../ProbStat/StatInf/04_Regression.html">Linear Regression</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">CALCULUS  Inne Singgih</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../Calculus/Intro.html">1. Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Calculus/2Functions.html">2. Functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Calculus/3Limits.html">3. Limits, Continuity, and Rates</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Calculus/4%20Derivatives.html">4.1 Derivatives and Derivative Notations</a></li>







<li class="toctree-l1"><a class="reference internal" href="../Calculus/5int/5int.html">5. Integrals</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Calculus/6%20Parametric%20Equations.html">6.1 Parametric Equations - Curves and Tangents</a></li>




<li class="toctree-l1"><a class="reference internal" href="../Calculus/7%20Sequences%20and%20Series.html">7.1 Sequences</a></li>





<li class="toctree-l1"><a class="reference internal" href="../Calculus/Solution%20to%20Calculus%20Exercises.html">Solution to Calculus Exercises</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">CALCULUS FOR DAILY LIFE  Wheaton College Team</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../AppliedCalc/twocommodity.html">1. Linear Systems and the 2 Commodity Model</a></li>
<li class="toctree-l1"><a class="reference internal" href="../AppliedCalc/marginal.html">2. Marginal and Average Cost</a></li>
<li class="toctree-l1"><a class="reference internal" href="../AppliedCalc/design.html">3. Max/Min and Object Design</a></li>
<li class="toctree-l1"><a class="reference internal" href="../AppliedCalc/cobbs.html">4. Optimization and Cobbs-Douglas Production</a></li>
<li class="toctree-l1"><a class="reference internal" href="../AppliedCalc/rates.html">5. Related Rates and Volumes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../AppliedCalc/football.html">6. Related Rates with Trig Functions and Football</a></li>
<li class="toctree-l1"><a class="reference internal" href="../AppliedCalc/jnb7.html">7. Probability Distributions and Drive Thrus</a></li>
<li class="toctree-l1"><a class="reference internal" href="../AppliedCalc/control.html">8. Normal Distribution and Process Control</a></li>
<li class="toctree-l1"><a class="reference internal" href="../AppliedCalc/ols.html">9. Partial Derivatives and OLS Regression</a></li>
<li class="toctree-l1"><a class="reference internal" href="../AppliedCalc/gini.html">10. Area Between Curves and the Gini Index</a></li>
<li class="toctree-l1"><a class="reference internal" href="../AppliedCalc/income.html">11. Integral Test and Income Streams</a></li>
<li class="toctree-l1"><a class="reference internal" href="../AppliedCalc/ode.html">12. Ordinary Differential Equations and Exponential Growth/Decay</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">LINEAR ALGEBRA Soheil Anbouhi</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../Linear.html">Linear Algebra</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Linear/0.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Linear/1.1.html">1.1 Systems of Linear Equations</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Linear/1.2.html">1.2 Matrix Equations</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Linear/1.3.html">1.3 Solution Set of Linear Systems.</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Linear/1.4.html">Answers to Exercises</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Linear/2.1.html">2.1 Matrix Algebra</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Linear/2.2.html">2.2 Transpose, Inverse and Trace of Matrices</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Linear/2.3.html">2.3 Determinant</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Linear/2.4.html">Answers to Exercises</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Linear/3.1.html">3.1 Subspaces of R^n</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Linear/3.2.html">3.2  Introduction to Linear Transformation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Linear/3.3.html">3.3 Kernel and Image of linear transformations</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Linear/3.4.html">3.4 Change of basis</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Linear/3.5.html">Answers to Exercises</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Linear/4.1.html">4.1 Eigenvalues and Eigenvectors</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Linear/4.2.html">4.2 Diagonalization</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Linear/4.3.html">4.3 Discrete Dynamical Systems</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Linear/4.4.html">Answers to Exercises</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Linear/5.1.html">5.1 Inner product and Orthogonality</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Linear/5.2.html">5.2 Orthogonal Projection</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Linear/5.3.html">5. 3 The Gram–Schmidt Process</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Linear/5.4.html">5.4 Least-Squares Problems</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Linear/5.5.html">Answers to Exercises</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">LINEAR ALGEBRA AND OPTIMIZATION FOR DATA ANALYSIS Wheaton College Team</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../Aplin.html">Applied Linear Algebra</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Advanced/LinearAlgebra/Introduction.html">1. Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Advanced/LinearAlgebra/OLS/jnb1.html">2. OLS Linear Regression</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Advanced/LinearAlgebra/KMeans/jnb2.html">3. K-means Clustering</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Advanced/LinearAlgebra/PCA/jnb3.html">4. Dimension Reduction by Principal Component Analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Advanced/LinearAlgebra/SVM/jnb4.html">5. Binary Classification of Labelled Data by Support Vector Machines</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">DIFFERENTIAL EQUATIONS Rachel Petrik</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../DifEq.html">Differential Equations</a></li>
<li class="toctree-l1"><a class="reference internal" href="Differential%20Equations.html">1. Overview of Chapter</a></li>
<li class="toctree-l1"><a class="reference internal" href="DE2.html">2. Introduction to Differential Equations</a></li>
<li class="toctree-l1"><a class="reference internal" href="DE3.html">3. First-Order Differential Equations</a></li>
<li class="toctree-l1"><a class="reference internal" href="DE4.html">4. Second-Order Differential Equations</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">5. Systems of First-Order Differential Equations</a></li>
<li class="toctree-l1"><a class="reference internal" href="DE6.html">6. Laplace Transforms</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">DIFFERENTIAL EQUATIONS FOR THE BENEFIT OF SOCIETY Wheaton College Team</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../AppliedDifEq/covid.html">1. Logistic Growth and COVID-19</a></li>
<li class="toctree-l1"><a class="reference internal" href="../AppliedDifEq/sir.html">2. The Basic SIR Model</a></li>
<li class="toctree-l1"><a class="reference internal" href="../AppliedDifEq/cholera.html">3. Cholera in Haiti</a></li>
<li class="toctree-l1"><a class="reference internal" href="../AppliedDifEq/hiv/hiv.html">4. HIV-AIDS</a></li>
<li class="toctree-l1"><a class="reference internal" href="../AppliedDifEq/cws/cws.html">5. CWS Model of Alzheimemer’s Disease</a></li>
<li class="toctree-l1"><a class="reference internal" href="../AppliedDifEq/gravity/gravity.html">6. Gravity Fed Water Delivery</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">COMPLEX VARIABLES IN GROUNDWATER MODELING Wheaton College Team</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../Advanced/Complex/jnb1.html">1. Setting the Scene</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Advanced/Complex/jnb2.html">2. Complex Analysis Background</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Advanced/Complex/jnb3.html">3. Idealized Groundwater Flow</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Advanced/Complex/jnb4.html">4. Contaminant Extraction Modeling</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Advanced/Complex/Complex_Potentials.html">Complex Potentials</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Advanced/Complex/model.html">Fischer-Calo Contaminant Model</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">ADVANCED DATA ANALYSIS Ying Li, Jonathan Zhu</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../AdvData.html">Advanced Data Analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Advanced/AdvDataAnalysis/sec0_data.html">0. Before Reading</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Advanced/AdvDataAnalysis/sec1_preprocessing.html">1. Preprocessing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Advanced/AdvDataAnalysis/sec2_transform_features.html">2. About Text Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Advanced/AdvDataAnalysis/sec3_doc_embedding.html">3. Document Embedding</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Advanced/AdvDataAnalysis/sec4_classification_algos.html">4. Classification of Texts</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Advanced/AdvDataAnalysis/sec5_classification_eval.html">5. Evaluating Classification</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Advanced/AdvDataAnalysis/sec6_applications.html">6. Applications</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book/issues/new?title=Issue%20on%20page%20%2FUndergrad/DifEq/DE5.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../../_sources/Undergrad/DifEq/DE5.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>


<script>
document.write(`
  <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
  </button>
`);
</script>

<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>5. Systems of First-Order Differential Equations</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#introduction-to-systems-of-linear-differential-equations">5.1 Introduction to Systems of Linear Differential Equations</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#solving-homogeneous-linear-systems-with-constant-coefficients">5.2 Solving Homogeneous Linear Systems with Constant Coefficients</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#solving-non-homogeneous-linear-systems-with-constant-coefficients">5.3 Solving Non-Homogeneous Linear Systems with Constant Coefficients</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#the-phase-plan-for-autonomous-systems">5.4 The Phase Plan for Autonomous Systems</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#geometric-behavior-of-homogeneous-linear-systems">5.5 Geometric Behavior of Homogeneous Linear Systems</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#the-phase-plan-for-nonlinear-autonomous-systems">5.6 The Phase Plan for Nonlinear Autonomous Systems</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#exercises">Exercises</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="systems-of-first-order-differential-equations">
<h1>5. Systems of First-Order Differential Equations<a class="headerlink" href="#systems-of-first-order-differential-equations" title="Permalink to this heading">#</a></h1>
<p>This chapter offers an exploration into an essential component of the mathematical toolkit, used across numerous scientific and engineering disciplines. As we already know, differential equations are mathematical statements that describe the rates at which quantities change. However, reality often presents us with scenarios where multiple interrelated quantities are changing simultaneously. Enter the realm of systems of differential equations, a powerful extension of single differential equations, allowing us to model and understand a multitude of complex phenomena.</p>
<p>In this chapter, we specifically focus on systems of first-order differential equations. First-order means that only the first derivative of the function(s) appears in the system, but this doesn’t imply simplicity. Even with this limitation, these systems can model a wide array of phenomena, from predator-prey relationships in ecology to interconnected circuits in electronics, oscillating chemical reactions, and the spread of diseases in populations, among many others.</p>
<section id="introduction-to-systems-of-linear-differential-equations">
<h2>5.1 Introduction to Systems of Linear Differential Equations<a class="headerlink" href="#introduction-to-systems-of-linear-differential-equations" title="Permalink to this heading">#</a></h2>
<p>A <strong>system of first-order differential equations</strong> in <span class="math notranslate nohighlight">\(n\)</span> unknown functions <span class="math notranslate nohighlight">\(x_1(t), x_2(t), \dots, x_n(t)\)</span> is a collection of <span class="math notranslate nohighlight">\(n\)</span> differential equations with <span class="math notranslate nohighlight">\(n\)</span> dependent variables. That is,
$<span class="math notranslate nohighlight">\(\dfrac{dx_1}{dt} = f_1(t, x_1, x_2, \dots, x_n)\)</span><span class="math notranslate nohighlight">\(
\)</span><span class="math notranslate nohighlight">\(\dfrac{dx_2}{dt} = f_2(t, x_1, x_2, \dots, x_n)\)</span><span class="math notranslate nohighlight">\(
\)</span><span class="math notranslate nohighlight">\(\vdots\)</span><span class="math notranslate nohighlight">\(
\)</span><span class="math notranslate nohighlight">\(\dfrac{dx_n}{dt} = f_n(t, x_1, x_2, \dots, x_n).\)</span>$</p>
<p>In this case, a solution is a collection of <span class="math notranslate nohighlight">\(n\)</span> functions satisfying all of these equations. We should also note that every order <span class="math notranslate nohighlight">\(n\)</span> differential equation can be written as a system of <span class="math notranslate nohighlight">\(n\)</span> first-order differential equations.</p>
<p><strong>Example</strong> Write the differential equation <span class="math notranslate nohighlight">\(x'''+4x''+2x'+x=t^2+\cos(t)\)</span> as a system of three first-order differential equations.</p>
<p>First we will define new variables. Let <span class="math notranslate nohighlight">\(x_1 = x, x_2=x', x_3 = x''\)</span>. Then</p>
<div class="math notranslate nohighlight">
\[x'''+4x''+2x'+x= x_3'+4x_3+2x_2+x_1 = t^2+\cos(t).\]</div>
<p>Rewriting this as a system yields</p>
<div class="math notranslate nohighlight">
\[x_1' = x_2\]</div>
<div class="math notranslate nohighlight">
\[x_2' = x_3\]</div>
<div class="math notranslate nohighlight">
\[x_3' = -x_1-2x_2-4x_3+t^2+\cos(t)\]</div>
<p><strong>Example</strong> Find a system of first-order differential equations which are equivalent to the system
$<span class="math notranslate nohighlight">\(x'' = x+y\cos(t)\)</span><span class="math notranslate nohighlight">\(
\)</span><span class="math notranslate nohighlight">\(y'' = x\ln(t)+y'.\)</span>$</p>
<p>First we will define new variables. Let <span class="math notranslate nohighlight">\(x_1 = x, x_2=x', y_1 = y, y_2 = y'\)</span>.</p>
<p>Rewriting this as a system yields</p>
<div class="math notranslate nohighlight">
\[x_1' = x_2\]</div>
<div class="math notranslate nohighlight">
\[x_2' = x_1+y_1\cos(t)\]</div>
<div class="math notranslate nohighlight">
\[y_1' = y_2\]</div>
<div class="math notranslate nohighlight">
\[y_2' = x_1\ln(t)+y_2\]</div>
<p>A <strong>system of linear first-order differential equations</strong> (or simply <strong>linear system</strong> in <span class="math notranslate nohighlight">\(n\)</span> unknown functions <span class="math notranslate nohighlight">\(x_1(t), x_2(t), \dots, x_n(t)\)</span> is a system of the form
$<span class="math notranslate nohighlight">\(x_1' = a_{11}(t)x_1 + a_{12}(t)x_2 + \dots + a_{1n}(t)x_n + b_1(t)\)</span><span class="math notranslate nohighlight">\(
\)</span><span class="math notranslate nohighlight">\(x_2' = a_{21}(t)x_1 + a_{22}(t)x_2 + \dots + a_{2n}(t)x_n + b_2(t)\)</span><span class="math notranslate nohighlight">\(
\)</span><span class="math notranslate nohighlight">\(\vdots\)</span><span class="math notranslate nohighlight">\(
\)</span><span class="math notranslate nohighlight">\(x_n' = a_{n1}(t)x_1 + a_{n2}(t)x_2 + \dots + a_{nn}(t)x_n + b_n(t)\)</span>$</p>
<p>where <span class="math notranslate nohighlight">\(a_{ij}(t)\)</span> and <span class="math notranslate nohighlight">\(b_i(t)\)</span> are arbitrary functions in the independent variable <span class="math notranslate nohighlight">\(t\)</span>. If <span class="math notranslate nohighlight">\(b_i(t)=0\)</span> for all <span class="math notranslate nohighlight">\(1 \leq i \leq n\)</span>, we say that the linear system is <strong>homogeneous</strong>. The number of dependent variable of the linear system is called the <strong>dimension</strong> of the system.</p>
</section>
<section id="solving-homogeneous-linear-systems-with-constant-coefficients">
<h2>5.2 Solving Homogeneous Linear Systems with Constant Coefficients<a class="headerlink" href="#solving-homogeneous-linear-systems-with-constant-coefficients" title="Permalink to this heading">#</a></h2>
<p>The set <span class="math notranslate nohighlight">\(\{v_1(t), v_2(t), \dots, v_n(t)\}\)</span> where <span class="math notranslate nohighlight">\(v_i(t) = \begin{bmatrix} v_{i1}(t) \\ v_{i2}(t) \\ \vdots \\ v_{in}(t) \end{bmatrix}\)</span> is called <strong>linearly dependent</strong> if there exists scalars <span class="math notranslate nohighlight">\(c_1, c_2, \dots, c_n \in \mathbb{R}\)</span>, at least one of which is not zero, such that
$<span class="math notranslate nohighlight">\(c_1v_1(t) + c_2v_2(t) + \dots + c_nv_n(t) = 0.\)</span>$
If no such scalars exists, the set of vector functions is <strong>linearly independent</strong>.</p>
<p><em>Note: We saw the same notion for functions and vectors when looking at solving linear (usually second order) homogeneous differential equations with constant coefficients.</em></p>
<p><strong>Example</strong></p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(\biggl\{\begin{bmatrix} e^{2t} \\ e^{3t} \end{bmatrix}, \begin{bmatrix} e^{3t} \\ e^{2t} \end{bmatrix}\biggr\}\)</span> are linearly independent.</p></li>
<li><p><span class="math notranslate nohighlight">\(\biggl\{\begin{bmatrix} e^{2t} \\ e^{3t} \end{bmatrix}, \begin{bmatrix} 4e^{2t} \\ 4e^{3t} \end{bmatrix}\biggr\}\)</span> are linearly dependent as <span class="math notranslate nohighlight">\(4\begin{bmatrix} e^{2t} \\ e^{3t} \end{bmatrix} - \begin{bmatrix} 4e^{2t} \\ 4e^{3t} \end{bmatrix} = \begin{bmatrix} 0 \\ 0 \end{bmatrix}\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(\biggl\{v_1(t) = \begin{bmatrix} \sin(t) \\ t \end{bmatrix}, v_2(t)= \begin{bmatrix} \sin(t) \\ 3t \end{bmatrix}, v_3(t) = \begin{bmatrix} 0 \\ -2t \end{bmatrix}\biggr\}\)</span> are linearly dependent as <span class="math notranslate nohighlight">\(v_1(t)-v_2(t)-v_3(t) =\vec{0}\)</span>.</p></li>
</ul>
<p>If <span class="math notranslate nohighlight">\(x' = Ax\)</span> is a homogeneous linear system of first-order differential equations with <span class="math notranslate nohighlight">\(n \times n\)</span> coefficient matrix <span class="math notranslate nohighlight">\(A\)</span>, any set of <span class="math notranslate nohighlight">\(n\)</span> linearly independent vector solutions to the system on a given interval <span class="math notranslate nohighlight">\(I\)</span> is called a <strong>fundamental set of solutions</strong> to the system. If <span class="math notranslate nohighlight">\(\{v_1(t), v_2(t), \dots, v_n(t)\}\)</span> is a fundamental set of solutions, then
$<span class="math notranslate nohighlight">\(x(t) = c_1v_1(t) + c_2v_2(t) + \dots + c_nv_n(t)\)</span>$
is called the <strong>general solution</strong>.</p>
<p><strong>Example</strong> Consider the system
$<span class="math notranslate nohighlight">\( x' = \begin{bmatrix} 5 &amp; -4 \\ 2 &amp; -1 \end{bmatrix}x.\)</span><span class="math notranslate nohighlight">\(
Verify that \)</span>\biggl{ \begin{bmatrix} 2e^{3t} \ e^{3t} \end{bmatrix}, \begin{bmatrix} e^t \ e^t \end{bmatrix} \biggr}$ forms a fundamental solution set.</p>
<p>Step 1: Substituting in both vectors from the fundamental solution set to the left hand side yields</p>
<div class="math notranslate nohighlight">
\[\begin{split}\frac{d}{dt}\left( \begin{bmatrix} 2e^{3t} \\ e^{3t} \end{bmatrix}\right) = \begin{bmatrix} 6e^{3t} \\ 3^{3t} \end{bmatrix}\end{split}\]</div>
<p>and
$<span class="math notranslate nohighlight">\(\frac{d}{dt}\left( \begin{bmatrix} e^t \\ e^t \end{bmatrix}\right) = \begin{bmatrix} e^t \\ e^t \end{bmatrix}.\)</span>$</p>
<p>Step 2: Substituting in both vectors from the fundamental solution set to the right hand side yields</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{bmatrix} 5 &amp; -4 \\ 2 &amp; -1 \end{bmatrix}\begin{bmatrix} 2e^{3t} \\ e^{3t} \end{bmatrix} = \begin{bmatrix} 10e^{3t}-4e^{3t} \\ 4e^{3t}-e^{3t} \end{bmatrix} = \begin{bmatrix} 6e^{3t} \\ 3e^{3t} \end{bmatrix}\end{split}\]</div>
<p>and
$<span class="math notranslate nohighlight">\(\begin{bmatrix} 5 &amp; -4 \\ 2 &amp; -1 \end{bmatrix}\begin{bmatrix} e^{t} \\ e^{3t} \end{bmatrix} = \begin{bmatrix} 5e^{t}-4e^{t} \\ 2e^{t}-e^{t} \end{bmatrix} = \begin{bmatrix} e^{t} \\ e^{t} \end{bmatrix}\)</span>$.</p>
<p>Step 3: Notice that both vectors are solutions to the system. Now to verify that they form a fundamental set of solutions, we simply need to check that the two vectors are linearly independent. Solving the system</p>
<div class="math notranslate nohighlight">
\[2c_1e^{3t}+c_2e^t = 0\]</div>
<div class="math notranslate nohighlight">
\[c_1e^{3t}+c_2e^t =0\]</div>
<p>gives that <span class="math notranslate nohighlight">\(c_1=c_2=0\)</span>. Thus the vectors are linearly independent.</p>
<p>This means the general solution to this system is <span class="math notranslate nohighlight">\(x(t) = c_1\begin{bmatrix} 2 \\ 1 \end{bmatrix}e^{3t} + c_2\begin{bmatrix} 1 \\ 1 \end{bmatrix}e^{t}\)</span>.</p>
<p><strong>Natural Question</strong> Where do the functions <span class="math notranslate nohighlight">\(e^t\)</span> and <span class="math notranslate nohighlight">\(e^{3t}\)</span> and the vectors <span class="math notranslate nohighlight">\(\begin{bmatrix} 2 \\ 1 \end{bmatrix}\)</span> and <span class="math notranslate nohighlight">\(\begin{bmatrix} 1 \\ 1 \end{bmatrix}\)</span> come from?</p>
<p>It turns out that these values come from the eigenvalues and eigenvectors of <span class="math notranslate nohighlight">\(\begin{bmatrix} 5 &amp; -4 \\ 2 &amp; -1 \end{bmatrix}\)</span>. So let’s compute those values!</p>
<div class="math notranslate nohighlight">
\[\det(A_\lambda I) = 0\]</div>
<div class="math notranslate nohighlight">
\[\begin{split}\det\left(\begin{bmatrix} 5-\lambda &amp; -4 \\ 2 &amp; -1-\lambda \end{bmatrix} \right)=0\end{split}\]</div>
<div class="math notranslate nohighlight">
\[(5 - \lambda)(-1-\lambda)-(-8)=0\]</div>
<div class="math notranslate nohighlight">
\[\lambda^2-4\lambda+3=0\]</div>
<div class="math notranslate nohighlight">
\[(\lambda-3)(\lambda-1)=0\]</div>
<p>Thus the eigenvalues are <span class="math notranslate nohighlight">\(\lambda=1\)</span> and <span class="math notranslate nohighlight">\(\lambda=3\)</span>.</p>
<p>Now we want to find the eigenvectors associated to each eigenvalue. Let’s start with <span class="math notranslate nohighlight">\(\lambda =1\)</span>.</p>
<p>Setting up the augmented matrix yields
$$\left[</p>
<div class="amsmath math notranslate nohighlight" id="equation-99b4cbf1-ec5a-40b5-a35a-a4062f4fa355">
<span class="eqno">(51)<a class="headerlink" href="#equation-99b4cbf1-ec5a-40b5-a35a-a4062f4fa355" title="Permalink to this equation">#</a></span>\[\begin{matrix}
    5-1 &amp; -4 \\
    2 &amp; -1-1  \\
  \end{matrix}\]</div>
<p>\left|
,
\begin{matrix}
0  \
0  \
\end{matrix}
\right.
\right] = \left[</p>
<div class="amsmath math notranslate nohighlight" id="equation-d2c81f81-5f74-4e82-a8d6-a362ca5c6ba8">
<span class="eqno">(52)<a class="headerlink" href="#equation-d2c81f81-5f74-4e82-a8d6-a362ca5c6ba8" title="Permalink to this equation">#</a></span>\[\begin{matrix}
    4 &amp; -4 \\
    2 &amp; -2  \\
  \end{matrix}\]</div>
<p>\left|
,
\begin{matrix}
0  \
0  \
\end{matrix}
\right.
\right] \approx \left[</p>
<div class="amsmath math notranslate nohighlight" id="equation-8f9f601b-02b3-4e7c-b70b-43e0de4d0d05">
<span class="eqno">(53)<a class="headerlink" href="#equation-8f9f601b-02b3-4e7c-b70b-43e0de4d0d05" title="Permalink to this equation">#</a></span>\[\begin{matrix}
    1 &amp; -1 \\
    0 &amp; 0  \\
  \end{matrix}\]</div>
<p>\left|
,
\begin{matrix}
0  \
0  \
\end{matrix}
\right.
\right]$$</p>
<p>Thus an eigenvector associated to <span class="math notranslate nohighlight">\(\lambda=1\)</span> is <span class="math notranslate nohighlight">\(\begin{bmatrix} 1 \\ 1 \end{bmatrix}\)</span>.</p>
<p>Let’s now consider <span class="math notranslate nohighlight">\(\lambda = 3\)</span>.</p>
<p>Setting up the augmented matrix yields
$$\left[</p>
<div class="amsmath math notranslate nohighlight" id="equation-1d748f6b-3872-4ee7-a276-286664394aaf">
<span class="eqno">(54)<a class="headerlink" href="#equation-1d748f6b-3872-4ee7-a276-286664394aaf" title="Permalink to this equation">#</a></span>\[\begin{matrix}
    2 &amp; -4 \\
    2 &amp; -4  \\
  \end{matrix}\]</div>
<p>\left|
,
\begin{matrix}
0  \
0  \
\end{matrix}
\right.
\right] \approx \left[</p>
<div class="amsmath math notranslate nohighlight" id="equation-83972d53-3177-4849-a698-8af304d861dd">
<span class="eqno">(55)<a class="headerlink" href="#equation-83972d53-3177-4849-a698-8af304d861dd" title="Permalink to this equation">#</a></span>\[\begin{matrix}
    1 &amp; -2 \\
    0 &amp; 0  \\
  \end{matrix}\]</div>
<p>\left|
,
\begin{matrix}
0  \
0  \
\end{matrix}
\right.
\right]$$</p>
<p>Thus an eigenvector associated to <span class="math notranslate nohighlight">\(\lambda=3\)</span> is <span class="math notranslate nohighlight">\(\begin{bmatrix} 2 \\ 1 \end{bmatrix}\)</span>.</p>
<p>Notice that these values recover the information from the fundamental solution set in the previous example.</p>
<p><strong>Theorem</strong> Let <span class="math notranslate nohighlight">\(A\)</span> be an <span class="math notranslate nohighlight">\(n \times n\)</span> matrix of real numbers with <span class="math notranslate nohighlight">\(n\)</span> distinct real eigenvalues <span class="math notranslate nohighlight">\(\lambda_1, \lambda_2, \dots, \lambda_n\)</span> with respective eigenvectors <span class="math notranslate nohighlight">\(v_1, v_2, \dots, v_n\)</span>. Then
$<span class="math notranslate nohighlight">\(\{v_1e^{\lambda_1 t}, v_2e^{\lambda_2 t}, \dots, v_ne^{\lambda_n t}\}\)</span><span class="math notranslate nohighlight">\(
is a fundamental set of solutions to the homogeneous linear system \)</span>x’ = Ax$.</p>
<p><strong>Example</strong> Solve the initial-value problem
$<span class="math notranslate nohighlight">\(x' = \begin{bmatrix} 5 &amp; 3 \\ 6 &amp; 2 \end{bmatrix}x, \quad x(0) = \begin{bmatrix} 0 \\ 3 \end{bmatrix}.\)</span>$</p>
<div class="math notranslate nohighlight">
\[\det(A-\lambda I) = 0\]</div>
<div class="math notranslate nohighlight">
\[\begin{split}\det\left(\begin{bmatrix} 5-\lambda &amp; 3 \\ 6 &amp; 2-\lambda \end{bmatrix} \right)=0\end{split}\]</div>
<div class="math notranslate nohighlight">
\[(5 - \lambda)(2-\lambda)-(18)=0\]</div>
<div class="math notranslate nohighlight">
\[\lambda^2-7\lambda-8=0\]</div>
<div class="math notranslate nohighlight">
\[(\lambda+1)(\lambda-8)=0\]</div>
<p>Thus the eigenvalues are <span class="math notranslate nohighlight">\(\lambda=-1\)</span> and <span class="math notranslate nohighlight">\(\lambda=8\)</span>.</p>
<p>Now we want to find the eigenvectors associated to each eigenvalue. Let’s start with <span class="math notranslate nohighlight">\(\lambda =-1\)</span>.</p>
<p>Setting up the augmented matrix yields
$$\left[</p>
<div class="amsmath math notranslate nohighlight" id="equation-67764d9d-13f7-476a-81e7-3fdfc7096809">
<span class="eqno">(56)<a class="headerlink" href="#equation-67764d9d-13f7-476a-81e7-3fdfc7096809" title="Permalink to this equation">#</a></span>\[\begin{matrix}
    5-(-1) &amp; 3 \\
    6 &amp; 2-(-1)  \\
  \end{matrix}\]</div>
<p>\left|
,
\begin{matrix}
0  \
0  \
\end{matrix}
\right.
\right] = \left[</p>
<div class="amsmath math notranslate nohighlight" id="equation-bd25fbe2-734a-4e7b-a8d5-a64c30f22fd8">
<span class="eqno">(57)<a class="headerlink" href="#equation-bd25fbe2-734a-4e7b-a8d5-a64c30f22fd8" title="Permalink to this equation">#</a></span>\[\begin{matrix}
    6 &amp; 3 \\
    6 &amp; 3  \\
  \end{matrix}\]</div>
<p>\left|
,
\begin{matrix}
0  \
0  \
\end{matrix}
\right.
\right] \approx \left[</p>
<div class="amsmath math notranslate nohighlight" id="equation-51414e5e-d8a9-47fe-87c4-71f822c50ae2">
<span class="eqno">(58)<a class="headerlink" href="#equation-51414e5e-d8a9-47fe-87c4-71f822c50ae2" title="Permalink to this equation">#</a></span>\[\begin{matrix}
    1 &amp; \frac{1}{2} \\
    0 &amp; 0  \\
  \end{matrix}\]</div>
<p>\left|
,
\begin{matrix}
0  \
0  \
\end{matrix}
\right.
\right]$$</p>
<p>Thus an eigenvector associated to <span class="math notranslate nohighlight">\(\lambda=-1\)</span> is <span class="math notranslate nohighlight">\(\begin{bmatrix} \frac{-1}{2} \\ 1 \end{bmatrix}\)</span>.</p>
<p>Let’s now consider <span class="math notranslate nohighlight">\(\lambda = 8\)</span>.</p>
<p>Setting up the augmented matrix yields
$$\left[</p>
<div class="amsmath math notranslate nohighlight" id="equation-9c3380d4-605f-4682-ac1d-b06359964d14">
<span class="eqno">(59)<a class="headerlink" href="#equation-9c3380d4-605f-4682-ac1d-b06359964d14" title="Permalink to this equation">#</a></span>\[\begin{matrix}
    -3 &amp; 3 \\
    6 &amp; -6  \\
  \end{matrix}\]</div>
<p>\left|
,
\begin{matrix}
0  \
0  \
\end{matrix}
\right.
\right] \approx \left[</p>
<div class="amsmath math notranslate nohighlight" id="equation-ac90387e-62d9-4713-9222-c503317e71a0">
<span class="eqno">(60)<a class="headerlink" href="#equation-ac90387e-62d9-4713-9222-c503317e71a0" title="Permalink to this equation">#</a></span>\[\begin{matrix}
    1 &amp; -1 \\
    0 &amp; 0  \\
  \end{matrix}\]</div>
<p>\left|
,
\begin{matrix}
0  \
0  \
\end{matrix}
\right.
\right]$$</p>
<p>Thus an eigenvector associated to <span class="math notranslate nohighlight">\(\lambda=8\)</span> is <span class="math notranslate nohighlight">\(\begin{bmatrix} 1 \\ 1 \end{bmatrix}\)</span>.</p>
<p>This means the general solution to this system is <span class="math notranslate nohighlight">\(x(t) = c_1\begin{bmatrix} \frac{-1}{2} \\ 1 \end{bmatrix}e^{-t} + c_2\begin{bmatrix} 1 \\ 1 \end{bmatrix}e^{8t}\)</span>.</p>
<p>Using the initial condition, we find that
$<span class="math notranslate nohighlight">\(\begin{bmatrix} 0 \\ 3 \end{bmatrix} = c_1\begin{bmatrix} \frac{-1}{2} \\ 1 \end{bmatrix}e^{-(0)} + c_2\begin{bmatrix} 1 \\ 1 \end{bmatrix}e^{8(0)}\)</span><span class="math notranslate nohighlight">\(
\)</span><span class="math notranslate nohighlight">\(\begin{bmatrix} 0 \\ 3 \end{bmatrix} = c_1\begin{bmatrix} \frac{-1}{2} \\ 1 \end{bmatrix} + c_2\begin{bmatrix} 1 \\ 1 \end{bmatrix}\)</span>$</p>
<p>This is equivalent to solving
$<span class="math notranslate nohighlight">\(0 = \frac{-1}{2}c_1 + c_2\)</span><span class="math notranslate nohighlight">\(
\)</span><span class="math notranslate nohighlight">\(3 = c_1+c_2.\)</span>$</p>
<p>Solving this system for <span class="math notranslate nohighlight">\(c_1\)</span> and <span class="math notranslate nohighlight">\(c_2\)</span> gives <span class="math notranslate nohighlight">\(c_1=2\)</span> and <span class="math notranslate nohighlight">\(c_2=1\)</span>.</p>
<p>Thus the solution to the initial value problem is <span class="math notranslate nohighlight">\(x(t) = 2\begin{bmatrix} \frac{-1}{2} \\ 1 \end{bmatrix}e^{-t} + \begin{bmatrix} 1 \\ 1 \end{bmatrix}e^{8t}\)</span>.</p>
<p>Now let’s consider what happens when we do not have <span class="math notranslate nohighlight">\(n\)</span> distinct eigenvalues. In other words, what happens when an eigenvalue occurs with some multiplicity.</p>
<p><strong>Motivating Example</strong> Consider the following matrices
$<span class="math notranslate nohighlight">\( B = \begin{bmatrix} 2 &amp; 0 &amp; 0 \\ 0 &amp; 1 &amp; 1 \\ 0 &amp; 1 &amp; 1 \end{bmatrix} \quad \quad C=\begin{bmatrix} 3 &amp; 1 \\ -1 &amp; 1 \end{bmatrix}.\)</span><span class="math notranslate nohighlight">\(
Both of these matrices have \)</span>\lambda=2$ as an eigenvalue with multiplicity 2.</p>
<p>In the case of matrix <span class="math notranslate nohighlight">\(B\)</span>, <span class="math notranslate nohighlight">\(\lambda=2\)</span> has two linearly independent eigenvectors <span class="math notranslate nohighlight">\(\begin{bmatrix} 1 \\ 0 \\ 0 \end{bmatrix}\)</span> and <span class="math notranslate nohighlight">\(\begin{bmatrix} 0 \\ 1 \\ 1 \end{bmatrix}.\)</span> In this case, the procedure for finding the general solution to the equation <span class="math notranslate nohighlight">\(x'=Bx\)</span> has not changed from the previous examples.</p>
<p>However, in the case of matrix <span class="math notranslate nohighlight">\(C\)</span>, <span class="math notranslate nohighlight">\(\lambda=2\)</span> has only one eigenvector <span class="math notranslate nohighlight">\(\begin{bmatrix} -1 \\ 1\end{bmatrix}\)</span> despite having multiplicity 2. In this case, the procedure for finding the general solution to the equation <span class="math notranslate nohighlight">\(x'=Cx\)</span> will need to be changed as we do not have enough linearly independent pieces for our fundamental solution set.</p>
<p>Let <span class="math notranslate nohighlight">\(A\)</span> be an <span class="math notranslate nohighlight">\(n \times n\)</span> matrix with eigenvalue <span class="math notranslate nohighlight">\(\lambda\)</span> appearing with multiplicity <span class="math notranslate nohighlight">\(k\)</span> in the characteristic polynomial. The eigenvalue <span class="math notranslate nohighlight">\(\lambda\)</span> has at least 1 and at most <span class="math notranslate nohighlight">\(k\)</span> linearly independent eigenvectors. The eigenvalue <span class="math notranslate nohighlight">\(\lambda\)</span> is called <strong>defective</strong> if there are fewer than <span class="math notranslate nohighlight">\(k\)</span> linearly independent eigenvectors.</p>
<p>There are a few significant observations we should make about this example and subsequent definition. First, if a matrix has <span class="math notranslate nohighlight">\(n\)</span> distinct eigenvalues, none of the eigenvalues will be defective. Second, if <span class="math notranslate nohighlight">\(\lambda\)</span> is not defective, then the initial procedure we establish for distint real eigenvalues will still work. Finally, if <span class="math notranslate nohighlight">\(\lambda\)</span> is defective, we will need to produce at least one (if not more) additional solution to create the full fundamental solution set.</p>
<p><strong>Example</strong> Solve the linear system of differential equations
$<span class="math notranslate nohighlight">\(x' = \begin{bmatrix} 3 &amp; 1 \\ -1 &amp; 1 \end{bmatrix}x.\)</span>$</p>
<div class="math notranslate nohighlight">
\[\det(C-\lambda I) = 0\]</div>
<div class="math notranslate nohighlight">
\[\begin{split}\det\left(\begin{bmatrix} 3-\lambda &amp; 1 \\ -1 &amp; 1-\lambda \end{bmatrix} \right)=0\end{split}\]</div>
<div class="math notranslate nohighlight">
\[(3 - \lambda)(1-\lambda)-(-1)=0\]</div>
<div class="math notranslate nohighlight">
\[\lambda^2-4\lambda+4=0\]</div>
<div class="math notranslate nohighlight">
\[(\lambda-2)^2=0\]</div>
<p>Thus the eigenvalue is <span class="math notranslate nohighlight">\(\lambda=2\)</span> with multiplicity 2.</p>
<p>Now we want to find the eigenvector(s) associated with <span class="math notranslate nohighlight">\(\lambda=2\)</span>.</p>
<p>Setting up the augmented matrix yields
$$\left[</p>
<div class="amsmath math notranslate nohighlight" id="equation-0b83463a-6442-4a33-87ef-b45ee5532411">
<span class="eqno">(61)<a class="headerlink" href="#equation-0b83463a-6442-4a33-87ef-b45ee5532411" title="Permalink to this equation">#</a></span>\[\begin{matrix}
    3-(2) &amp; 1 \\
    -1 &amp; 1-(2)  \\
  \end{matrix}\]</div>
<p>\left|
,
\begin{matrix}
0  \
0  \
\end{matrix}
\right.
\right] = \left[</p>
<div class="amsmath math notranslate nohighlight" id="equation-baad2794-590a-4e70-bbaa-1d8774c2747a">
<span class="eqno">(62)<a class="headerlink" href="#equation-baad2794-590a-4e70-bbaa-1d8774c2747a" title="Permalink to this equation">#</a></span>\[\begin{matrix}
    1 &amp; 1 \\
    -1 &amp; -1  \\
  \end{matrix}\]</div>
<p>\left|
,
\begin{matrix}
0  \
0  \
\end{matrix}
\right.
\right] \approx \left[</p>
<div class="amsmath math notranslate nohighlight" id="equation-80752ef9-4b11-409a-8ded-69b7adbd144e">
<span class="eqno">(63)<a class="headerlink" href="#equation-80752ef9-4b11-409a-8ded-69b7adbd144e" title="Permalink to this equation">#</a></span>\[\begin{matrix}
    1 &amp; 1 \\
    0 &amp; 0  \\
  \end{matrix}\]</div>
<p>\left|
,
\begin{matrix}
0  \
0  \
\end{matrix}
\right.
\right]$$</p>
<p>Thus the eigenvector associated to <span class="math notranslate nohighlight">\(\lambda=2\)</span> is <span class="math notranslate nohighlight">\(\begin{bmatrix} -1 \\ 1 \end{bmatrix}\)</span>.</p>
<p>Let’s now guess another solution. The guess is <span class="math notranslate nohighlight">\(\begin{bmatrix} -1 \\ 1 \end{bmatrix} te^{2t}\)</span>. Notice
$<span class="math notranslate nohighlight">\(C\begin{bmatrix} -1 \\ 1 \end{bmatrix} te^{2t} = \begin{bmatrix} 3 &amp; 1 \\ -1 &amp; 1 \end{bmatrix} \begin{bmatrix} -1 \\ 1 \end{bmatrix} te^{2t} = \begin{bmatrix} -2 \\ 2 \end{bmatrix} te^{2t}\)</span><span class="math notranslate nohighlight">\(
and
\)</span><span class="math notranslate nohighlight">\(\frac{d}{dt}\left( \begin{bmatrix} -1 \\ 1 \end{bmatrix} te^{2t} \right) = \begin{bmatrix} -1 \\ 1 \end{bmatrix}e^{2t}+ \begin{bmatrix} -2 \\ 2 \end{bmatrix} te^{2t}.\)</span>$ Notice these are not quite equal, but they are close!</p>
<p>Let’s make a new guess. The guess is <span class="math notranslate nohighlight">\(\begin{bmatrix} -1 \\ 1 \end{bmatrix} te^{2t}+ \begin{bmatrix} w_1 \\ w_2 \end{bmatrix} e^{2t}\)</span> where <span class="math notranslate nohighlight">\(\begin{bmatrix} 3-2 &amp; 1 \\ -1 &amp; 1-2 \end{bmatrix} \begin{bmatrix} w_1 \\ w_2 \end{bmatrix} =\begin{bmatrix} -1 \\ 1 \end{bmatrix} \)</span>. We can verify that this new guess is in fact a solution!</p>
<p>This means the general solution to this system is <span class="math notranslate nohighlight">\(x(t) = c_1\begin{bmatrix} -1 \\ 1 \end{bmatrix}e^{2t} + c_2\left(\begin{bmatrix} -1 \\ 1 \end{bmatrix}te^{2t}+ \begin{bmatrix} -2 \\ 1 \end{bmatrix} e^{2t} \right)\)</span>.</p>
<p><strong>Theorem</strong> If <span class="math notranslate nohighlight">\(x'=Ax\)</span> is a homogeneous linear system and <span class="math notranslate nohighlight">\(\lambda\)</span> is a defective eigenvalue of multiplicity 2 with corresponding eigenvalue <span class="math notranslate nohighlight">\(v\)</span>, then
$<span class="math notranslate nohighlight">\(vte^{\lambda t} + we^{\lambda t}\)</span><span class="math notranslate nohighlight">\(
where \)</span>w<span class="math notranslate nohighlight">\( is any solution to
\)</span><span class="math notranslate nohighlight">\((A- \lambda I)w = v\)</span><span class="math notranslate nohighlight">\(
is another solution to \)</span>x’=Ax<span class="math notranslate nohighlight">\(. Moreover, this solution is linearly independent to the other solution associated with \)</span>\lambda$ by construction.</p>
<p>Now let’s consider what happens when we have complex eigenvalues. It turns out that in this case, we have a nice procedure we can follow. Suppose <span class="math notranslate nohighlight">\(A\)</span> has eigenvalues <span class="math notranslate nohighlight">\(\lambda = a \pm bi\)</span>. Then we can produce real valued solutions to <span class="math notranslate nohighlight">\(x' = Ax\)</span> associated to these eigenvalues as follows:</p>
<ol class="arabic simple">
<li><p>Choose <strong>one</strong> of the eigenvalues <span class="math notranslate nohighlight">\(\lambda = a \pm bi\)</span>.</p></li>
<li><p>Find an eigenvector <span class="math notranslate nohighlight">\(v\)</span> associated to <span class="math notranslate nohighlight">\(\lambda\)</span>.</p></li>
<li><p>Rewrite the solution <span class="math notranslate nohighlight">\(x(t) = ve^{\lambda t} = \text{ Re}(x(t))+i\text{Im}(x(t))\)</span> using Euler’s formula and algebra.</p></li>
<li><p><span class="math notranslate nohighlight">\(\text{Re}(x(t))\)</span> and <span class="math notranslate nohighlight">\(\text{Im}(x(t))\)</span> are real-valued solutions to the linear system of differential equations so we can add them to the fundamental solution set.</p></li>
</ol>
<p>Now let’s see this procedure applied to an example.</p>
<p><strong>Example</strong> Solve the linear system of differential equations
$<span class="math notranslate nohighlight">\(x' = \begin{bmatrix} 4 &amp; -10 \\ 2 &amp; -4 \end{bmatrix}x.\)</span>$</p>
<div class="math notranslate nohighlight">
\[\det(A-\lambda I) = 0\]</div>
<div class="math notranslate nohighlight">
\[\begin{split}\det\left(\begin{bmatrix} 4-\lambda &amp; -10 \\ 2 &amp; -4-\lambda \end{bmatrix} \right)=0\end{split}\]</div>
<div class="math notranslate nohighlight">
\[(4 - \lambda)(-4-\lambda)+(20)=0\]</div>
<div class="math notranslate nohighlight">
\[\lambda^2+4=0\]</div>
<p>Thus the eigenvalues are <span class="math notranslate nohighlight">\(\lambda=\pm 2i\)</span>.</p>
<p>Now we want to find the eigenvector associated with <span class="math notranslate nohighlight">\(\lambda=-2i\)</span>.</p>
<p>Setting up the augmented matrix yields
$$\left[</p>
<div class="amsmath math notranslate nohighlight" id="equation-34e61cc5-6dc4-446e-9650-a0489b756f3d">
<span class="eqno">(64)<a class="headerlink" href="#equation-34e61cc5-6dc4-446e-9650-a0489b756f3d" title="Permalink to this equation">#</a></span>\[\begin{matrix}
    4-(-2i) &amp; -10 \\
    2 &amp; -4-(-2i)  \\
  \end{matrix}\]</div>
<p>\left|
,
\begin{matrix}
0  \
0  \
\end{matrix}
\right.
\right] \approx \left[</p>
<div class="amsmath math notranslate nohighlight" id="equation-975e7066-53c0-47e8-a71c-18ca00b3ec7c">
<span class="eqno">(65)<a class="headerlink" href="#equation-975e7066-53c0-47e8-a71c-18ca00b3ec7c" title="Permalink to this equation">#</a></span>\[\begin{matrix}
    1 &amp; -2+i \\
    2 &amp; -4+2i  \\
  \end{matrix}\]</div>
<p>\left|
,
\begin{matrix}
0  \
0  \
\end{matrix}
\right.
\right] \approx \left[</p>
<div class="amsmath math notranslate nohighlight" id="equation-b1a5d519-00c4-43cd-b776-3425254c07e6">
<span class="eqno">(66)<a class="headerlink" href="#equation-b1a5d519-00c4-43cd-b776-3425254c07e6" title="Permalink to this equation">#</a></span>\[\begin{matrix}
    1 &amp; -2+i \\
    0 &amp; 0  \\
  \end{matrix}\]</div>
<p>\left|
,
\begin{matrix}
0  \
0  \
\end{matrix}
\right.
\right]$$</p>
<p>Thus the eigenvector associated to <span class="math notranslate nohighlight">\(\lambda=-2i\)</span> is <span class="math notranslate nohighlight">\(\begin{bmatrix} 2-i \\ 1 \end{bmatrix}\)</span>.</p>
<p>We also know that the eigenvector associated to <span class="math notranslate nohighlight">\(\lambda = 2i\)</span> is the complex conjugate of <span class="math notranslate nohighlight">\(\begin{bmatrix} 2-i \\ 1 \end{bmatrix}\)</span>. Thus the eigenvector associated to <span class="math notranslate nohighlight">\(\lambda = 2i\)</span> is <span class="math notranslate nohighlight">\(\begin{bmatrix} 2+i \\ 1 \end{bmatrix}\)</span>.</p>
<p>This means that a fundamental solution set is <span class="math notranslate nohighlight">\(\biggl\{\begin{bmatrix} 2-i \\ 1 \end{bmatrix}e^{-2it}, \begin{bmatrix} 2+i \\ 1 \end{bmatrix}e^{2it} \biggr\}\)</span>. But if we want a real-valued solution (which is better for interpreting physical situtations), we need to find a different fundamental solution set using the process outlined above.</p>
<p>Step 1 &amp; Step 2: Let <span class="math notranslate nohighlight">\(x_1(t) = \begin{bmatrix} 2+i \\ 1 \end{bmatrix}e^{2it}\)</span>.</p>
<p>Step 3: Using Euler’s formula and algebra <span class="math notranslate nohighlight">\(x_1(t)= \begin{bmatrix} 2+i \\ 1 \end{bmatrix}(\cos(2t)+i\sin(2t)) = \begin{bmatrix} 2\cos(2t)-\sin(2t) \\ \cos(2t) \end{bmatrix} + i \begin{bmatrix} \cos(2t)+2\sin(2t) \\ \sin(2t) \end{bmatrix}\)</span>.</p>
<p>Step 4: Create the new real-valued fundamental solution set from Step 3. The new fundamental solution set is <span class="math notranslate nohighlight">\(\{\text{Re}(x(t)), \text{Im}(x(t))\} = \biggl\{\begin{bmatrix} 2\cos(2t)-\sin(2t) \\ \cos(2t) \end{bmatrix}, \begin{bmatrix} \cos(2t)+2\sin(2t) \\ \sin(2t) \end{bmatrix} \biggr\}\)</span>.</p>
<p>This means that the general solution to this system of differential equations is $<span class="math notranslate nohighlight">\(x(t) = c_1\begin{bmatrix} 2\cos(2t)-\sin(2t) \\ \cos(2t) \end{bmatrix}+ c_2\begin{bmatrix} \cos(2t)+2\sin(2t) \\ \sin(2t) \end{bmatrix}.\)</span>$</p>
</section>
<section id="solving-non-homogeneous-linear-systems-with-constant-coefficients">
<h2>5.3 Solving Non-Homogeneous Linear Systems with Constant Coefficients<a class="headerlink" href="#solving-non-homogeneous-linear-systems-with-constant-coefficients" title="Permalink to this heading">#</a></h2>
<p>In Section 5.2, we discussed how to solve homogeneous linear systems with constant coefficients. What if we now wanted to solve non-homogeneous linear systems of differential equations? It turns out that there is a nice procedure for solving these. Let <span class="math notranslate nohighlight">\(x' = Ax+b\)</span> be a non-homogeneous linear system of differential equations. Then</p>
<ol class="arabic simple">
<li><p>Find the <strong>complementary function</strong> <span class="math notranslate nohighlight">\(x_c\)</span>, which is the general solution of the associated linear system <span class="math notranslate nohighlight">\(x'=Ax\)</span>.</p></li>
<li><p>Use the <strong>method of undetermined coefficients</strong> (i.e. guess a solution and solve for the coefficients) to produce a particular solution <span class="math notranslate nohighlight">\(x_p\)</span> of the original, non-homogeneous system.</p></li>
<li><p>Then the general solution <span class="math notranslate nohighlight">\(x = x_c + x_p\)</span>.</p></li>
<li><p>If initial conditions are given, use the general solution to and initial conditions to solve the initial value problem. <em>Note: This step must be done last.</em></p></li>
</ol>
<p>Prior to looking at an example, let’s see how we make the guess in Step 2. The goal is to “match” the form of the non-homogeneous part with our guess.</p>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="text-left head"><p><span class="math notranslate nohighlight">\(\vec{f(t)}\)</span></p></th>
<th class="text-left head"><p><span class="math notranslate nohighlight">\(\vec{x}_p(t) \text{ (These are your guesses)}\)</span></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-left"><p><span class="math notranslate nohighlight">\(\vec{a}_nt^n + \vec{a}_{n-1}t^{n-1} + \dots + \vec{a}_0\)</span></p></td>
<td class="text-left"><p><span class="math notranslate nohighlight">\(\vec{b}_nt^n + \vec{b}_{n-1}t^{n-1} + \dots + \vec{b}_0\)</span></p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p><span class="math notranslate nohighlight">\(\vec{b}e^{kt}\)</span></p></td>
<td class="text-left"><p><span class="math notranslate nohighlight">\(\vec{c}e^{kt}\)</span></p></td>
</tr>
<tr class="row-even"><td class="text-left"><p><span class="math notranslate nohighlight">\(\vec{b}\sin(kt)\)</span></p></td>
<td class="text-left"><p><span class="math notranslate nohighlight">\(\vec{c}\sin(kt)+\vec{d}\cos(kt)\)</span></p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p><span class="math notranslate nohighlight">\(\vec{b}\cos(kt)\)</span></p></td>
<td class="text-left"><p><span class="math notranslate nohighlight">\(\vec{c}\sin(kt)+\vec{d}\cos(kt)\)</span></p></td>
</tr>
</tbody>
</table>
<p><strong>Example</strong> Solve the non-homogeneous linear system of differential equations
$<span class="math notranslate nohighlight">\(x' = \begin{bmatrix} 3 &amp; 1 \\ -1 &amp; 1 \end{bmatrix}x + \begin{bmatrix} 4 \\ 4t \end{bmatrix}.\)</span>$</p>
<p>Step 1: Solve the homogeneous linear system <span class="math notranslate nohighlight">\(x' = \begin{bmatrix} 3 &amp; 1 \\ -1 &amp; 1 \end{bmatrix}x\)</span>. <em>Notice we already solved this in Section 5.2.</em> The general solution to the associated homogeneous system is <span class="math notranslate nohighlight">\(x_c(t) = c_1\begin{bmatrix} -1 \\ 1 \end{bmatrix} e^{2t} + c_2 \left(\begin{bmatrix} -1 \\ 1 \end{bmatrix} te^{2t} + \begin{bmatrix} -2 \\ 1 \end{bmatrix}e^{2t} \right).\)</span></p>
<p>Step 2: Guess a particular solution <span class="math notranslate nohighlight">\(x_p(t) = \begin{bmatrix} a+bt \\ c+dt \end{bmatrix}\)</span> and solve for the values of <span class="math notranslate nohighlight">\(a, b, c, d\)</span>. Notice that <span class="math notranslate nohighlight">\(4\)</span> is a degree 0 polynomial and <span class="math notranslate nohighlight">\(4t\)</span> is a degree 1 polynomial so for our guess, we guess an arbitrary degree 1 polynomial for each coordinate. Notice
$<span class="math notranslate nohighlight">\(\frac{d}{dt} \begin{bmatrix} a+bt \\ c+dt \end{bmatrix} = \begin{bmatrix} b \\ d \end{bmatrix}\)</span><span class="math notranslate nohighlight">\(
and 
\)</span><span class="math notranslate nohighlight">\(\begin{bmatrix} 3 &amp; 1 \\ -1 &amp; 1 \end{bmatrix}\begin{bmatrix} a+bt \\ c+dt \end{bmatrix}+\begin{bmatrix} 4 \\ 4t \end{bmatrix} = \begin{bmatrix} 3a+3bt+c+dt+4 \\ -a-bt+c+dt+4t \end{bmatrix}.\)</span>$</p>
<p>Setting the left hand side and right hand side equal to each other yields
$<span class="math notranslate nohighlight">\(3a+3bt+c+dt+4=b\)</span><span class="math notranslate nohighlight">\(
and 
\)</span><span class="math notranslate nohighlight">\(-a-bt+c+dt+4t=d\)</span>$.</p>
<p>This means that
$<span class="math notranslate nohighlight">\(3a-b+c=-4\)</span><span class="math notranslate nohighlight">\(
\)</span><span class="math notranslate nohighlight">\(3b+d = 0\)</span><span class="math notranslate nohighlight">\(
\)</span><span class="math notranslate nohighlight">\(-a+c-d=0\)</span><span class="math notranslate nohighlight">\(
\)</span><span class="math notranslate nohighlight">\(-b+d=4.\)</span>$</p>
<p>When we solve for <span class="math notranslate nohighlight">\(a, b, c, d\)</span> (using techniques found in the Linear Algebra chapter), we find that <span class="math notranslate nohighlight">\(a=0\)</span>, <span class="math notranslate nohighlight">\(b=1\)</span>, <span class="math notranslate nohighlight">\(c=-3\)</span>, and <span class="math notranslate nohighlight">\(d=-3\)</span>. This mean that the general solution to this non-homogeneous linear system is
$<span class="math notranslate nohighlight">\(x(t) = c_1\begin{bmatrix} -1 \\ 1 \end{bmatrix} e^{2t} + c_2 \left(\begin{bmatrix} -1 \\ 1 \end{bmatrix} te^{2t} + \begin{bmatrix} -2 \\ 1 \end{bmatrix}e^{2t} \right)+ \begin{bmatrix} t \\ -3-3t \end{bmatrix}.\)</span>$</p>
</section>
<section id="the-phase-plan-for-autonomous-systems">
<h2>5.4 The Phase Plan for Autonomous Systems<a class="headerlink" href="#the-phase-plan-for-autonomous-systems" title="Permalink to this heading">#</a></h2>
<p>A system of two first-order differential equations is called <strong>autonomous</strong> if it is of the form
$<span class="math notranslate nohighlight">\(\frac{dx}{dt} = f(x,y)\)</span><span class="math notranslate nohighlight">\(
\)</span><span class="math notranslate nohighlight">\(\frac{dy}{dt} = g(x,y).\)</span>$
In other words, it is called autonomous if only the dependent variables of the system appear in either equation.</p>
<p><em>Note</em>: This definition can be extended to systems of dimension <span class="math notranslate nohighlight">\(&gt;2\)</span> in the natural way. However, we can understand the geometry of autonomous systems of dimension 2 very well so that is where the focus will be.</p>
<p><strong>Example</strong></p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(\begin{cases}x' = x^2y+y-x \\ y' = x+y-xy\end{cases}\)</span> is an autonomous system.</p></li>
<li><p><span class="math notranslate nohighlight">\(\begin{cases}x' = x^2y+ty-x \\ y' = x+ty-t^2\end{cases}\)</span> is not an autonomous system because the independent variable <span class="math notranslate nohighlight">\(t\)</span> appears.</p></li>
</ul>
<p>A <strong>phase plane</strong> for an autonomous system $<span class="math notranslate nohighlight">\(\frac{dx}{dt} = f(x,y)\)</span><span class="math notranslate nohighlight">\(
\)</span><span class="math notranslate nohighlight">\(\frac{dy}{dt} = g(x,y)\)</span><span class="math notranslate nohighlight">\( is the grid \)</span>\mathbb{R}^2<span class="math notranslate nohighlight">\( in which vectors of the form \)</span><span class="math notranslate nohighlight">\(\vec{v} = x'(t)\vec{i} + y'(t)\vec{j} = \langle f(x,y), g(x,y) \rangle\)</span><span class="math notranslate nohighlight">\( have been drawn at a set of grid points \)</span>(x_i,y_i)$. A <strong>phase portrait</strong> for the autonomous system is a phase plane with enough solution curves drawn in to show how solutions behave in every part of the plane.</p>
<p><strong>Example</strong> Draw a phase plane and then a phase portrait for the system
$<span class="math notranslate nohighlight">\(x' = x(3-2x)-3xy\)</span><span class="math notranslate nohighlight">\(
\)</span><span class="math notranslate nohighlight">\(y' = -y+2xy.\)</span>$</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="c1"># Set the range of values for x and y</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">20</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">20</span><span class="p">)</span>

<span class="c1"># Create a grid of points (x, y)</span>
<span class="n">X</span><span class="p">,</span> <span class="n">Y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>

<span class="c1"># Define the system of equations</span>
<span class="n">dx</span> <span class="o">=</span> <span class="n">X</span><span class="o">*</span><span class="p">(</span><span class="mi">3</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">X</span><span class="p">)</span> <span class="o">-</span> <span class="mi">3</span><span class="o">*</span><span class="n">X</span><span class="o">*</span><span class="n">Y</span>
<span class="n">dy</span> <span class="o">=</span> <span class="o">-</span><span class="n">Y</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">X</span><span class="o">*</span><span class="n">Y</span>

<span class="c1"># Normalize the arrows to have the same length</span>
<span class="n">N</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">dx</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">dy</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<span class="n">dx</span> <span class="o">=</span> <span class="n">dx</span><span class="o">/</span><span class="n">N</span>
<span class="n">dy</span> <span class="o">=</span> <span class="n">dy</span><span class="o">/</span><span class="n">N</span>

<span class="c1"># Create the quiver plot</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">quiver</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">dx</span><span class="p">,</span> <span class="n">dy</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Phase Plane for the Autonomous System&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/efd77d0d6d838daeb7ce2b03d06cb22fac48bc336a9aeb9b1a915787f362d60f.png" src="../../_images/efd77d0d6d838daeb7ce2b03d06cb22fac48bc336a9aeb9b1a915787f362d60f.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">scipy.integrate</span> <span class="kn">import</span> <span class="n">odeint</span>

<span class="c1"># Define the range of values for x and y</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">20</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">20</span><span class="p">)</span>

<span class="c1"># Create a grid of points (x, y)</span>
<span class="n">X</span><span class="p">,</span> <span class="n">Y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>

<span class="c1"># Define the system of equations</span>
<span class="n">U</span> <span class="o">=</span> <span class="n">X</span><span class="o">*</span><span class="p">(</span><span class="mi">3</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">X</span><span class="p">)</span> <span class="o">-</span> <span class="mi">3</span><span class="o">*</span><span class="n">X</span><span class="o">*</span><span class="n">Y</span>
<span class="n">V</span> <span class="o">=</span> <span class="o">-</span><span class="n">Y</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">X</span><span class="o">*</span><span class="n">Y</span>

<span class="c1"># Normalize the arrows to have the same length</span>
<span class="n">N</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">U</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">V</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<span class="n">U</span> <span class="o">=</span> <span class="n">U</span><span class="o">/</span><span class="n">N</span>
<span class="n">V</span> <span class="o">=</span> <span class="n">V</span><span class="o">/</span><span class="n">N</span>

<span class="c1"># Define the system for odeint</span>
<span class="k">def</span> <span class="nf">dFdt</span><span class="p">(</span><span class="n">F</span><span class="p">,</span> <span class="n">t</span><span class="p">):</span>
    <span class="k">return</span> <span class="p">[</span><span class="n">F</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="mi">3</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">F</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">-</span> <span class="mi">3</span><span class="o">*</span><span class="n">F</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">F</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="o">-</span><span class="n">F</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">F</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">F</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span>

<span class="c1"># Set the time points where the solution is computed</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>  <span class="c1"># Negative times are included here</span>

<span class="c1"># Set a collection of initial conditions</span>
<span class="n">initial_conditions</span> <span class="o">=</span> <span class="p">[(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">)]</span>

<span class="c1"># Create the quiver plot</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">quiver</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">U</span><span class="p">,</span> <span class="n">V</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">)</span>

<span class="c1"># Loop over each initial condition and plot the solution curve</span>
<span class="k">for</span> <span class="n">ic</span> <span class="ow">in</span> <span class="n">initial_conditions</span><span class="p">:</span>
    <span class="n">F</span> <span class="o">=</span> <span class="n">odeint</span><span class="p">(</span><span class="n">dFdt</span><span class="p">,</span> <span class="n">ic</span><span class="p">,</span> <span class="n">t</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">F</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">F</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;Initial condition: </span><span class="si">{</span><span class="n">ic</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Phase Portrait for the Autonomous System&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/96364e356ec3e901c74f70a011eae211a64cb6a39bf28f39cb8ab0e6793981ce.png" src="../../_images/96364e356ec3e901c74f70a011eae211a64cb6a39bf28f39cb8ab0e6793981ce.png" />
</div>
</div>
<p>An <strong>equilibrium solution</strong> of an autonomous system $<span class="math notranslate nohighlight">\(\frac{dx}{dt} = f(x,y)\)</span><span class="math notranslate nohighlight">\(
\)</span><span class="math notranslate nohighlight">\(\frac{dy}{dt} = g(x,y)\)</span><span class="math notranslate nohighlight">\( is a constant solution \)</span>x(t) = \bar{x}<span class="math notranslate nohighlight">\(, \)</span>y(t)=\bar{y}<span class="math notranslate nohighlight">\( for which \)</span>f(\bar{x}, \bar{y})<span class="math notranslate nohighlight">\( and \)</span>g(\bar{x},\bar{y})$ are simultaneously 0. The point in the phase plane corresponding to an equilibrium solution is called an equilibrium point.</p>
<p><strong>Example</strong> Find the equilibrium solutions of the system and plot those points in the phase plane
$<span class="math notranslate nohighlight">\(x' = x(3-2x)-3xy\)</span><span class="math notranslate nohighlight">\(
\)</span><span class="math notranslate nohighlight">\(y' = -y+2xy.\)</span>$</p>
<p>To find the equilibrium solutions, we need to solve the system
$<span class="math notranslate nohighlight">\(3x-2x^2-3xy=0 \rightarrow x(3-2x-3y)=0\)</span><span class="math notranslate nohighlight">\(
\)</span><span class="math notranslate nohighlight">\(-y+2xy=0 \rightarrow y(-1+2x)=0\)</span>$.</p>
<p>This tells us that either <span class="math notranslate nohighlight">\(x=0\)</span> OR <span class="math notranslate nohighlight">\(3-2x-3y=0\)</span> or <span class="math notranslate nohighlight">\(y=0\)</span> OR <span class="math notranslate nohighlight">\(-1+2x=0\)</span>.</p>
<p>If <span class="math notranslate nohighlight">\(x=0\)</span>, then <span class="math notranslate nohighlight">\(y=0\)</span>. So <span class="math notranslate nohighlight">\((0,0)\)</span> is an equilibrium solution.</p>
<p>If <span class="math notranslate nohighlight">\(y=0\)</span> and <span class="math notranslate nohighlight">\(x \neq 0\)</span>, then <span class="math notranslate nohighlight">\(3-2x-3(0)=0 \rightarrow x=\frac{3}{2}\)</span>. So <span class="math notranslate nohighlight">\(\left(\frac{3}{2},0\right)\)</span> is an equilibrium solution.</p>
<p>If <span class="math notranslate nohighlight">\(-1+2x=0 \rightarrow x=\frac{1}{2}\)</span>, then <span class="math notranslate nohighlight">\(3-2\left(\frac{1}{2}\right)-3y=0 \rightarrow y=\frac{2}{3}\)</span>. So <span class="math notranslate nohighlight">\(\left(\frac{1}{2},\frac{2}{3}\right)\)</span> is the third and final equilibrium solution.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">scipy.integrate</span> <span class="kn">import</span> <span class="n">odeint</span>

<span class="c1"># Define the range of values for x and y</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">20</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">20</span><span class="p">)</span>

<span class="c1"># Create a grid of points (x, y)</span>
<span class="n">X</span><span class="p">,</span> <span class="n">Y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>

<span class="c1"># Define the system of equations</span>
<span class="n">U</span> <span class="o">=</span> <span class="n">X</span><span class="o">*</span><span class="p">(</span><span class="mi">3</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">X</span><span class="p">)</span> <span class="o">-</span> <span class="mi">3</span><span class="o">*</span><span class="n">X</span><span class="o">*</span><span class="n">Y</span>
<span class="n">V</span> <span class="o">=</span> <span class="o">-</span><span class="n">Y</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">X</span><span class="o">*</span><span class="n">Y</span>

<span class="c1"># Normalize the arrows to have the same length</span>
<span class="n">N</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">U</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">V</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<span class="n">U</span> <span class="o">=</span> <span class="n">U</span><span class="o">/</span><span class="n">N</span>
<span class="n">V</span> <span class="o">=</span> <span class="n">V</span><span class="o">/</span><span class="n">N</span>

<span class="c1"># Create the quiver plot</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">quiver</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">U</span><span class="p">,</span> <span class="n">V</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">)</span>

<span class="c1"># Plot the equilibrium points</span>
<span class="n">equilibrium_points</span> <span class="o">=</span> <span class="p">[(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">3</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="o">/</span><span class="mi">3</span><span class="p">)]</span>
<span class="k">for</span> <span class="n">eq_pt</span> <span class="ow">in</span> <span class="n">equilibrium_points</span><span class="p">:</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="o">*</span><span class="n">eq_pt</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Phase Plane for the Autonomous System&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>No artists with labels found to put in legend.  Note that artists whose label start with an underscore are ignored when legend() is called with no argument.
</pre></div>
</div>
<img alt="../../_images/60d59a3ef025057dde7670b388ae621d65d7a6fe6387e6505187b604ee331961.png" src="../../_images/60d59a3ef025057dde7670b388ae621d65d7a6fe6387e6505187b604ee331961.png" />
</div>
</div>
</section>
<section id="geometric-behavior-of-homogeneous-linear-systems">
<h2>5.5 Geometric Behavior of Homogeneous Linear Systems<a class="headerlink" href="#geometric-behavior-of-homogeneous-linear-systems" title="Permalink to this heading">#</a></h2>
<p>Let <span class="math notranslate nohighlight">\(A\)</span> be a <span class="math notranslate nohighlight">\(2 \times 2\)</span> matrix where <span class="math notranslate nohighlight">\(A\)</span> has two distinct real eigenvalues and consider the system <span class="math notranslate nohighlight">\(x' = Ax\)</span>:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(x'=Ax\)</span> has a unique solution for any initial condition <span class="math notranslate nohighlight">\((x_0,y_0) \in \mathbb{R}^2\)</span></p></li>
<li><p>If <span class="math notranslate nohighlight">\(\det(A) \neq 0\)</span>, then <span class="math notranslate nohighlight">\((0,0)\)</span> is the only equilibrium solution of <span class="math notranslate nohighlight">\(x' = Ax\)</span></p></li>
<li><p>The lines spanned by the eigenvectors form straight line solution curves</p></li>
<li><p>For large values of <span class="math notranslate nohighlight">\(t\)</span>, solutions will tend twoards the straight line solution for the largest eigenvalue (sometimes called the <strong>dominant eigenvalue</strong>)</p></li>
</ul>
<p>Subsequently, to describe the geometric behavior of the solutions, it is enough to draw the eigenvalue solutions, and one sample solution curve in each of the four regions.</p>
<p><strong>Example</strong> Consider the two-dimensional homogeneous linear system
$<span class="math notranslate nohighlight">\(x' = \begin{bmatrix} -4 &amp; -2 \\ 1 &amp; -1 \end{bmatrix}x\)</span><span class="math notranslate nohighlight">\(
which has eigenvalues \)</span>\lambda_1 = -3<span class="math notranslate nohighlight">\( and \)</span>\lambda_2 = -2<span class="math notranslate nohighlight">\( with respective eigenvectors \)</span>v_1 = \begin{bmatrix} -2 \ 1 \end{bmatrix}<span class="math notranslate nohighlight">\( and \)</span>v_2 = \begin{bmatrix} -1 \ 1 \end{bmatrix}$.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">scipy.integrate</span> <span class="kn">import</span> <span class="n">solve_ivp</span>

<span class="c1"># Define the system of equations</span>
<span class="k">def</span> <span class="nf">system</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">state</span><span class="p">):</span>
    <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">state</span>
    <span class="n">dx</span> <span class="o">=</span> <span class="o">-</span><span class="mi">4</span><span class="o">*</span><span class="n">x</span> <span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">y</span>
    <span class="n">dy</span> <span class="o">=</span> <span class="n">x</span> <span class="o">-</span> <span class="n">y</span>
    <span class="k">return</span> <span class="p">[</span><span class="n">dx</span><span class="p">,</span> <span class="n">dy</span><span class="p">]</span>

<span class="c1"># Set up the grid</span>
<span class="n">Y</span><span class="p">,</span> <span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mgrid</span><span class="p">[</span><span class="o">-</span><span class="mi">10</span><span class="p">:</span><span class="mi">10</span><span class="p">:</span><span class="mi">20</span><span class="n">j</span><span class="p">,</span> <span class="o">-</span><span class="mi">10</span><span class="p">:</span><span class="mi">10</span><span class="p">:</span><span class="mi">20</span><span class="n">j</span><span class="p">]</span>
<span class="n">DX</span><span class="p">,</span> <span class="n">DY</span> <span class="o">=</span> <span class="n">system</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="p">[</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">])</span>

<span class="c1"># Normalize vectors to a consistent length for visualization</span>
<span class="n">M</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">hypot</span><span class="p">(</span><span class="n">DX</span><span class="p">,</span> <span class="n">DY</span><span class="p">))</span>                           <span class="c1"># Norm of the growth rate </span>
<span class="n">M</span><span class="p">[</span><span class="n">M</span> <span class="o">==</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1.</span>                                 <span class="c1"># Avoid zero division errors </span>
<span class="n">DX</span> <span class="o">/=</span> <span class="n">M</span>                                        <span class="c1"># Normalize each arrows</span>
<span class="n">DY</span> <span class="o">/=</span> <span class="n">M</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>

<span class="c1"># Plot the vector field using quiver</span>
<span class="n">ax</span><span class="o">.</span><span class="n">quiver</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">DX</span><span class="p">,</span> <span class="n">DY</span><span class="p">,</span> <span class="n">M</span><span class="p">,</span> <span class="n">pivot</span><span class="o">=</span><span class="s1">&#39;mid&#39;</span><span class="p">)</span>

<span class="c1"># Define the eigenvalues and eigenvectors</span>
<span class="n">lambda1</span> <span class="o">=</span> <span class="o">-</span><span class="mi">3</span>
<span class="n">lambda2</span> <span class="o">=</span> <span class="o">-</span><span class="mi">2</span>
<span class="n">v1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="n">v2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>

<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">400</span><span class="p">)</span>

<span class="c1"># Plot the eigenvalue solutions</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="p">(</span><span class="n">v1</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="n">v1</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">*</span> <span class="n">x</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Eigenvalue λ1=-3&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="p">(</span><span class="n">v2</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="n">v2</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">*</span> <span class="n">x</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Eigenvalue λ2=-2&#39;</span><span class="p">)</span>

<span class="c1"># Plot solution curves for two initial conditions</span>
<span class="n">t_span</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">]</span> <span class="c1"># This will make the solution curves extend from t=-10 to t=10</span>
<span class="n">t_eval</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">400</span><span class="p">)</span>
<span class="k">for</span> <span class="n">initial_condition</span> <span class="ow">in</span> <span class="p">[(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">7</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="mi">4</span><span class="p">,</span> <span class="o">-</span><span class="mi">4</span><span class="p">)]:</span>
    <span class="n">sol</span> <span class="o">=</span> <span class="n">solve_ivp</span><span class="p">(</span><span class="n">system</span><span class="p">,</span> <span class="n">t_span</span><span class="p">,</span> <span class="n">initial_condition</span><span class="p">,</span> <span class="n">t_eval</span><span class="o">=</span><span class="n">t_eval</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">sol</span><span class="o">.</span><span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">sol</span><span class="o">.</span><span class="n">y</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;t&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span><span class="n">linewidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span><span class="n">linewidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">([</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">([</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">])</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/087dcc20a2fb7ad498e904031d2d9746d375864efa6c15ebf80eb80b6b9b52ce.png" src="../../_images/087dcc20a2fb7ad498e904031d2d9746d375864efa6c15ebf80eb80b6b9b52ce.png" />
</div>
</div>
<p>Notice that we can see from the phase plane that <span class="math notranslate nohighlight">\((0,0)\)</span> is a stable equilibrium. Also notice that as <span class="math notranslate nohighlight">\(t \rightarrow \infty\)</span>, the solutions approach the stable equilibrium.</p>
<p><strong>Example</strong> Consider the two-dimensional homogeneous linear system
$<span class="math notranslate nohighlight">\(x' = \begin{bmatrix} 7 &amp; 3 \\ 1 &amp; 5 \end{bmatrix}x\)</span><span class="math notranslate nohighlight">\(
which has eigenvalues \)</span>\lambda_1 = 4<span class="math notranslate nohighlight">\( and \)</span>\lambda_2 = 8<span class="math notranslate nohighlight">\( with respective eigenvectors \)</span>v_1 = \begin{bmatrix} -1 \ 1 \end{bmatrix}<span class="math notranslate nohighlight">\( and \)</span>v_2 = \begin{bmatrix} 1 \ \frac{1}{3} \end{bmatrix}$.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">scipy.integrate</span> <span class="kn">import</span> <span class="n">solve_ivp</span>

<span class="c1"># Define the system of equations</span>
<span class="k">def</span> <span class="nf">system</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">state</span><span class="p">):</span>
    <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">state</span>
    <span class="n">dx</span> <span class="o">=</span> <span class="mi">7</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span><span class="mi">3</span><span class="o">*</span><span class="n">y</span>
    <span class="n">dy</span> <span class="o">=</span> <span class="n">x</span> <span class="o">+</span> <span class="mi">5</span><span class="o">*</span><span class="n">y</span>
    <span class="k">return</span> <span class="p">[</span><span class="n">dx</span><span class="p">,</span> <span class="n">dy</span><span class="p">]</span>

<span class="c1"># Set up the grid</span>
<span class="n">Y</span><span class="p">,</span> <span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mgrid</span><span class="p">[</span><span class="o">-</span><span class="mi">10</span><span class="p">:</span><span class="mi">10</span><span class="p">:</span><span class="mi">20</span><span class="n">j</span><span class="p">,</span> <span class="o">-</span><span class="mi">10</span><span class="p">:</span><span class="mi">10</span><span class="p">:</span><span class="mi">20</span><span class="n">j</span><span class="p">]</span>
<span class="n">DX</span><span class="p">,</span> <span class="n">DY</span> <span class="o">=</span> <span class="n">system</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="p">[</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">])</span>

<span class="c1"># Normalize vectors to a consistent length for visualization</span>
<span class="n">M</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">hypot</span><span class="p">(</span><span class="n">DX</span><span class="p">,</span> <span class="n">DY</span><span class="p">))</span>                           <span class="c1"># Norm of the growth rate </span>
<span class="n">M</span><span class="p">[</span><span class="n">M</span> <span class="o">==</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1.</span>                                 <span class="c1"># Avoid zero division errors </span>
<span class="n">DX</span> <span class="o">/=</span> <span class="n">M</span>                                        <span class="c1"># Normalize each arrows</span>
<span class="n">DY</span> <span class="o">/=</span> <span class="n">M</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>

<span class="c1"># Plot the vector field using quiver</span>
<span class="n">ax</span><span class="o">.</span><span class="n">quiver</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">DX</span><span class="p">,</span> <span class="n">DY</span><span class="p">,</span> <span class="n">M</span><span class="p">,</span> <span class="n">pivot</span><span class="o">=</span><span class="s1">&#39;mid&#39;</span><span class="p">)</span>

<span class="c1"># Define the eigenvalues and eigenvectors</span>
<span class="n">lambda1</span> <span class="o">=</span> <span class="mi">4</span>
<span class="n">lambda2</span> <span class="o">=</span> <span class="mi">8</span>
<span class="n">v1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="n">v2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>

<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">400</span><span class="p">)</span>

<span class="c1"># Plot the eigenvalue solutions</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="p">(</span><span class="n">v1</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="n">v1</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">*</span> <span class="n">x</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Eigenvalue λ1=-3&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="p">(</span><span class="n">v2</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="n">v2</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">*</span> <span class="n">x</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Eigenvalue λ2=-2&#39;</span><span class="p">)</span>

<span class="c1"># Plot solution curves for two initial conditions</span>
<span class="n">t_span</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">]</span> <span class="c1"># This will make the solution curves extend from t=-10 to t=10</span>
<span class="n">t_eval</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">400</span><span class="p">)</span>
<span class="k">for</span> <span class="n">initial_condition</span> <span class="ow">in</span> <span class="p">[(</span><span class="mf">0.2</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.2</span><span class="p">)]:</span>
    <span class="n">sol</span> <span class="o">=</span> <span class="n">solve_ivp</span><span class="p">(</span><span class="n">system</span><span class="p">,</span> <span class="n">t_span</span><span class="p">,</span> <span class="n">initial_condition</span><span class="p">,</span> <span class="n">t_eval</span><span class="o">=</span><span class="n">t_eval</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">sol</span><span class="o">.</span><span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">sol</span><span class="o">.</span><span class="n">y</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;t&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span><span class="n">linewidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span><span class="n">linewidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">([</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">([</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">])</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/df640d9f374688b5a66907e8d10fae9419c81b31ad796f9941184957c23dc7a0.png" src="../../_images/df640d9f374688b5a66907e8d10fae9419c81b31ad796f9941184957c23dc7a0.png" />
</div>
</div>
<p>Notice that we can see from the phase plane that <span class="math notranslate nohighlight">\((0,0)\)</span> is an unstable equilibrium. Also notice that as <span class="math notranslate nohighlight">\(t \rightarrow \infty\)</span>, the solutions approach <span class="math notranslate nohighlight">\(\begin{bmatrix} 1 \\ \frac{1}{3} \end{bmatrix}e^{8t}\)</span>.</p>
<p><strong>Example</strong> Consider the two-dimensional homogeneous linear system
$<span class="math notranslate nohighlight">\(x' = \begin{bmatrix} 1 &amp; 4 \\ 2 &amp; -1 \end{bmatrix}x\)</span><span class="math notranslate nohighlight">\(
which has eigenvalues \)</span>\lambda_1 = -3<span class="math notranslate nohighlight">\( and \)</span>\lambda_2 = 3<span class="math notranslate nohighlight">\( with respective eigenvectors \)</span>v_1 = \begin{bmatrix} -1 \ 1 \end{bmatrix}<span class="math notranslate nohighlight">\( and \)</span>v_2 = \begin{bmatrix} 2 \ 1 \end{bmatrix}$.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">scipy.integrate</span> <span class="kn">import</span> <span class="n">solve_ivp</span>

<span class="c1"># Define the system of equations</span>
<span class="k">def</span> <span class="nf">system</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">state</span><span class="p">):</span>
    <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">state</span>
    <span class="n">dx</span> <span class="o">=</span> <span class="mi">1</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span><span class="mi">4</span><span class="o">*</span><span class="n">y</span>
    <span class="n">dy</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">x</span> <span class="o">-</span> <span class="n">y</span>
    <span class="k">return</span> <span class="p">[</span><span class="n">dx</span><span class="p">,</span> <span class="n">dy</span><span class="p">]</span>

<span class="c1"># Set up the grid</span>
<span class="n">Y</span><span class="p">,</span> <span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mgrid</span><span class="p">[</span><span class="o">-</span><span class="mi">10</span><span class="p">:</span><span class="mi">10</span><span class="p">:</span><span class="mi">20</span><span class="n">j</span><span class="p">,</span> <span class="o">-</span><span class="mi">10</span><span class="p">:</span><span class="mi">10</span><span class="p">:</span><span class="mi">20</span><span class="n">j</span><span class="p">]</span>
<span class="n">DX</span><span class="p">,</span> <span class="n">DY</span> <span class="o">=</span> <span class="n">system</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="p">[</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">])</span>

<span class="c1"># Normalize vectors to a consistent length for visualization</span>
<span class="n">M</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">hypot</span><span class="p">(</span><span class="n">DX</span><span class="p">,</span> <span class="n">DY</span><span class="p">))</span>                           <span class="c1"># Norm of the growth rate </span>
<span class="n">M</span><span class="p">[</span><span class="n">M</span> <span class="o">==</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1.</span>                                 <span class="c1"># Avoid zero division errors </span>
<span class="n">DX</span> <span class="o">/=</span> <span class="n">M</span>                                        <span class="c1"># Normalize each arrows</span>
<span class="n">DY</span> <span class="o">/=</span> <span class="n">M</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>

<span class="c1"># Plot the vector field using quiver</span>
<span class="n">ax</span><span class="o">.</span><span class="n">quiver</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">DX</span><span class="p">,</span> <span class="n">DY</span><span class="p">,</span> <span class="n">M</span><span class="p">,</span> <span class="n">pivot</span><span class="o">=</span><span class="s1">&#39;mid&#39;</span><span class="p">)</span>

<span class="c1"># Define the eigenvalues and eigenvectors</span>
<span class="n">lambda1</span> <span class="o">=</span> <span class="o">-</span><span class="mi">3</span>
<span class="n">lambda2</span> <span class="o">=</span> <span class="mi">3</span>
<span class="n">v1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="n">v2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>

<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">400</span><span class="p">)</span>

<span class="c1"># Plot the eigenvalue solutions</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="p">(</span><span class="n">v1</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="n">v1</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">*</span> <span class="n">x</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Eigenvalue λ1=-3&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="p">(</span><span class="n">v2</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="n">v2</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">*</span> <span class="n">x</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Eigenvalue λ2=-2&#39;</span><span class="p">)</span>

<span class="c1"># Plot solution curves for two initial conditions</span>
<span class="n">t_span</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">]</span> <span class="c1"># This will make the solution curves extend from t=-10 to t=10</span>
<span class="n">t_eval</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">400</span><span class="p">)</span>
<span class="k">for</span> <span class="n">initial_condition</span> <span class="ow">in</span> <span class="p">[(</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="mi">7</span><span class="p">),</span> <span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="o">-</span><span class="mi">6</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="mi">8</span><span class="p">),</span> <span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">)]:</span>
    <span class="n">sol</span> <span class="o">=</span> <span class="n">solve_ivp</span><span class="p">(</span><span class="n">system</span><span class="p">,</span> <span class="n">t_span</span><span class="p">,</span> <span class="n">initial_condition</span><span class="p">,</span> <span class="n">t_eval</span><span class="o">=</span><span class="n">t_eval</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">sol</span><span class="o">.</span><span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">sol</span><span class="o">.</span><span class="n">y</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;t&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span><span class="n">linewidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span><span class="n">linewidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">([</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">([</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">])</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/30cb6a866ec2589f17fef75e16b19db5e92d8679bc504611ca5c585ab26d6d4b.png" src="../../_images/30cb6a866ec2589f17fef75e16b19db5e92d8679bc504611ca5c585ab26d6d4b.png" />
</div>
</div>
<p>Notice that we can see from the phase plane that <span class="math notranslate nohighlight">\((0,0)\)</span> is a semi-stable equilibrium. In particular, if our initial condition started on <span class="math notranslate nohighlight">\(\begin{bmatrix} -1 \\ 1 \end{bmatrix}e^{-3t}\)</span>, then it will tend towards zero. But if the initial condition does not lie on that line, then the solutions tends towards <span class="math notranslate nohighlight">\(\begin{bmatrix} 2 \\ 1 \end{bmatrix}e^{3t}\)</span>.</p>
<p>Let <span class="math notranslate nohighlight">\(A\)</span> be a <span class="math notranslate nohighlight">\(2 \times 2\)</span> matrix where <span class="math notranslate nohighlight">\(A\)</span> has two complex eigenvalues, <span class="math notranslate nohighlight">\(\lambda = a \pm bi\)</span>, and consider the system <span class="math notranslate nohighlight">\(x' = Ax\)</span>:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(x'=Ax\)</span> has a unique solution for any initial condition <span class="math notranslate nohighlight">\((x_0,y_0) \in \mathbb{R}^2\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\((0,0)\)</span> is the only equilibrium solution of <span class="math notranslate nohighlight">\(x' = Ax\)</span></p></li>
<li><p>If <span class="math notranslate nohighlight">\(a=0\)</span>, the solutions are periodic and will form elliptic orbits around <span class="math notranslate nohighlight">\((0,0)\)</span></p></li>
<li><p>If <span class="math notranslate nohighlight">\(a&gt;0\)</span>, the solution curves will be elliptic spirals <em>away</em> from <span class="math notranslate nohighlight">\((0,0)\)</span></p></li>
<li><p>If <span class="math notranslate nohighlight">\(a&lt;0\)</span>, the solution curves will be elliptic spirals <em>toward</em> from <span class="math notranslate nohighlight">\((0,0)\)</span></p></li>
<li><p>The direction of the spiral (clockwise vs. counterclockwise) can be determined by checking a single test point.</p></li>
</ul>
<p>In general, we care about the correct behavior and the correct spin. We do not need additional detail.</p>
<p><strong>Example</strong> Consider the two-dimensional homogeneous linear system
$<span class="math notranslate nohighlight">\(x' = \begin{bmatrix} -1 &amp; 5 \\ -1 &amp; 1 \end{bmatrix}x\)</span><span class="math notranslate nohighlight">\(
which has eigenvalues \)</span>\lambda_1 = -2i<span class="math notranslate nohighlight">\( and \)</span>\lambda_2 = 2i<span class="math notranslate nohighlight">\( with respective eigenvectors \)</span>v_1 = \begin{bmatrix} 1-2i \ 1 \end{bmatrix}<span class="math notranslate nohighlight">\( and \)</span>v_2 = \begin{bmatrix} 1+2i \ 1 \end{bmatrix}$.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">scipy.integrate</span> <span class="kn">import</span> <span class="n">solve_ivp</span>

<span class="c1"># Define the system of equations</span>
<span class="k">def</span> <span class="nf">system</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">state</span><span class="p">):</span>
    <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">state</span>
    <span class="n">dx</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="mi">5</span><span class="o">*</span><span class="n">y</span>
    <span class="n">dy</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="n">y</span>
    <span class="k">return</span> <span class="p">[</span><span class="n">dx</span><span class="p">,</span> <span class="n">dy</span><span class="p">]</span>

<span class="c1"># Set up the grid</span>
<span class="n">Y</span><span class="p">,</span> <span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mgrid</span><span class="p">[</span><span class="o">-</span><span class="mi">20</span><span class="p">:</span><span class="mi">20</span><span class="p">:</span><span class="mi">40</span><span class="n">j</span><span class="p">,</span> <span class="o">-</span><span class="mi">20</span><span class="p">:</span><span class="mi">20</span><span class="p">:</span><span class="mi">40</span><span class="n">j</span><span class="p">]</span>
<span class="n">DX</span><span class="p">,</span> <span class="n">DY</span> <span class="o">=</span> <span class="n">system</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="p">[</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">])</span>

<span class="c1"># Normalize vectors to a consistent length for visualization</span>
<span class="n">M</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">hypot</span><span class="p">(</span><span class="n">DX</span><span class="p">,</span> <span class="n">DY</span><span class="p">))</span>
<span class="n">M</span><span class="p">[</span><span class="n">M</span> <span class="o">==</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1.</span>
<span class="n">DX</span> <span class="o">/=</span> <span class="n">M</span>
<span class="n">DY</span> <span class="o">/=</span> <span class="n">M</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>

<span class="c1"># Plot the vector field using quiver</span>
<span class="n">ax</span><span class="o">.</span><span class="n">quiver</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">DX</span><span class="p">,</span> <span class="n">DY</span><span class="p">,</span> <span class="n">M</span><span class="p">,</span> <span class="n">pivot</span><span class="o">=</span><span class="s1">&#39;mid&#39;</span><span class="p">)</span>

<span class="c1"># Define the eigenvalues and eigenvectors</span>
<span class="n">lambda1</span> <span class="o">=</span> <span class="o">-</span><span class="mi">2</span><span class="n">j</span>
<span class="n">lambda2</span> <span class="o">=</span> <span class="mi">2</span><span class="n">j</span>
<span class="n">v1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="o">-</span><span class="mi">2</span><span class="n">j</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="n">v2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="o">+</span><span class="mi">2</span><span class="n">j</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>

<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">800</span><span class="p">)</span>

<span class="c1"># Plot solution curves for two initial conditions</span>
<span class="n">t_span</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">]</span>
<span class="n">t_eval</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">t_span</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">t_span</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="mi">1000</span><span class="p">)</span>

<span class="k">for</span> <span class="n">initial_condition</span> <span class="ow">in</span> <span class="p">[(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">)]:</span>
    <span class="n">sol</span> <span class="o">=</span> <span class="n">solve_ivp</span><span class="p">(</span><span class="n">system</span><span class="p">,</span> <span class="n">t_span</span><span class="p">,</span> <span class="n">initial_condition</span><span class="p">,</span> <span class="n">t_eval</span><span class="o">=</span><span class="n">t_eval</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">sol</span><span class="o">.</span><span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">sol</span><span class="o">.</span><span class="n">y</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span><span class="n">linewidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span><span class="n">linewidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">([</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">([</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">])</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>No artists with labels found to put in legend.  Note that artists whose label start with an underscore are ignored when legend() is called with no argument.
</pre></div>
</div>
<img alt="../../_images/b5a6328e22f66db61d85a3dd887a8c65103daf121f5d0a961bcc10214e7a66ad.png" src="../../_images/b5a6328e22f66db61d85a3dd887a8c65103daf121f5d0a961bcc10214e7a66ad.png" />
</div>
</div>
<p><strong>Example</strong> Consider the two-dimensional homogeneous linear system
$<span class="math notranslate nohighlight">\(x' = \begin{bmatrix} -2 &amp; 5 \\ -1 &amp; 0 \end{bmatrix}x\)</span><span class="math notranslate nohighlight">\(
which has eigenvalues \)</span>\lambda_1 = -1-2i<span class="math notranslate nohighlight">\( and \)</span>\lambda_2 = -1+2i<span class="math notranslate nohighlight">\( with respective eigenvectors \)</span>v_1 = \begin{bmatrix} 1+2i \ 1 \end{bmatrix}<span class="math notranslate nohighlight">\( and \)</span>v_2 = \begin{bmatrix} 1-2i \ 1 \end{bmatrix}$.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">scipy.integrate</span> <span class="kn">import</span> <span class="n">solve_ivp</span>

<span class="c1"># Define the system of equations</span>
<span class="k">def</span> <span class="nf">system</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">state</span><span class="p">):</span>
    <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">state</span>
    <span class="n">dx</span> <span class="o">=</span> <span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="mi">5</span><span class="o">*</span><span class="n">y</span>
    <span class="n">dy</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="o">*</span><span class="n">x</span>
    <span class="k">return</span> <span class="p">[</span><span class="n">dx</span><span class="p">,</span> <span class="n">dy</span><span class="p">]</span>

<span class="c1"># Set up the grid</span>
<span class="n">Y</span><span class="p">,</span> <span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mgrid</span><span class="p">[</span><span class="o">-</span><span class="mi">20</span><span class="p">:</span><span class="mi">20</span><span class="p">:</span><span class="mi">40</span><span class="n">j</span><span class="p">,</span> <span class="o">-</span><span class="mi">20</span><span class="p">:</span><span class="mi">20</span><span class="p">:</span><span class="mi">40</span><span class="n">j</span><span class="p">]</span>
<span class="n">DX</span><span class="p">,</span> <span class="n">DY</span> <span class="o">=</span> <span class="n">system</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="p">[</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">])</span>

<span class="c1"># Normalize vectors to a consistent length for visualization</span>
<span class="n">M</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">hypot</span><span class="p">(</span><span class="n">DX</span><span class="p">,</span> <span class="n">DY</span><span class="p">))</span>
<span class="n">M</span><span class="p">[</span><span class="n">M</span> <span class="o">==</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1.</span>
<span class="n">DX</span> <span class="o">/=</span> <span class="n">M</span>
<span class="n">DY</span> <span class="o">/=</span> <span class="n">M</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>

<span class="c1"># Plot the vector field using quiver</span>
<span class="n">ax</span><span class="o">.</span><span class="n">quiver</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">DX</span><span class="p">,</span> <span class="n">DY</span><span class="p">,</span> <span class="n">M</span><span class="p">,</span> <span class="n">pivot</span><span class="o">=</span><span class="s1">&#39;mid&#39;</span><span class="p">)</span>

<span class="c1"># Define the eigenvalues and eigenvectors</span>
<span class="n">lambda1</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="o">-</span><span class="mi">2</span><span class="n">j</span>
<span class="n">lambda2</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="o">+</span><span class="mi">2</span><span class="n">j</span>
<span class="n">v1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="o">+</span><span class="mi">2</span><span class="n">j</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="n">v2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="o">-</span><span class="mi">2</span><span class="n">j</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>

<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">800</span><span class="p">)</span>

<span class="c1"># Plot solution curves for two initial conditions</span>
<span class="n">t_span</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">]</span>
<span class="n">t_eval</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">t_span</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">t_span</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="mi">1000</span><span class="p">)</span>

<span class="k">for</span> <span class="n">initial_condition</span> <span class="ow">in</span> <span class="p">[(</span><span class="mi">7</span><span class="p">,</span> <span class="mi">7</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="o">-</span><span class="mi">6</span><span class="p">)]:</span>
    <span class="n">sol</span> <span class="o">=</span> <span class="n">solve_ivp</span><span class="p">(</span><span class="n">system</span><span class="p">,</span> <span class="n">t_span</span><span class="p">,</span> <span class="n">initial_condition</span><span class="p">,</span> <span class="n">t_eval</span><span class="o">=</span><span class="n">t_eval</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">sol</span><span class="o">.</span><span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">sol</span><span class="o">.</span><span class="n">y</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span><span class="n">linewidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span><span class="n">linewidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">([</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">([</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">])</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>No artists with labels found to put in legend.  Note that artists whose label start with an underscore are ignored when legend() is called with no argument.
</pre></div>
</div>
<img alt="../../_images/c2d86a767e3edf45f48bedc0cc9ec8c33eb91b6e5ed3f5bab2c5a6c35e0f126b.png" src="../../_images/c2d86a767e3edf45f48bedc0cc9ec8c33eb91b6e5ed3f5bab2c5a6c35e0f126b.png" />
</div>
</div>
<p>Notice in this case, <span class="math notranslate nohighlight">\(\text{Re}(\lambda) = -1 &lt;0\)</span>, which tells us the spiral will move towards <span class="math notranslate nohighlight">\((0,0)\)</span>. We call this a spiral stable equilibrium. If <span class="math notranslate nohighlight">\(\text{Re}(\lambda) &gt; 0\)</span>, the spiral will move away from <span class="math notranslate nohighlight">\((0,0)\)</span> and is called a spiral unstable equilibrium (See Exercise 10).</p>
</section>
<section id="the-phase-plan-for-nonlinear-autonomous-systems">
<h2>5.6 The Phase Plan for Nonlinear Autonomous Systems<a class="headerlink" href="#the-phase-plan-for-nonlinear-autonomous-systems" title="Permalink to this heading">#</a></h2>
<p>The goal of the section is to understand the behavior or nonlinear systems of differential equations by sketching the phase plane.</p>
<p>Given an autonomous system
$<span class="math notranslate nohighlight">\(x' = f(x,y)\)</span><span class="math notranslate nohighlight">\(
\)</span><span class="math notranslate nohighlight">\(y' = g(x,y),\)</span><span class="math notranslate nohighlight">\(
the **nullclines** for \)</span>x’<span class="math notranslate nohighlight">\( are the set of all the curves where \)</span>x’=0<span class="math notranslate nohighlight">\(, which can be found by solving \)</span>f(x,y)=0<span class="math notranslate nohighlight">\( explicitly (if possible). Similarly, the **nullclines** for \)</span>y’<span class="math notranslate nohighlight">\( are the set of all curves where \)</span>y’=0<span class="math notranslate nohighlight">\(. Note that on \)</span>x’<span class="math notranslate nohighlight">\( nullclines, tangent vectors are vertical and on \)</span>y’$ nullclines, tangent vectors are horizontal.</p>
<p>In addition, these nullclines encode the equilibrium solutions. These occur at the intersection of the <span class="math notranslate nohighlight">\(x'\)</span> and <span class="math notranslate nohighlight">\(y'\)</span> nullclines. Moreover, the arrows on the nullclines can only switch direction at an equilibrium point, that is, the intersection points, listed above.</p>
<p><strong>Example</strong> Find the nullclines for the system
$<span class="math notranslate nohighlight">\(x' = x(2-x)-3xy\)</span><span class="math notranslate nohighlight">\(
\)</span><span class="math notranslate nohighlight">\(y' = y(1-y)-2xy.\)</span>$</p>
<p>To find the nullclines, we set each equation equal to zero.</p>
<p>When <span class="math notranslate nohighlight">\(x'=0\)</span>: <span class="math notranslate nohighlight">\(x(2-x-3y)=0 \rightarrow x=0 \text{ or } y= \dfrac{2-x}{3}\)</span>. These are the <span class="math notranslate nohighlight">\(x'\)</span> nullclines.</p>
<p>When <span class="math notranslate nohighlight">\(y'=0\)</span>: <span class="math notranslate nohighlight">\(y(1-y-2x)=0 \rightarrow y=0 \text{ or } y= 1-2x\)</span>. These are the <span class="math notranslate nohighlight">\(y'\)</span> nullclines.</p>
<p>Notice that from these nullclines, we can also find the equilibrium solutions, by figuring out the intersection points. Notice that <span class="math notranslate nohighlight">\((0,0)\)</span> is an equilibrium solution corresponding to <span class="math notranslate nohighlight">\(x=0\)</span>, <span class="math notranslate nohighlight">\(y=0\)</span>. <span class="math notranslate nohighlight">\((0,1)\)</span> is an eqilibrium solution corresponding to <span class="math notranslate nohighlight">\(x=0\)</span>, <span class="math notranslate nohighlight">\(y=1-2x\)</span>. <span class="math notranslate nohighlight">\((2,0)\)</span> is an equilibrium solution corresponding to <span class="math notranslate nohighlight">\(y=\dfrac{2-x}{3}\)</span>, <span class="math notranslate nohighlight">\(y=0\)</span>. The last equilibrium solution is <span class="math notranslate nohighlight">\(\left(\dfrac{1}{5}, \dfrac{3}{5} \right)\)</span>, which corresponds to <span class="math notranslate nohighlight">\(y= \dfrac{2-x}{3}\)</span>, <span class="math notranslate nohighlight">\(y=1-2x\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="c1"># Define the system of equations</span>
<span class="k">def</span> <span class="nf">system</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
    <span class="n">dx</span> <span class="o">=</span> <span class="n">x</span> <span class="o">*</span> <span class="p">(</span><span class="mi">2</span> <span class="o">-</span> <span class="n">x</span><span class="p">)</span> <span class="o">-</span> <span class="mi">3</span> <span class="o">*</span> <span class="n">x</span> <span class="o">*</span> <span class="n">y</span>
    <span class="n">dy</span> <span class="o">=</span> <span class="n">y</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">y</span><span class="p">)</span> <span class="o">-</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">x</span> <span class="o">*</span> <span class="n">y</span>
    <span class="k">return</span> <span class="n">dx</span><span class="p">,</span> <span class="n">dy</span>

<span class="c1"># Create an x, y grid</span>
<span class="n">y</span><span class="p">,</span> <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mgrid</span><span class="p">[</span><span class="o">-</span><span class="mf">0.5</span><span class="p">:</span><span class="mi">2</span><span class="p">:</span><span class="mi">20</span><span class="n">j</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5</span><span class="p">:</span><span class="mf">2.5</span><span class="p">:</span><span class="mi">20</span><span class="n">j</span><span class="p">]</span>

<span class="c1"># Calculate dx, dy for the vector field</span>
<span class="n">dx</span><span class="p">,</span> <span class="n">dy</span> <span class="o">=</span> <span class="n">system</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>

<span class="c1"># Normalize the arrows so their size represents their speed</span>
<span class="n">M</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">hypot</span><span class="p">(</span><span class="n">dx</span><span class="p">,</span> <span class="n">dy</span><span class="p">))</span>                           
<span class="n">M</span><span class="p">[</span><span class="n">M</span> <span class="o">==</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1.</span>                                 
<span class="n">dx</span> <span class="o">/=</span> <span class="n">M</span>                                        
<span class="n">dy</span> <span class="o">/=</span> <span class="n">M</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>

<span class="c1"># Plot the vector field using quiver</span>
<span class="n">plt</span><span class="o">.</span><span class="n">quiver</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">dx</span><span class="p">,</span> <span class="n">dy</span><span class="p">,</span> <span class="n">M</span><span class="p">,</span> <span class="n">pivot</span><span class="o">=</span><span class="s1">&#39;mid&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>

<span class="c1"># Create an x vector</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">2.5</span><span class="p">,</span> <span class="mi">200</span><span class="p">)</span>

<span class="c1"># Define nullclines</span>
<span class="n">y1</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">x</span>
<span class="n">y2</span> <span class="o">=</span> <span class="p">(</span><span class="mi">2</span> <span class="o">-</span> <span class="n">x</span><span class="p">)</span> <span class="o">/</span> <span class="mi">3</span>

<span class="c1"># Plot nullclines</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;y = 1 - 2x&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;y = (2 - x) / 3&quot;</span><span class="p">)</span>

<span class="c1"># Also plot x=0 and y=0</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;x = 0&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;purple&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;y = 0&quot;</span><span class="p">)</span>

<span class="c1"># Labels and legends</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

<span class="c1"># Set the x and y axis cutoffs</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">([</span><span class="o">-</span><span class="mf">0.5</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">([</span><span class="o">-</span><span class="mf">0.5</span><span class="p">,</span><span class="mf">2.5</span><span class="p">])</span>

<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Phase Plane and Nullclines&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/fa2bde8e50ddc56e5e67ee29e0dbd4ce010ede00dcaa748bcbb000628212f604.png" src="../../_images/fa2bde8e50ddc56e5e67ee29e0dbd4ce010ede00dcaa748bcbb000628212f604.png" />
</div>
</div>
<p>Given an autonomous system
$<span class="math notranslate nohighlight">\(x' = f(x,y)\)</span><span class="math notranslate nohighlight">\(
\)</span><span class="math notranslate nohighlight">\(y' = g(x,y)\)</span><span class="math notranslate nohighlight">\(
with equilibrium point \)</span>(a,b)<span class="math notranslate nohighlight">\(, the **linearization** of the system at \)</span>(a,b)<span class="math notranslate nohighlight">\( is the linear system
\)</span><span class="math notranslate nohighlight">\( \begin{bmatrix} x' \\ y' \end{bmatrix} = \begin{bmatrix} \dfrac{\partial f}{\partial x} \bigm|_{(a,b)} &amp; \dfrac{\partial f}{\partial y} \bigm|_{(a,b)}  \\ \dfrac{\partial g}{\partial x} \bigm|_{(a,b)} &amp; \dfrac{\partial g}{\partial y} \bigm|_{(a,b)} \end{bmatrix} \begin{bmatrix} x-a \\ y-b \end{bmatrix}.\)</span>$</p>
<p>In addition, $<span class="math notranslate nohighlight">\(\begin{bmatrix} \dfrac{\partial f}{\partial x}  &amp; \dfrac{\partial f}{\partial y}   \\ \dfrac{\partial g}{\partial x}  &amp; \dfrac{\partial g}{\partial y}  \end{bmatrix}\)</span><span class="math notranslate nohighlight">\( is called the **Jacobian Matrix** of the system and is typically denoted \)</span>J(x,y)<span class="math notranslate nohighlight">\(. If we want to evaluate it at a point, (a,b), as is done in the linearization defintion, we denote that \)</span>J(a,b)$.</p>
<p><strong>Example (cont.)</strong> Find the linearization of the system
$<span class="math notranslate nohighlight">\(x' = x(2-x)-3xy\)</span><span class="math notranslate nohighlight">\(
\)</span><span class="math notranslate nohighlight">\(y' = y(1-y)-2xy\)</span>$
at each of its equilibrium solutions.</p>
<p>Recall from the work done previously that the equilibrium solutions are <span class="math notranslate nohighlight">\((0,0)\)</span>, <span class="math notranslate nohighlight">\((0,1)\)</span>, <span class="math notranslate nohighlight">\((2,0)\)</span>, and <span class="math notranslate nohighlight">\(\left(\dfrac{1}{5}, \dfrac{3}{5} \right)\)</span>.</p>
<p>Now we want to find the Jacobian Matrix, <span class="math notranslate nohighlight">\(J(x,y)\)</span>.</p>
<div class="math notranslate nohighlight">
\[\begin{split}J(x,y) = \begin{bmatrix} \dfrac{\partial }{\partial x}(2x-x^2-3xy)  &amp; \dfrac{\partial }{\partial y}(2x-x^2-3xy)   \\ \dfrac{\partial }{\partial x}(y-y^2-2xy)  &amp; \dfrac{\partial }{\partial y}(y-y^2-2xy)  \end{bmatrix} = \begin{bmatrix} 2-2x-3y  &amp; -3x   \\ -2y  &amp; 1-2y-2x  \end{bmatrix}\end{split}\]</div>
<p>So the linearization of <span class="math notranslate nohighlight">\((0,0)\)</span> is
$<span class="math notranslate nohighlight">\( \begin{bmatrix} x' \\ y' \end{bmatrix} = J(0,0) \begin{bmatrix} x-0 \\ y-0 \end{bmatrix} = \begin{bmatrix} 2  &amp; 0   \\ 0  &amp; 1  \end{bmatrix}\begin{bmatrix} x \\ y \end{bmatrix}\)</span>$</p>
<p>So the linearization of <span class="math notranslate nohighlight">\((0,1)\)</span> is
$<span class="math notranslate nohighlight">\( \begin{bmatrix} x' \\ y' \end{bmatrix} = J(0,1) \begin{bmatrix} x-0 \\ y-1 \end{bmatrix} = \begin{bmatrix} -1  &amp; 0   \\ -2  &amp; -1  \end{bmatrix}\begin{bmatrix} x \\ y-1 \end{bmatrix}\)</span>$</p>
<p>So the linearization of <span class="math notranslate nohighlight">\((2,0)\)</span> is
$<span class="math notranslate nohighlight">\( \begin{bmatrix} x' \\ y' \end{bmatrix} = J(2,0) \begin{bmatrix} x-2 \\ y-0 \end{bmatrix} = \begin{bmatrix} -2  &amp; -6   \\ 0  &amp; -3  \end{bmatrix}\begin{bmatrix} x-2 \\ y \end{bmatrix}\)</span>$</p>
<p>So the linearization of <span class="math notranslate nohighlight">\(\left(\dfrac{1}{5}, \dfrac{3}{5} \right)\)</span> is
$<span class="math notranslate nohighlight">\( \begin{bmatrix} x' \\ y' \end{bmatrix} = J\left(\dfrac{1}{5}, \dfrac{3}{5} \right) \begin{bmatrix} x-\dfrac{1}{5} \\ y - \dfrac{3}{5} \end{bmatrix} = \begin{bmatrix} -\dfrac{1}{5}  &amp; -\dfrac{3}{5}   \\ -\dfrac{6}{5}  &amp; -\dfrac{3}{5}  \end{bmatrix}\begin{bmatrix} x-\dfrac{1}{5} \\ y - \dfrac{3}{5} \end{bmatrix}\)</span>$</p>
<p>Consider the linearization of <span class="math notranslate nohighlight">\((2,0)\)</span> found above
$<span class="math notranslate nohighlight">\( \begin{bmatrix} x' \\ y' \end{bmatrix} = \begin{bmatrix} -2  &amp; -6   \\ 0  &amp; -3  \end{bmatrix}\begin{bmatrix} x-2 \\ y \end{bmatrix}.\)</span>$</p>
<p>Our hope is that the behavior of a nonlinear system is similar locally to the behavior of the linear system. In this case the eigenvalues of $<span class="math notranslate nohighlight">\(\begin{bmatrix} -2  &amp; -6   \\ 0  &amp; -3  \end{bmatrix}\)</span><span class="math notranslate nohighlight">\( are \)</span>\lambda = -2<span class="math notranslate nohighlight">\( and \)</span>\lambda=-3<span class="math notranslate nohighlight">\(. So we hope that locally our system behaves like a sink near \)</span>(2,0)<span class="math notranslate nohighlight">\(. Looking back at the nullclines phase plane, we do see that it behaves like a sink near \)</span>(2,0)$. It turns out that most of the time linearization describes local behavior at an equilibrium, but not always. The next result by Hartman and Grobman discusses when we can expect the linearization to describe local behavior.</p>
<p><strong>Theorem (Hartman-Grobman Theorem)</strong> Given a nonlinear autonomous system
$<span class="math notranslate nohighlight">\(x' = f(x,y)\)</span><span class="math notranslate nohighlight">\(
\)</span><span class="math notranslate nohighlight">\(y' = g(x,y)\)</span><span class="math notranslate nohighlight">\(
with equilibrium point \)</span>(a,b)<span class="math notranslate nohighlight">\(, suppose that for any eigenvalue \)</span>\lambda<span class="math notranslate nohighlight">\( of \)</span>J(a,b)<span class="math notranslate nohighlight">\( we have \)</span>\text{Re}(\lambda) \neq 0.<span class="math notranslate nohighlight">\( Then the linearization
\)</span><span class="math notranslate nohighlight">\(\begin{bmatrix} x' \\ y' \end{bmatrix} = J(a,b) \begin{bmatrix} x-a \\ y-b \end{bmatrix}\)</span><span class="math notranslate nohighlight">\(
describes the qualitative behavior of the system near the equilibrium point \)</span>(a,b)<span class="math notranslate nohighlight">\(. This means that if \)</span>\text{Re}(\lambda) = 0$, then linearization cannot be used to describe the local behavior.</p>
</section>
<section id="exercises">
<h2>Exercises<a class="headerlink" href="#exercises" title="Permalink to this heading">#</a></h2>
<ol class="arabic simple">
<li><p>Which of the following sets are linearly independent?</p></li>
</ol>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(\biggl\{\begin{bmatrix} e^{2t} \\ e^{4t} \end{bmatrix}, \begin{bmatrix} e^{2t} \\ e^{7t} \end{bmatrix}\biggr\}\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(\biggl\{\begin{bmatrix} \cos(t) \\ -e^{3t} \end{bmatrix}, \begin{bmatrix} -\cos(t) \\ e^{3t} \end{bmatrix}\biggr\}\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(\biggl\{v_1(t) = \begin{bmatrix} \sin^2(4t) \\ t \end{bmatrix}, v_2(t)= \begin{bmatrix} \cos^2(4t) \\ 3t \end{bmatrix}, v_3(t) = \begin{bmatrix} 1 \\ 4t \end{bmatrix}\biggr\}\)</span> are linearly dependent as <span class="math notranslate nohighlight">\(v_1(t)-v_2(t)-v_3(t) =\vec{0}\)</span>.</p></li>
</ul>
<ol class="arabic simple" start="2">
<li><p>Solve the initial-value problem
$<span class="math notranslate nohighlight">\(x' = \begin{bmatrix} -3 &amp; 1 &amp; -1 \\ 0 &amp; -3 &amp; 2 \\ 0 &amp; -1 &amp; 0 \end{bmatrix}x, \quad x(0) = \begin{bmatrix} 1 \\ 1 \\ 0 \end{bmatrix}.\)</span>$</p></li>
<li><p>Solve the initial-value problem
$<span class="math notranslate nohighlight">\(x' = \begin{bmatrix} 4 &amp; -1 &amp; 3 \\ 0 &amp; 4 &amp; -2 \\ 0 &amp; 0 &amp; 2 \end{bmatrix}x, \quad x(0) = \begin{bmatrix} 0 \\ 0 \\ 2 \end{bmatrix}.\)</span>$</p></li>
<li><p>Find the general solution to the linear system of differential equations $<span class="math notranslate nohighlight">\(x' = \begin{bmatrix} -1 &amp; 0 &amp; 10 \\ 0 &amp; 2 &amp; 1 \\ 0 &amp; -1 &amp; 2 \end{bmatrix}x.\)</span>$</p></li>
<li><p>Solve the initial-value problem
$<span class="math notranslate nohighlight">\(x' = \begin{bmatrix} 2 &amp; 0 &amp; -3 \\ 1 &amp; 1 &amp; -1 \\ 0 &amp; 0 &amp; -1 \end{bmatrix}x + \begin{bmatrix}3e^{-2t} \\ 6e^{-2t} \\ 3e^{-2t} \end{bmatrix}, \quad x(0) = \begin{bmatrix} 1 \\ 0 \\ 2 \end{bmatrix}.\)</span>$</p></li>
<li><p>Which of the following systems are autonomous?</p></li>
</ol>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(\begin{cases}x' = x^2y+y-x \\ y' = xt+yt-xy\end{cases}\)</span> is an autonomous system.</p></li>
<li><p><span class="math notranslate nohighlight">\(\begin{cases}x' = y-x \\ y' = x+y\end{cases}\)</span> is not an autonomous system because the independent variable <span class="math notranslate nohighlight">\(t\)</span> appears.</p></li>
</ul>
<ol class="arabic simple" start="7">
<li><p>When are homogeneous linear systems with constant coefficients autonomous? That is, when is <span class="math notranslate nohighlight">\(x'=Ax\)</span> autonomous?</p></li>
<li><p>When are nonhomogeneous linear systems with constant coefficients autonomous? That is, when is <span class="math notranslate nohighlight">\(x'=Ax+b\)</span> autonomous?</p></li>
<li><p>Plot a phase plane for the system $<span class="math notranslate nohighlight">\(x' = x(7-2x)-4xy\)</span><span class="math notranslate nohighlight">\(
\)</span><span class="math notranslate nohighlight">\(y' = -y+2xy.\)</span>$</p></li>
<li><p>Consider the two-dimensional homogeneous linear system
$<span class="math notranslate nohighlight">\(x' = \begin{bmatrix} 0 &amp; 10 \\ -1 &amp; 2 \end{bmatrix}x.\)</span>$ Find eigenvalues and their respective eigenvectors and use this information to plot a phase plane with two sample solution curves.</p></li>
<li><p>Consider the nonlinear autonomous system
$<span class="math notranslate nohighlight">\(x' = x(5-x)-4xy\)</span><span class="math notranslate nohighlight">\(
\)</span><span class="math notranslate nohighlight">\(y' = y(3-y)-2xy.\)</span>$
Find the nullclines and equilibrium points and plot a phase plane. Then find the linearization at each equilibrium solution, and if possible, use that linearization to describe the qualitative behavior near each equilibrium solution.</p></li>
</ol>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./Undergrad/DifEq"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
                <footer class="bd-footer-article">
                  
<div class="footer-article-items footer-article__inner">
  
    <div class="footer-article-item"><!-- Previous / next buttons -->
<div class="prev-next-area">
    <a class="left-prev"
       href="DE4.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">4. Second-Order Differential Equations</p>
      </div>
    </a>
    <a class="right-next"
       href="DE6.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">6. Laplace Transforms</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div></div>
  
</div>

                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#introduction-to-systems-of-linear-differential-equations">5.1 Introduction to Systems of Linear Differential Equations</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#solving-homogeneous-linear-systems-with-constant-coefficients">5.2 Solving Homogeneous Linear Systems with Constant Coefficients</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#solving-non-homogeneous-linear-systems-with-constant-coefficients">5.3 Solving Non-Homogeneous Linear Systems with Constant Coefficients</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#the-phase-plan-for-autonomous-systems">5.4 The Phase Plan for Autonomous Systems</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#geometric-behavior-of-homogeneous-linear-systems">5.5 Geometric Behavior of Homogeneous Linear Systems</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#the-phase-plan-for-nonlinear-autonomous-systems">5.6 The Phase Plan for Nonlinear Autonomous Systems</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#exercises">Exercises</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Paul Isihara, Thomas VanDrunen and Claire Wagner, Editors
</p>

  </div>
  
  <div class="footer-item">
    
  <p class="copyright">
    
      © Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/bootstrap.js?digest=e353d410970836974a52"></script>
<script src="../../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>