

<!DOCTYPE html>


<html lang="en" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Hypothesis Testing for Numerical Data &#8212; An Introduction to Python Jupyter Notebooks for College Math Teachers</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="../../_static/styles/bootstrap.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=e353d410970836974a52" rel="stylesheet" />

  
  <link href="../../_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=e353d410970836974a52" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" href="../../_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=e353d410970836974a52" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52" />

    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script src="../../_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../_static/togglebutton.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../../_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'ProbStat/StatInf/03_Inference_Numerical';</script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Linear Regression" href="04_Regression.html" />
    <link rel="prev" title="Hypothesis Testing for Categorical Data" href="02_Inference_Categorical.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
  

<a class="navbar-brand logo" href="../../intro.html">
  
  
  
  
    
    
      
    
    
    <img src="../../_static/logo.png" class="logo__image only-light" alt="Logo image"/>
    <script>document.write(`<img src="../../_static/logo.png" class="logo__image only-dark" alt="Logo image"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../../intro.html">
                    An Introduction to  Python Jupyter Notebooks for College Math Teachers
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">PREFACE</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../JMM23.html">JMM 2023</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../PatternsSOLUTION.html">Patterns</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">BLACKBOARD MATH PUZZLES</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../elementary.html">Math on a Blackboard</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Elementary/Arithmetic/arithmetic.html">Arithmetic</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Elementary/Arithmetic/pascal.html">Pascal’s Triangle</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Elementary/Fractions/fractions.html">Fractions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Elementary/Vectors/vectors.html">Vectors</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Elementary/Subsets/subsets.html">Subsets</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Elementary/Polar/polar.html">Polar Coordinates</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Elementary/Cylindrical/cylindrical.html">Cylindrical Coordinates</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Elementary/Symmetry/alphabet.html">Symmetry</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Elementary/Fractals/fractals.html">Fractals</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Elementary/Discrete/trees/trees.html">Trees</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Elementary/Circuits/circuits.html">Circuits</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">GETTING STARTED WITH JNBS</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../PreCollege/GettingStarted/start.html">0. Getting Started with Jupyter Notebooks (JNBs)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../PreCollege/GettingStarted/Functions.html">1. Functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../PreCollege/GettingStarted/numpy.html">2 The Numerical Python (numpy) Library</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../PreCollege/GettingStarted/pandas.html">3 Pandas</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../PreCollege/GettingStarted/matplotlib.html">4 Matplotlib</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../PreCollege/GettingStarted/if.html">5. if Conditional Statements</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../PreCollege/GettingStarted/for.html">6. For Loops</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../PreCollege/GettingStarted/dataframes.html">7. Dataframes</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">PRE-COLLEGE STEAM OUTREACH Paul Isihara</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../DD.html">Data Detectives</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Celestial.html">Celestial Ministries  Outreach Program</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../PreCollege/Celestial/jnb1.html">1 Functions- Michael Jordan’s Highest Scoring Game</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../PreCollege/Celestial/jnb2.html">2 How bad is COVID by Chicago Zipcode</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../PreCollege/Celestial/jnb3.html">3. Pixel Images</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../PreCollege/Celestial/jnb4.html">4. Random Number Approximation of Pi</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../PreCollege/Celestial/jnb5.html">5. Name That Tune!</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../PreCollege/Celestial/jnb6.html">6. Word Clouds</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../PreCollege/Celestial/jnb7.html">7. Mapping Famous Chicagoans</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../PreCollege/Celestial/jnb8.html">8. Predicting Exemplary K-8 Chicago Schools</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../PreCollege/Celestial/jnb9.html">9. Simulating Formula One</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../PreCollege/Celestial/jnb10.html">10. It’s Christmas</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../PreCollege/Celestial/demo.html">11. After School Program Demo</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">PYTHON PROGRAMMING GUIDE Thomas VanDrunen</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../Intropy.html">Transition to College Curriculum</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Programming/Introduction_to_Python.html">Introduction to Python</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">PROBABILITY MODELS Laura Gross, Yiheng Liang</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../Prob.html">Probability Models</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ProbIntro/chapter%20probability%20gross%20and%20liang_2023_06_08.html">Introduction</a></li>


<li class="toctree-l1"><a class="reference internal" href="../ProbIntro/drivethru.html">Random Number Simulation of a Drive Thru</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">EXPLORATORY DATA ANALYSIS Laura Gross, Yiheng Liang</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../Data.html">Exploratory Data Analysis</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">STATISTICAL INFERENCE Peter Jantsch, Claire Wagner</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../Stat.html">Statistical Inference</a></li>
<li class="toctree-l1"><a class="reference internal" href="00_Instructor_Notes.html">Introduction and Instructor Notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="01_Foundations.html">Foundations of Statistical Inference</a></li>
<li class="toctree-l1"><a class="reference internal" href="02_Inference_Categorical.html">Hypothesis Testing for Categorical Data</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Hypothesis Testing for Numerical Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="04_Regression.html">Linear Regression</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">CALCULUS  Inne Singgih</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../Undergrad/Calculus/Intro.html">1. Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Undergrad/Calculus/2Functions.html">2. Functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Undergrad/Calculus/3Limits.html">3. Limits, Continuity, and Rates</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Undergrad/Calculus/Sec4.html">4 Derivatives</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Undergrad/Calculus/5int/5int.html">5. Integrals</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Undergrad/Calculus/6parametric.html">6. Parametric Equations</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">CALCULUS FOR DAILY LIFE  Wheaton College Team</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../Undergrad/AppliedCalc/twocommodity.html">1. Linear Systems and the 2 Commodity Model</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Undergrad/AppliedCalc/marginal.html">2. Marginal and Average Cost</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Undergrad/AppliedCalc/design.html">3. Max/Min and Object Design</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Undergrad/AppliedCalc/cobbs.html">4. Optimization and Cobbs-Douglas Production</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Undergrad/AppliedCalc/rates.html">5. Related Rates and Volumes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Undergrad/AppliedCalc/football.html">6. Related Rates with Trig Functions and Football</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Undergrad/AppliedCalc/jnb7.html">7. Probability Distributions and Drive Thrus</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Undergrad/AppliedCalc/control.html">8. Normal Distribution and Process Control</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Undergrad/AppliedCalc/ols.html">9. Partial Derivatives and OLS Regression</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Undergrad/AppliedCalc/gini.html">10. Area Between Curves and the Gini Index</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Undergrad/AppliedCalc/income.html">11. Integral Test and Income Streams</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Undergrad/AppliedCalc/ode.html">12. Ordinary Differential Equations and Exponential Growth/Decay</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">LINEAR ALGEBRA Soheil Anbouhi</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../Linear.html">Linear Algebra</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Undergrad/Linear/0intro.html">0. Introduction</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../Undergrad/Linear/1system.html">1. Systems of Linear Equations</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-1"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../Undergrad/Linear/1_2sol.html">1.2 Solution Set of  Linear Systems</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../Undergrad/Linear/2matrix.html">2. Matrix Algebra</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-2"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../Undergrad/Linear/2_1det.html">2.1 Determinant</a></li>
</ul>
</li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">LINEAR ALGEBRA AND OPTIMIZATION FOR DATA ANALYSIS Wheaton College Team</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../Aplin.html">Applied Linear Algebra</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Advanced/LinearAlgebra/Introduction.html">1. Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Advanced/LinearAlgebra/OLS/jnb1.html">2. OLS Linear Regression</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Advanced/LinearAlgebra/KMeans/jnb2.html">3. K-means Clustering</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Advanced/LinearAlgebra/PCA/jnb3.html">4. Dimension Reduction by Principal Component Analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Advanced/LinearAlgebra/SVM/jnb4.html">5. Binary Classification of Labelled Data by Support Vector Machines</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">DIFFERENTIAL EQUATIONS Rachel Petrik</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../DifEq.html">Differential Equations</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Undergrad/DifEq/Differential%20Equations.html">1. Overview of Chapter</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Undergrad/DifEq/DE%20-%20Section%202.html">2. Introduction to Differential Equations</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Undergrad/DifEq/DE%20-%20Section%203.html">3. First-Order Differential Equations</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">DIFFERENTIAL EQUATIONS FOR THE BENEFIT OF SOCIETY Wheaton College Team</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../Undergrad/AppliedDifEq/covid.html">1. Logistic Growth and COVID-19</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Undergrad/AppliedDifEq/sir.html">2. The Basic SIR Model</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Undergrad/AppliedDifEq/cholera.html">3. Cholera in Haiti</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Undergrad/AppliedDifEq/hiv/hiv.html">4. HIV-AIDS</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Undergrad/AppliedDifEq/cws/cws.html">5. CWS Model of Alzheimemer’s Disease</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Undergrad/AppliedDifEq/gravity/gravity.html">6. Gravity Fed Water Delivery</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">COMPLEX VARIABLES IN GROUNDWATER MODELING Wheaton College Team</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../Advanced/Complex/jnb1.html">1. Setting the Scene</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Advanced/Complex/jnb2.html">2. Complex Analysis Background</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Advanced/Complex/jnb3.html">3. Idealized Groundwater Flow</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Advanced/Complex/jnb4.html">4. Contaminant Extraction Modeling</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Advanced/Complex/Complex_Potentials.html">Complex Potentials</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Advanced/Complex/model.html">Fischer-Calo Contaminant Model</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">ADVANCED DATA ANALYSIS Ying Li, Jonathan Zhu</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../AdvData.html">Advanced Data Analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Advanced/AdvDataAnalysis/sec0_data.html">0. Before Reading</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Advanced/AdvDataAnalysis/sec1_preprocessing.html">1. Preprocessing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Advanced/AdvDataAnalysis/sec2_transform_features.html">2. About Text Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Advanced/AdvDataAnalysis/sec3_doc_embedding.html">3. Document Embedding</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Advanced/AdvDataAnalysis/sec4_classification_algos.html">4. Classification of Texts</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Advanced/AdvDataAnalysis/sec5_classification_eval.html">5. Evaluating Classification</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Advanced/AdvDataAnalysis/sec6_applications.html">6. Applications</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book/issues/new?title=Issue%20on%20page%20%2FProbStat/StatInf/03_Inference_Numerical.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../../_sources/ProbStat/StatInf/03_Inference_Numerical.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>


<script>
document.write(`
  <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
  </button>
`);
</script>

<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Hypothesis Testing for Numerical Data</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#the-palmer-penguins">The Palmer Penguins</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#the-students-t-distribution">The Student’s T-Distribution</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#the-t-test">The T-Test</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#the-t-test-in-python">The T-Test in Python</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercises">Exercises</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#two-sample-t-test">Two-Sample T-Test</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#the-test-statistic">The Test Statistic</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#large-sample-vs-small-sample">Large Sample vs Small Sample</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#robustness-to-assumptions">Robustness to Assumptions</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">Exercises</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># import libraries</span>
<span class="c1"># Always run this cell first!</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="kn">import</span> <span class="nn">scipy</span>
<span class="kn">import</span> <span class="nn">statsmodels.api</span> <span class="c1"># appear to need to import the api as well as the library itself for the interpreter to find the modules</span>
<span class="kn">import</span> <span class="nn">statsmodels</span> <span class="k">as</span> <span class="nn">sm</span>

<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="o">%</span><span class="k">matplotlib</span> inline
<span class="kn">import</span> <span class="nn">plotly.graph_objects</span> <span class="k">as</span> <span class="nn">go</span>
<span class="kn">import</span> <span class="nn">plotly.offline</span>
<span class="n">plotly</span><span class="o">.</span><span class="n">offline</span><span class="o">.</span><span class="n">init_notebook_mode</span><span class="p">(</span><span class="n">connected</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="c1"># make plotly work with Jupyter Notebook using CDN</span>
</pre></div>
</div>
</div>
</div>
<section class="tex2jax_ignore mathjax_ignore" id="hypothesis-testing-for-numerical-data">
<h1>Hypothesis Testing for Numerical Data<a class="headerlink" href="#hypothesis-testing-for-numerical-data" title="Permalink to this heading">#</a></h1>
<p>In the <a class="reference internal" href="02_Inference_Categorical.html"><span class="doc std std-doc">last section</span></a>, we learned about the statistical test of hypotheses, which tells us how we can choose between two statistical models. We did this in the context of categorical data, where we hypothesized about population proportions.</p>
<p>In this section, we apply the same theory to numerical data to hypothesize about population means and variances.</p>
<section id="the-palmer-penguins">
<h2>The Palmer Penguins<a class="headerlink" href="#the-palmer-penguins" title="Permalink to this heading">#</a></h2>
<p>The <a class="reference external" href="https://github.com/mcnakhaee/palmerpenguins">Palmer Penguins dataset</a>, created by Allison Horst, Alison Hill, and Kristen Gorman, contains physical measurements for 344 adult penguins observed near the Palmer Station in Antarctica. The penguins come from 3 different species: Chinstrap, Gentoo, and Adélie. The data were collected by Kristen Gorman and the Palmer Station LTER Program.</p>
<figure>
    <img src='https://allisonhorst.github.io/palmerpenguins/reference/figures/lter_penguins.png' alt='Illustration of Chinstrap, Gentoo, and Adélie penguins. Artwork by @allison_horst, used with permission.'>
    <figcaption>Artwork by @allison_horst, used with permission.</figcaption>
</figure>
<p>To load the data, you need to make sure that the <code class="docutils literal notranslate"><span class="pre">palmerpenguins</span></code> package is installed in your environment. We’ll load the data as a Pandas data frame named <code class="docutils literal notranslate"><span class="pre">penguins</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">palmerpenguins</span> <span class="kn">import</span> <span class="n">load_penguins</span>

<span class="n">penguins</span> <span class="o">=</span> <span class="n">load_penguins</span><span class="p">()</span>
<span class="n">penguins</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">head</span><span class="p">()</span> <span class="c1"># display 5 randomly sampled rows</span>
</pre></div>
</div>
</div>
</div>
<p>Using this data, we are going to explore the question of whether the Gentoo penguins at the Palmer Station differ significantly in body mass from the average Gentoo penguin body mass found in the scientific literature. We can find more information about the worldwide average body mass of the Gentoo penguin by using the <a class="reference external" href="https://eol.org/pages/45512076">Encyclopedia of Life</a>. Based on this page, it looks like the average body mass is 5500 grams. If we let <span class="math notranslate nohighlight">\(\mu\)</span> be the average body mass of Gentoo penguins in the Palmer Station area, our hypotheses are</p>
<div class="amsmath math notranslate nohighlight" id="equation-48d40bef-c3d8-47a5-a06f-042c50ab4395">
<span class="eqno">(15)<a class="headerlink" href="#equation-48d40bef-c3d8-47a5-a06f-042c50ab4395" title="Permalink to this equation">#</a></span>\[\begin{equation}
H_0: \mu = 5500, \\ H_1: \mu \neq 5500.
\end{equation}\]</div>
<p>What about the mean body mass for penguins in our sample data?</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">gentoo</span> <span class="o">=</span> <span class="n">penguins</span><span class="p">[</span><span class="n">penguins</span><span class="p">[</span><span class="s1">&#39;species&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Gentoo&#39;</span><span class="p">]</span>
<span class="n">sample_mean</span> <span class="o">=</span> <span class="n">gentoo</span><span class="p">[</span><span class="s1">&#39;body_mass_g&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;The mean Gentoo body mass in the sample data is </span><span class="si">{</span><span class="n">sample_mean</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># reference: https://matplotlib.org/stable/gallery/ticks/tick-formatters.html</span>
<span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">ticker</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mf">6.4</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">))</span>

<span class="c1"># create number line by hiding unneeded elements of plot</span>
<span class="n">ax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_major_locator</span><span class="p">(</span><span class="n">ticker</span><span class="o">.</span><span class="n">NullLocator</span><span class="p">())</span>
<span class="k">for</span> <span class="n">spine</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;left&#39;</span><span class="p">,</span> <span class="s1">&#39;right&#39;</span><span class="p">,</span> <span class="s1">&#39;top&#39;</span><span class="p">]:</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="n">spine</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>

<span class="c1"># set up number line limits</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">1000</span><span class="o">*</span><span class="p">((</span><span class="n">sample_mean</span><span class="o">-</span><span class="mi">999</span><span class="p">)</span><span class="o">//</span><span class="mi">1000</span><span class="p">),</span> <span class="mi">1000</span><span class="o">*</span><span class="p">((</span><span class="n">sample_mean</span><span class="o">+</span><span class="mi">1999</span><span class="p">)</span><span class="o">//</span><span class="mi">1000</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

<span class="c1"># set up number line tick marks</span>
<span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_major_locator</span><span class="p">(</span><span class="n">ticker</span><span class="o">.</span><span class="n">MultipleLocator</span><span class="p">(</span><span class="mi">1000</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_minor_locator</span><span class="p">(</span><span class="n">ticker</span><span class="o">.</span><span class="n">MultipleLocator</span><span class="p">(</span><span class="mi">100</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_ticks_position</span><span class="p">(</span><span class="s1">&#39;bottom&#39;</span><span class="p">)</span>

<span class="c1"># plot sample mean</span>
<span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">sample_mean</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">s</span> <span class="o">=</span> <span class="mi">75</span><span class="p">,</span> <span class="n">clip_on</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span>
    <span class="s1">&#39;$\overline</span><span class="si">{X}</span><span class="s1">$&#39;</span><span class="p">,</span>
    <span class="n">xy</span> <span class="o">=</span> <span class="p">(</span><span class="n">sample_mean</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
    <span class="n">xytext</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="mi">4</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span>
    <span class="n">textcoords</span> <span class="o">=</span> <span class="s1">&#39;offset pixels&#39;</span><span class="p">,</span>
    <span class="n">fontsize</span> <span class="o">=</span> <span class="s1">&#39;large&#39;</span><span class="p">,</span>
<span class="p">)</span>

<span class="c1"># plot population mean</span>
<span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="mi">5500</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">s</span> <span class="o">=</span> <span class="mi">75</span><span class="p">,</span> <span class="n">clip_on</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span>
    <span class="s1">&#39;$\mu$&#39;</span><span class="p">,</span>
    <span class="n">xy</span> <span class="o">=</span> <span class="p">(</span><span class="mi">5500</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
    <span class="n">xytext</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="mi">4</span><span class="p">,</span> <span class="mi">12</span><span class="p">),</span>
    <span class="n">textcoords</span> <span class="o">=</span> <span class="s1">&#39;offset pixels&#39;</span><span class="p">,</span>
    <span class="n">fontsize</span> <span class="o">=</span> <span class="s1">&#39;large&#39;</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Sample Mean vs. Population Mean&#39;</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="mf">1.25</span><span class="p">);</span>
</pre></div>
</div>
</div>
</div>
<p>Though we could introduce a test based on the standard normal distribution—as we did in the previous section—in the case of numerical data, we are going to utilize the <strong>T-test</strong> instead. As the name suggests, this test is based on the Student’s T-distribution. We do this because the T-test will apply both to the cases when the sample size is large and to the cases when it is relatively small.</p>
</section>
<section id="the-students-t-distribution">
<h2>The Student’s T-Distribution<a class="headerlink" href="#the-students-t-distribution" title="Permalink to this heading">#</a></h2>
<p>When hypothesizing about a population proportion, the null hypothesis gives us a value of <span class="math notranslate nohighlight">\(p\)</span> that determines both the mean and standard deviation of the null distribution. On the other hand, the CLT for sample means tells us that as long as <span class="math notranslate nohighlight">\(n\)</span> is large enough,</p>
<div class="math notranslate nohighlight">
\[\overline{X} \sim N\left(\mu, \frac{\sigma}{\sqrt{n}} \right).\]</div>
<p>Unfortunately, if we make a hypothesis about <span class="math notranslate nohighlight">\(\mu\)</span>, we are still left with estimating <span class="math notranslate nohighlight">\(\sigma\)</span>, the population standard deviation. If we have a good estimate for <span class="math notranslate nohighlight">\(\sigma\)</span>, perhaps from past experiments or expert knowledge, then this is no problem! If we don’t know <span class="math notranslate nohighlight">\(\sigma\)</span>, our best estimate from the data will be to use <span class="math notranslate nohighlight">\(S\)</span>, the sample standard deviation.</p>
<p>When we standardize the test statistic, we then have</p>
<div class="math notranslate nohighlight" id="equation-t-equation">
<span class="eqno">(16)<a class="headerlink" href="#equation-t-equation" title="Permalink to this equation">#</a></span>\[ T = \frac{ \overline{X} - \mu } {S / \sqrt{n}} \sim t_{\nu} \qquad \mbox{rather than} \qquad Z = \frac{ \overline{X} - \mu } {\sigma / \sqrt{n}} \sim N(0,1).\]</div>
<p>The good news is that <span class="math notranslate nohighlight">\(T\)</span> has a highly studied distribution called the Student’s T-distribution. The T-distribution looks a lot like the standard normal distribution, but it has a wider spread, i.e., more probability in the “tails” of the distribution. This wider spread reflects the extra uncertainty of using the sample standard deviation <span class="math notranslate nohighlight">\(S\)</span> in place of the population standard deviation <span class="math notranslate nohighlight">\(\sigma\)</span>. The T-distribution has only one parameter, called “degrees of freedom”, which is represented by the Greek letter <span class="math notranslate nohighlight">\(\nu\)</span> (<em>nu</em>, pronounced like “new”). This is calculated by subtracting one from the sample size, i.e., <span class="math notranslate nohighlight">\(\nu = n - 1\)</span>.</p>
<p>We have glossed over an important detail here: The statistic <span class="math notranslate nohighlight">\(T = \frac{ \overline{X} - \mu } {S / \sqrt{n}}\)</span> has a T-distribution only if the data in the sample come from a normal distribution. Fortunately, if the sample size is large, we don’t need to worry too much about this assumption thanks to the CLT. But if the sample size is small, this becomes especially important!</p>
<p>Play around with the widget below to get an idea of what the T-distribution looks like compared to the standard normal distribution. Drag the slider to select different degrees of freedom, and click the labels in the legend to hide or show different parts of the graph. Notice how the T-distribution resembles the standard normal distribution more closely as the degrees of freedom increase.</p>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">degrees_freedom</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">initial_df_index</span> <span class="o">=</span> <span class="mi">0</span> <span class="c1"># index of degrees of freedom to show initially</span>

<span class="c1"># Create figure</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">go</span><span class="o">.</span><span class="n">Figure</span><span class="p">()</span>

<span class="c1"># Use default seaborn palette (reference: https://josephlemaitre.com/2022/06/use-a-seaborn-color-palette-for-plotly-figures/)</span>
<span class="n">plotly_palette</span> <span class="o">=</span> <span class="nb">iter</span><span class="p">([</span><span class="sa">f</span><span class="s2">&quot;rgb(</span><span class="si">{</span><span class="n">c</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="mi">256</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">c</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="mi">256</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">c</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="mi">256</span><span class="si">}</span><span class="s2">)&quot;</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">sns</span><span class="o">.</span><span class="n">color_palette</span><span class="p">()])</span>
<span class="n">normcolor</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="n">plotly_palette</span><span class="p">)</span>
<span class="n">tcolor</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="n">plotly_palette</span><span class="p">)</span>

<span class="c1"># Add trace for standard normal distribution (always visible)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">add_trace</span><span class="p">(</span>
    <span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span>
        <span class="n">visible</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
        <span class="n">line</span> <span class="o">=</span> <span class="p">{</span> <span class="s2">&quot;width&quot;</span><span class="p">:</span> <span class="mi">4</span> <span class="p">},</span>
        <span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;standard normal&lt;br&gt;distribution&quot;</span><span class="p">,</span> <span class="c1"># label for legend</span>
        <span class="n">hoverinfo</span> <span class="o">=</span> <span class="s2">&quot;x+y&quot;</span><span class="p">,</span>
        <span class="n">marker</span> <span class="o">=</span> <span class="p">{</span> <span class="s2">&quot;color&quot;</span><span class="p">:</span> <span class="n">normcolor</span> <span class="p">},</span>
        <span class="n">opacity</span> <span class="o">=</span> <span class="mf">0.7</span><span class="p">,</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">x</span><span class="p">,</span>
        <span class="n">y</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">norm</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="p">)</span>
<span class="p">)</span>

<span class="c1"># Add traces for t-distributions</span>
<span class="k">for</span> <span class="n">df</span> <span class="ow">in</span> <span class="n">degrees_freedom</span><span class="p">:</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">add_trace</span><span class="p">(</span>
        <span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span>
            <span class="n">visible</span> <span class="o">=</span> <span class="kc">True</span> <span class="k">if</span> <span class="n">df</span> <span class="o">==</span> <span class="n">degrees_freedom</span><span class="p">[</span><span class="n">initial_df_index</span><span class="p">]</span> <span class="k">else</span> <span class="kc">False</span><span class="p">,</span>
            <span class="n">line</span> <span class="o">=</span> <span class="p">{</span> <span class="s2">&quot;width&quot;</span><span class="p">:</span> <span class="mi">4</span> <span class="p">},</span>
            <span class="n">name</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;T-distribution&lt;br&gt;(df = </span><span class="si">{</span><span class="n">df</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">,</span> <span class="c1"># label for legend</span>
            <span class="n">hoverinfo</span> <span class="o">=</span> <span class="s2">&quot;x+y&quot;</span><span class="p">,</span>
            <span class="n">marker</span> <span class="o">=</span> <span class="p">{</span> <span class="s2">&quot;color&quot;</span><span class="p">:</span> <span class="n">tcolor</span> <span class="p">},</span>
            <span class="n">opacity</span> <span class="o">=</span> <span class="mf">0.7</span><span class="p">,</span>
            <span class="n">x</span> <span class="o">=</span> <span class="n">x</span><span class="p">,</span>
            <span class="n">y</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">t</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">df</span><span class="p">)</span>
        <span class="p">)</span>
    <span class="p">)</span>
        
<span class="c1"># Create steps for the slider to select degrees of freedom</span>
<span class="n">steps</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">df</span> <span class="ow">in</span> <span class="n">degrees_freedom</span><span class="p">:</span>
    <span class="n">steps</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
        <span class="s2">&quot;method&quot;</span><span class="p">:</span> <span class="s2">&quot;update&quot;</span><span class="p">,</span>
        <span class="s2">&quot;args&quot;</span><span class="p">:</span> <span class="p">[</span> <span class="c1"># arguments to pass to the update method</span>
            <span class="c1"># make only the normal distribution and the t-distribution with df degrees of freedom visible</span>
            <span class="p">{</span> <span class="s2">&quot;visible&quot;</span><span class="p">:</span> <span class="p">[</span><span class="kc">True</span><span class="p">]</span> <span class="o">+</span> <span class="p">[</span><span class="kc">True</span> <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="n">df</span> <span class="k">else</span> <span class="kc">False</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">degrees_freedom</span><span class="p">]</span> <span class="p">},</span>
        <span class="p">],</span>
        <span class="s2">&quot;label&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">df</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
    <span class="p">})</span>

<span class="c1"># Create a slider using these steps and add it to fig</span>
<span class="n">fig</span><span class="o">.</span><span class="n">layout</span><span class="o">.</span><span class="n">sliders</span> <span class="o">=</span> <span class="p">[{</span>
    <span class="s2">&quot;active&quot;</span><span class="p">:</span> <span class="n">initial_df_index</span><span class="p">,</span>
    <span class="s2">&quot;currentvalue&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;prefix&quot;</span><span class="p">:</span> <span class="s2">&quot;Degrees of Freedom: &quot;</span><span class="p">},</span>
    <span class="s2">&quot;pad&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;t&quot;</span><span class="p">:</span> <span class="mi">50</span><span class="p">},</span>
    <span class="s2">&quot;steps&quot;</span><span class="p">:</span> <span class="n">steps</span><span class="p">,</span>
<span class="p">}]</span>

<span class="c1"># Set layout settings</span>
<span class="n">fig</span><span class="o">.</span><span class="n">update_layout</span><span class="p">(</span>
    <span class="n">title</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;x&quot;</span><span class="p">:</span> <span class="mf">0.5</span><span class="p">,</span>
        <span class="s2">&quot;text&quot;</span><span class="p">:</span> <span class="s2">&quot;T-Distribution vs. Standard Normal Distribution&quot;</span>
    <span class="p">},</span>
    <span class="n">yaxis</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;title&quot;</span><span class="p">:</span> <span class="s2">&quot;Probability Density&quot;</span><span class="p">,</span>
        <span class="c1">#&quot;tickformat&quot;: &quot;.2&quot;,</span>
    <span class="p">},</span>
    <span class="n">paper_bgcolor</span> <span class="o">=</span> <span class="s2">&quot;LightSteelBlue&quot;</span>
<span class="p">)</span>

<span class="c1"># Display figure</span>
<span class="n">fig</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</details>
</div>
<p>When <span class="math notranslate nohighlight">\(n\)</span> is large (<span class="math notranslate nohighlight">\(\ge 30\)</span> or so), then <span class="math notranslate nohighlight">\(S\)</span> should be close to <span class="math notranslate nohighlight">\(\sigma\)</span>, and the T-distribution more or less resembles the standard normal <span class="math notranslate nohighlight">\(Z\)</span>. So why use T at all? It turns out that the T-distribution can also be useful in cases when we do not have a large enough sample size to use the normal distribution! In this case, as we’ve already mentioned, we do need one extra assumption: that the population distribution has a normal distribution. This ensures that the sample average will also have a normal distribution. We’ll come back to this with a small sample example later in the section.</p>
</section>
<section id="the-t-test">
<h2>The T-Test<a class="headerlink" href="#the-t-test" title="Permalink to this heading">#</a></h2>
<p>Now back to our current example: to use a T-test, we need to check the assumption that the underlying data come from a normal distribution. We have <span class="math notranslate nohighlight">\(n=119\)</span> observations, which means we’re working with a large sample case. Additionally, the histogram of the body mass of the Gentoo penguins is roughly mound-shaped, so using the T-test is appropriate for this situation.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># plot histogram</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">histplot</span><span class="p">(</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">gentoo</span><span class="p">,</span>
    <span class="n">x</span> <span class="o">=</span> <span class="s1">&#39;body_mass_g&#39;</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Body Mass (g)&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Distribution of Penguin Body Mass&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
</div>
<p>Now since we know the values of <span class="math notranslate nohighlight">\(\overline X\)</span>, <span class="math notranslate nohighlight">\(S\)</span>, and <span class="math notranslate nohighlight">\(n\)</span>, and the null hypothesis tells us what we assume <span class="math notranslate nohighlight">\(\mu\)</span> to be, we can form our test statistic <span class="math notranslate nohighlight">\(T\)</span> based on the formula:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sample</span> <span class="o">=</span> <span class="n">gentoo</span><span class="p">[</span><span class="s1">&#39;body_mass_g&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span> <span class="c1"># drop missing values</span>
<span class="n">sample_mean</span> <span class="o">=</span> <span class="n">sample</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="n">sample_sd</span> <span class="o">=</span> <span class="n">sample</span><span class="o">.</span><span class="n">std</span><span class="p">()</span>
<span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">sample</span><span class="p">)</span>
<span class="n">mu_0</span> <span class="o">=</span> <span class="mi">5500</span> <span class="c1"># hypothesized mean from H_0</span>

<span class="n">T_obs</span> <span class="o">=</span> <span class="p">(</span><span class="n">sample_mean</span> <span class="o">-</span> <span class="n">mu_0</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">sample_sd</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">n</span><span class="p">))</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;The observed value of the test statistic T is </span><span class="si">{</span><span class="n">T_obs</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>If the population mean really is 5500 g, then we would expect <span class="math notranslate nohighlight">\(\overline X\)</span> to be close to 5500 most of the time. Hence, we would expect <span class="math notranslate nohighlight">\(T\)</span> to be close to 0 most of the time.</p>
<p>On the other hand, if the null hypothesis is not true, then we would expect <span class="math notranslate nohighlight">\(\overline X\)</span> to be different than 5500, and hence <span class="math notranslate nohighlight">\(T\)</span> will likely be much different from 0. Since we made a two-sided hypothesis, values of <span class="math notranslate nohighlight">\(T\)</span> that are much bigger than 0 <em>and</em> values of <span class="math notranslate nohighlight">\(T\)</span> much lower than 0 are both evidence against the null hypothesis.</p>
<p>We observed a very low value of <span class="math notranslate nohighlight">\(T\)</span> at -9.365. But again, we only get to observe one value of <span class="math notranslate nohighlight">\(T\)</span> and not the entire distribution! Is -9.365 different enough from 0 that we should start doubting that the null hypothesis is true? We can state this question as a probability: If the null hypothesis is really true, what is the chance that we would observe a value of <span class="math notranslate nohighlight">\(T\)</span> that is at least as far from 0 as the value we got (-9.365)?</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">abs_t_obs</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">T_obs</span><span class="p">)</span>

<span class="c1"># create plot</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mf">8.5</span><span class="p">,</span><span class="mf">4.5</span><span class="p">))</span>

<span class="c1"># use default seaborn palette</span>
<span class="n">palette</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">color_palette</span><span class="p">()</span>
<span class="n">pdfcolor</span> <span class="o">=</span> <span class="n">palette</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">tcolor</span> <span class="o">=</span> <span class="n">palette</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="n">arrowcolor</span> <span class="o">=</span> <span class="n">palette</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span>

<span class="c1"># define x-axis limits</span>
<span class="n">xlim</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="n">abs_t_obs</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="n">abs_t_obs</span><span class="o">+</span><span class="mi">10</span><span class="p">)</span>

<span class="c1"># plot t-distribution pdf (pdf of T)</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">*</span><span class="n">xlim</span><span class="p">,</span> <span class="mi">300</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">t</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">df</span><span class="o">=</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">pdfcolor</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">2.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;pdf of T&#39;</span><span class="p">)</span>

<span class="c1"># set axis limits</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">*</span><span class="n">xlim</span><span class="p">)</span>
<span class="n">half_ylim</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">ax</span><span class="o">.</span><span class="n">get_ylim</span><span class="p">())</span><span class="o">/</span><span class="mi">2</span> <span class="c1"># coordinate at middle of y-axis</span>

<span class="c1"># plot T_obs and -T_obs</span>
<span class="n">ax</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">T_obs</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;dashed&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">tcolor</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;$x = \pm T_</span><span class="si">{obs}</span><span class="s1">$&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="o">-</span><span class="n">T_obs</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;dashed&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">tcolor</span><span class="p">)</span>

<span class="c1"># plot x = 0</span>
<span class="n">ax</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;dashed&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;grey&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;$x = 0$&#39;</span><span class="p">)</span>

<span class="c1"># fill area under pdf represented by p-value</span>
<span class="n">ax</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">where</span> <span class="o">=</span> <span class="p">(</span><span class="n">x</span> <span class="o">&lt;</span> <span class="o">-</span><span class="n">abs_t_obs</span><span class="p">)</span> <span class="o">|</span> <span class="p">(</span><span class="n">x</span> <span class="o">&gt;</span> <span class="n">abs_t_obs</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="n">pdfcolor</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;area measured</span><span class="se">\n</span><span class="s1">by $P$-value&#39;</span><span class="p">)</span>

<span class="c1"># annotate directions of increasing and decreasing likelihood</span>
<span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span>
    <span class="n">s</span> <span class="o">=</span> <span class="s1">&#39;less likely&#39;</span><span class="p">,</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">abs_t_obs</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">half_ylim</span><span class="p">,</span>
    <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">,</span>
    <span class="n">va</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span>
    <span class="n">size</span> <span class="o">=</span> <span class="mi">12</span><span class="p">,</span>
    <span class="n">bbox</span> <span class="o">=</span> <span class="p">{</span> <span class="s1">&#39;boxstyle&#39;</span><span class="p">:</span> <span class="s1">&#39;rarrow&#39;</span><span class="p">,</span> <span class="s1">&#39;facecolor&#39;</span><span class="p">:</span> <span class="s1">&#39;thistle&#39;</span><span class="p">,</span> <span class="s1">&#39;edgecolor&#39;</span><span class="p">:</span> <span class="n">arrowcolor</span><span class="p">,</span> <span class="s1">&#39;linewidth&#39;</span><span class="p">:</span> <span class="mi">2</span> <span class="p">}</span>
<span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span>
    <span class="n">s</span> <span class="o">=</span> <span class="s1">&#39;more likely&#39;</span><span class="p">,</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">abs_t_obs</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">half_ylim</span><span class="p">,</span>
    <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;right&#39;</span><span class="p">,</span>
    <span class="n">va</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span>
    <span class="n">size</span> <span class="o">=</span> <span class="mi">12</span><span class="p">,</span>
    <span class="n">bbox</span> <span class="o">=</span> <span class="p">{</span> <span class="s1">&#39;boxstyle&#39;</span><span class="p">:</span> <span class="s1">&#39;larrow&#39;</span><span class="p">,</span> <span class="s1">&#39;facecolor&#39;</span><span class="p">:</span> <span class="s1">&#39;thistle&#39;</span><span class="p">,</span> <span class="s1">&#39;edgecolor&#39;</span><span class="p">:</span> <span class="n">arrowcolor</span><span class="p">,</span> <span class="s1">&#39;linewidth&#39;</span><span class="p">:</span> <span class="mi">2</span> <span class="p">}</span>
<span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span>
    <span class="n">s</span> <span class="o">=</span> <span class="s1">&#39;more likely&#39;</span><span class="p">,</span>
    <span class="n">x</span> <span class="o">=</span> <span class="o">-</span><span class="n">abs_t_obs</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">half_ylim</span><span class="p">,</span>
    <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">,</span>
    <span class="n">va</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span>
    <span class="n">size</span> <span class="o">=</span> <span class="mi">12</span><span class="p">,</span>
    <span class="n">bbox</span> <span class="o">=</span> <span class="p">{</span> <span class="s1">&#39;boxstyle&#39;</span><span class="p">:</span> <span class="s1">&#39;rarrow&#39;</span><span class="p">,</span> <span class="s1">&#39;facecolor&#39;</span><span class="p">:</span> <span class="s1">&#39;thistle&#39;</span><span class="p">,</span> <span class="s1">&#39;edgecolor&#39;</span><span class="p">:</span> <span class="n">arrowcolor</span><span class="p">,</span> <span class="s1">&#39;linewidth&#39;</span><span class="p">:</span> <span class="mi">2</span> <span class="p">}</span>
<span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span>
    <span class="n">s</span> <span class="o">=</span> <span class="s1">&#39;less likely&#39;</span><span class="p">,</span>
    <span class="n">x</span> <span class="o">=</span> <span class="o">-</span><span class="n">abs_t_obs</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">half_ylim</span><span class="p">,</span>
    <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;right&#39;</span><span class="p">,</span>
    <span class="n">va</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span>
    <span class="n">size</span> <span class="o">=</span> <span class="mi">12</span><span class="p">,</span>
    <span class="n">bbox</span> <span class="o">=</span> <span class="p">{</span> <span class="s1">&#39;boxstyle&#39;</span><span class="p">:</span> <span class="s1">&#39;larrow&#39;</span><span class="p">,</span> <span class="s1">&#39;facecolor&#39;</span><span class="p">:</span> <span class="s1">&#39;thistle&#39;</span><span class="p">,</span> <span class="s1">&#39;edgecolor&#39;</span><span class="p">:</span> <span class="n">arrowcolor</span><span class="p">,</span> <span class="s1">&#39;linewidth&#39;</span><span class="p">:</span> <span class="mi">2</span> <span class="p">}</span>
<span class="p">)</span>

<span class="c1"># set up legend, y-axis label, and title</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper left&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Density&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Likelihood of Observing $T_</span><span class="si">{obs}</span><span class="s1">$ (Or a More Extreme Value) Under $H_</span><span class="si">{0}</span><span class="s1">$&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="mi">2</span> <span class="o">*</span> <span class="n">scipy</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">t</span><span class="o">.</span><span class="n">cdf</span><span class="p">(</span><span class="n">T_obs</span><span class="p">,</span> <span class="n">df</span><span class="o">=</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>This is the <span class="math notranslate nohighlight">\(P\)</span>-value again! Remember how we use the <span class="math notranslate nohighlight">\(P\)</span>-value to make a decision: If the <span class="math notranslate nohighlight">\(P\)</span>-value is greater than our specified threshold <span class="math notranslate nohighlight">\(\alpha\)</span>, then our data is compatible with the null hypothesis, and we <strong>fail to reject the null hypothesis</strong>. If the <span class="math notranslate nohighlight">\(P\)</span>-value is less than our specified threshold <span class="math notranslate nohighlight">\(\alpha\)</span>, then our test statistic is incompatible with the null hypothesis, and we will <strong>reject the null hypothesis</strong>.</p>
<p>In this case, the <span class="math notranslate nohighlight">\(P\)</span>-value is very small. It’s so small, in fact, that the area measured by the <span class="math notranslate nohighlight">\(P\)</span>-value in the  figure above—the area between the density function and the line <span class="math notranslate nohighlight">\(x = 0\)</span> that is to the left of <span class="math notranslate nohighlight">\(-T_{obs}\)</span> or to the right of <span class="math notranslate nohighlight">\(T_{obs}\)</span>—isn’t even visible at this scale.</p>
<p>Let’s zoom in and take a closer look at this area:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">abs_t_obs</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">T_obs</span><span class="p">)</span>

<span class="c1"># create plot</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mf">8.5</span><span class="p">,</span><span class="mf">4.5</span><span class="p">))</span>

<span class="c1"># use default seaborn palette</span>
<span class="n">palette</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">color_palette</span><span class="p">()</span>
<span class="n">pdfcolor</span> <span class="o">=</span> <span class="n">palette</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">tcolor</span> <span class="o">=</span> <span class="n">palette</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="n">arrowcolor</span> <span class="o">=</span> <span class="n">palette</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span>

<span class="c1"># define x-axis limits</span>
<span class="n">xlim</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="n">abs_t_obs</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="n">abs_t_obs</span><span class="o">+</span><span class="mi">10</span><span class="p">)</span>

<span class="c1"># plot t-distribution pdf (pdf of T)</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">*</span><span class="n">xlim</span><span class="p">,</span> <span class="mi">300</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">t</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">df</span><span class="o">=</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">pdfcolor</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">2.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;pdf of T&#39;</span><span class="p">)</span>

<span class="c1"># set axis limits</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">*</span><span class="n">xlim</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">1e-16</span><span class="p">,</span> <span class="n">scipy</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">t</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">T_obs</span><span class="p">,</span> <span class="n">df</span><span class="o">=</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span>
<span class="n">half_ylim</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">ax</span><span class="o">.</span><span class="n">get_ylim</span><span class="p">())</span><span class="o">/</span><span class="mi">2</span> <span class="c1"># coordinate at middle of y-axis</span>

<span class="c1"># plot T_obs and -T_obs</span>
<span class="n">ax</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">T_obs</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;dashed&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">tcolor</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;$x = \pm T_</span><span class="si">{obs}</span><span class="s1">$&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="o">-</span><span class="n">T_obs</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;dashed&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">tcolor</span><span class="p">)</span>

<span class="c1"># plot x = 0</span>
<span class="n">ax</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;dashed&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;grey&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;$x = 0$&#39;</span><span class="p">)</span>

<span class="c1"># fill area under pdf represented by p-value</span>
<span class="n">ax</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">where</span> <span class="o">=</span> <span class="p">(</span><span class="n">x</span> <span class="o">&lt;</span> <span class="o">-</span><span class="n">abs_t_obs</span><span class="p">)</span> <span class="o">|</span> <span class="p">(</span><span class="n">x</span> <span class="o">&gt;</span> <span class="n">abs_t_obs</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="n">pdfcolor</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;area measured</span><span class="se">\n</span><span class="s1">by $P$-value&#39;</span><span class="p">)</span>

<span class="c1"># annotate directions of increasing and decreasing likelihood</span>
<span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span>
    <span class="n">s</span> <span class="o">=</span> <span class="s1">&#39;less likely&#39;</span><span class="p">,</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">abs_t_obs</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">half_ylim</span><span class="p">,</span>
    <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">,</span>
    <span class="n">va</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span>
    <span class="n">size</span> <span class="o">=</span> <span class="mi">12</span><span class="p">,</span>
    <span class="n">bbox</span> <span class="o">=</span> <span class="p">{</span> <span class="s1">&#39;boxstyle&#39;</span><span class="p">:</span> <span class="s1">&#39;rarrow&#39;</span><span class="p">,</span> <span class="s1">&#39;facecolor&#39;</span><span class="p">:</span> <span class="s1">&#39;thistle&#39;</span><span class="p">,</span> <span class="s1">&#39;edgecolor&#39;</span><span class="p">:</span> <span class="n">arrowcolor</span><span class="p">,</span> <span class="s1">&#39;linewidth&#39;</span><span class="p">:</span> <span class="mi">2</span> <span class="p">}</span>
<span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span>
    <span class="n">s</span> <span class="o">=</span> <span class="s1">&#39;more likely&#39;</span><span class="p">,</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">abs_t_obs</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">half_ylim</span><span class="p">,</span>
    <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;right&#39;</span><span class="p">,</span>
    <span class="n">va</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span>
    <span class="n">size</span> <span class="o">=</span> <span class="mi">12</span><span class="p">,</span>
    <span class="n">bbox</span> <span class="o">=</span> <span class="p">{</span> <span class="s1">&#39;boxstyle&#39;</span><span class="p">:</span> <span class="s1">&#39;larrow&#39;</span><span class="p">,</span> <span class="s1">&#39;facecolor&#39;</span><span class="p">:</span> <span class="s1">&#39;thistle&#39;</span><span class="p">,</span> <span class="s1">&#39;edgecolor&#39;</span><span class="p">:</span> <span class="n">arrowcolor</span><span class="p">,</span> <span class="s1">&#39;linewidth&#39;</span><span class="p">:</span> <span class="mi">2</span> <span class="p">}</span>
<span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span>
    <span class="n">s</span> <span class="o">=</span> <span class="s1">&#39;more likely&#39;</span><span class="p">,</span>
    <span class="n">x</span> <span class="o">=</span> <span class="o">-</span><span class="n">abs_t_obs</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">half_ylim</span><span class="p">,</span>
    <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">,</span>
    <span class="n">va</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span>
    <span class="n">size</span> <span class="o">=</span> <span class="mi">12</span><span class="p">,</span>
    <span class="n">bbox</span> <span class="o">=</span> <span class="p">{</span> <span class="s1">&#39;boxstyle&#39;</span><span class="p">:</span> <span class="s1">&#39;rarrow&#39;</span><span class="p">,</span> <span class="s1">&#39;facecolor&#39;</span><span class="p">:</span> <span class="s1">&#39;thistle&#39;</span><span class="p">,</span> <span class="s1">&#39;edgecolor&#39;</span><span class="p">:</span> <span class="n">arrowcolor</span><span class="p">,</span> <span class="s1">&#39;linewidth&#39;</span><span class="p">:</span> <span class="mi">2</span> <span class="p">}</span>
<span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span>
    <span class="n">s</span> <span class="o">=</span> <span class="s1">&#39;less likely&#39;</span><span class="p">,</span>
    <span class="n">x</span> <span class="o">=</span> <span class="o">-</span><span class="n">abs_t_obs</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">half_ylim</span><span class="p">,</span>
    <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;right&#39;</span><span class="p">,</span>
    <span class="n">va</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span>
    <span class="n">size</span> <span class="o">=</span> <span class="mi">12</span><span class="p">,</span>
    <span class="n">bbox</span> <span class="o">=</span> <span class="p">{</span> <span class="s1">&#39;boxstyle&#39;</span><span class="p">:</span> <span class="s1">&#39;larrow&#39;</span><span class="p">,</span> <span class="s1">&#39;facecolor&#39;</span><span class="p">:</span> <span class="s1">&#39;thistle&#39;</span><span class="p">,</span> <span class="s1">&#39;edgecolor&#39;</span><span class="p">:</span> <span class="n">arrowcolor</span><span class="p">,</span> <span class="s1">&#39;linewidth&#39;</span><span class="p">:</span> <span class="mi">2</span> <span class="p">}</span>
<span class="p">)</span>

<span class="c1"># set up legend, axis labels and tickmarks, and title</span>
<span class="n">ax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_major_formatter</span><span class="p">(</span><span class="n">ticker</span><span class="o">.</span><span class="n">StrMethodFormatter</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{x:.0e}</span><span class="s1">&#39;</span><span class="p">))</span> <span class="c1"># use exponent notation</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper left&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Density&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Likelihood of Observing $T_</span><span class="si">{obs}</span><span class="s1">$ (Or a More Extreme Value) Under $H_</span><span class="si">{0}</span><span class="s1">$&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
</div>
<p>As this graph shows, the area measured by the <span class="math notranslate nohighlight">\(P\)</span>-value is quite small (note the range of the <span class="math notranslate nohighlight">\(y\)</span>-axis).</p>
<p>Since the <span class="math notranslate nohighlight">\(P\)</span>-value is so small, we choose to reject the null hypothesis. There is evidence that the Gentoo penguins in this area are smaller than the average Gentoo penguin.</p>
<p>Why the big difference? Probably the Encyclopedia of Life body mass trait is specifically for adult Gentoo penguins, and our observations contain younger penguins. If we wanted to make a stronger, publishable conclusion we could use this as a jumping off point for further research.</p>
<p><strong>If we were writing this test for a publication we could use language like this: “We conducted a one-sample t-test to compare the body mass of Gentoo penguins measured in the field with the theoretical mean adult Gentoo body mass of 5500 g pulled from the Encyclopedia of Life trait bank. The penguin body mass measurements in this study were significantly smaller than the theoretical mean (p=6.05x10^-16).”</strong></p>
<section id="the-t-test-in-python">
<h3>The T-Test in Python<a class="headerlink" href="#the-t-test-in-python" title="Permalink to this heading">#</a></h3>
<p>Fortunately, Python has many of these statistical tests built in, so we don’t have to calculate it all from scratch every time. In this case, we use the <code class="docutils literal notranslate"><span class="pre">scipy.stats</span></code> library, which includes the T-test as <code class="docutils literal notranslate"><span class="pre">ttest_1samp</span></code>. Here is code that performs the same test we just did. Verify that the answers match what we computed above!</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">result</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">ttest_1samp</span><span class="p">(</span>
    <span class="n">a</span> <span class="o">=</span> <span class="n">sample</span><span class="p">,</span>
    <span class="n">popmean</span> <span class="o">=</span> <span class="mi">5500</span><span class="p">,</span> <span class="c1"># null hypothesis: mean is 0</span>
    <span class="n">alternative</span> <span class="o">=</span> <span class="s1">&#39;two-sided&#39;</span><span class="p">,</span>
<span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;T-test for mean: test statistic is </span><span class="si">{</span><span class="n">result</span><span class="o">.</span><span class="n">statistic</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2"> with </span><span class="si">{</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="si">}</span><span class="s2"> degrees of freedom.</span><span class="se">\n</span><span class="s2">P-value is </span><span class="si">{</span><span class="n">result</span><span class="o">.</span><span class="n">pvalue</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>The test again says that there is evidence that the population mean really is different from 5500. So what value will it take? To answer that, we can return to the confidence interval, this time calculated based on the T-distribution.</p>
<p>Run the following code to check the version of <code class="docutils literal notranslate"><span class="pre">scipy</span></code> that you have installed:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">scipy</span><span class="o">.</span><span class="n">__version__</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>If your version of <code class="docutils literal notranslate"><span class="pre">scipy</span></code> is 1.10.0 or greater, you can compute the confidence interval by using the <code class="docutils literal notranslate"><span class="pre">confidence_interval</span></code> function associated with the result of the t-test we just ran:</p>
<div class="cell tag_raises-exception tag_remove-output docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># works for versions of scipy &gt;= 1.10.0</span>
<span class="n">confidence_level</span> <span class="o">=</span> <span class="mf">0.95</span>
<span class="p">(</span><span class="n">lower_ci</span><span class="p">,</span> <span class="n">upper_ci</span><span class="p">)</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">confidence_interval</span><span class="p">(</span><span class="n">confidence_level</span><span class="p">)</span> <span class="c1"># use the result object from the t-test</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;95% confidence interval is (</span><span class="si">{</span><span class="n">lower_ci</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">upper_ci</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">).&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>If your version of <code class="docutils literal notranslate"><span class="pre">scipy</span></code> is less than 1.10.0, you can compute the confidence interval by using the <code class="docutils literal notranslate"><span class="pre">t.interval</span></code> function instead. (It also works for versions greater than or equal to 1.10.0.) This function is similar to the <code class="docutils literal notranslate"><span class="pre">norm.interval</span></code> function we used <a class="reference internal" href="01_Foundations.html"><span class="doc std std-doc">earlier</span></a>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># works for versions of scipy &lt; 1.10.0</span>
<span class="n">confidence_level</span> <span class="o">=</span> <span class="mf">0.95</span>
<span class="p">(</span><span class="n">lower_ci</span><span class="p">,</span> <span class="n">upper_ci</span><span class="p">)</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">t</span><span class="o">.</span><span class="n">interval</span><span class="p">(</span>
    <span class="n">confidence_level</span><span class="p">,</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">n</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="c1"># degrees of freedom of test statistic</span>
    <span class="n">loc</span> <span class="o">=</span> <span class="n">sample_mean</span><span class="p">,</span> <span class="c1"># mean of test statistic</span>
    <span class="n">scale</span> <span class="o">=</span> <span class="n">sample_sd</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="c1"># standard deviation of test statistic</span>
<span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;95% confidence interval is (</span><span class="si">{</span><span class="n">lower_ci</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">upper_ci</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">).&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>We have 95% confidence that the average mass of Gentoo penguins in the Palmer Station area is between about 4986 and 5165 grams, much lower than the null hypothesis from before.</p>
</section>
<section id="exercises">
<h3>Exercises<a class="headerlink" href="#exercises" title="Permalink to this heading">#</a></h3>
<p>Repeat the test above for the bill length of Gentoo penguins. This is found in the variable <code class="docutils literal notranslate"><span class="pre">bill_length_mm</span></code>.</p>
<ol class="arabic simple">
<li><p>Find the average bill length for Gentoo penguins from the <a class="reference external" href="https://eol.org/pages/45512076">Encyclopedia of Life</a>. Use this information to form null and alternative hypotheses, making sure to note the units.</p></li>
<li><p>What is the sample size you have? Does the distribution of bill lengths appear to meet the normality assumption needed to perform the T-test?</p></li>
<li><p>Perform the test and report the test statistic and <span class="math notranslate nohighlight">\(P\)</span>-value.</p></li>
<li><p>What do you conclude? If you find a significant difference, give a confidence interval for average bill length.</p></li>
</ol>
</section>
</section>
<section id="two-sample-t-test">
<h2>Two-Sample T-Test<a class="headerlink" href="#two-sample-t-test" title="Permalink to this heading">#</a></h2>
<p>We can also use the T-test to examine the difference between two population means. Typically, this is done to find out if two populations have the same mean or not.</p>
<p>We can return to our Palmer Penguins example and look at whether the Adélie and Chinstrap penguins from this area have the same average body mass.</p>
<p>Letting <span class="math notranslate nohighlight">\(\mu_1\)</span> be the average body mass of Adélie penguins and <span class="math notranslate nohighlight">\(\mu_2\)</span> be the average body mass of Chinstrap penguins in the Palmer station area, our hypotheses are</p>
<div class="amsmath math notranslate nohighlight" id="equation-6dce1a21-677e-476f-8bd8-7b94eb9d6972">
<span class="eqno">(17)<a class="headerlink" href="#equation-6dce1a21-677e-476f-8bd8-7b94eb9d6972" title="Permalink to this equation">#</a></span>\[\begin{equation}
H_0: \mu_1 - \mu_2 = 0, \\ H_1: \mu_1 - \mu_2 \neq 0.
\end{equation}\]</div>
<p>Let’s look at our samples:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">adelie</span> <span class="o">=</span> <span class="n">penguins</span><span class="p">[</span><span class="n">penguins</span><span class="p">[</span><span class="s1">&#39;species&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Adelie&#39;</span><span class="p">]</span>
<span class="n">chinstrap</span> <span class="o">=</span> <span class="n">penguins</span><span class="p">[</span><span class="n">penguins</span><span class="p">[</span><span class="s1">&#39;species&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Chinstrap&#39;</span><span class="p">]</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;The mean Adélie body mass in the sample data is </span><span class="si">{</span><span class="n">adelie</span><span class="p">[</span><span class="s1">&#39;body_mass_g&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;The mean Chinstrap body mass in the sample data is </span><span class="si">{</span><span class="n">chinstrap</span><span class="p">[</span><span class="s1">&#39;body_mass_g&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>These are slightly different, but are they enough different for us to reject the null hypothesis? We need a test statistic to quantify this.</p>
<section id="the-test-statistic">
<h3>The Test Statistic<a class="headerlink" href="#the-test-statistic" title="Permalink to this heading">#</a></h3>
<p>When the sample sizes <span class="math notranslate nohighlight">\(n_1\)</span> and <span class="math notranslate nohighlight">\(n_2\)</span> are large enough (typically both <span class="math notranslate nohighlight">\(n_1 \geq 30\)</span> and <span class="math notranslate nohighlight">\(n_2 \geq 30\)</span>), we have</p>
<div class="amsmath math notranslate nohighlight" id="equation-81272a91-8e4a-49f4-b34a-e6662ae9a994">
<span class="eqno">(18)<a class="headerlink" href="#equation-81272a91-8e4a-49f4-b34a-e6662ae9a994" title="Permalink to this equation">#</a></span>\[\begin{equation}
    \overline{X}_1 - \overline{X}_2 \sim N \left( \mu_1 - \mu_2, \sqrt{ \frac{\sigma_1^2}{n_1} + \frac{\sigma_2^2}{n_2} } \right),
\end{equation}\]</div>
<p>and hence</p>
<div class="amsmath math notranslate nohighlight" id="equation-f5a98c2f-ef8b-474e-8bf7-7b604c62ea25">
<span class="eqno">(19)<a class="headerlink" href="#equation-f5a98c2f-ef8b-474e-8bf7-7b604c62ea25" title="Permalink to this equation">#</a></span>\[\begin{equation}
    \frac{\overline{X}_1 - \overline{X}_2 - (\mu_1 - \mu_2)}{ \sqrt{ \frac{\sigma_1^2}{n_1} + \frac{\sigma_2^2}{n_2} }} \sim N(0,1).
\end{equation}\]</div>
<p>Just as before, the null hypothesis will tell us about <span class="math notranslate nohighlight">\(\mu_1-\mu_2\)</span>, but not about <span class="math notranslate nohighlight">\(\sigma_1\)</span> and <span class="math notranslate nohighlight">\(\sigma_2\)</span>, so we’ll estimate them from the data using <span class="math notranslate nohighlight">\(S_1\)</span> and <span class="math notranslate nohighlight">\(S_2\)</span>. Making that substitution for the standard deviations, we have a T-distribution:</p>
<div class="amsmath math notranslate nohighlight" id="equation-d6fe37ba-111d-4ec9-8ac9-f3b55f2fa4e9">
<span class="eqno">(20)<a class="headerlink" href="#equation-d6fe37ba-111d-4ec9-8ac9-f3b55f2fa4e9" title="Permalink to this equation">#</a></span>\[\begin{equation}
    \frac{\overline{X}_1 - \overline{X}_2 - (\mu_1 - \mu_2)}{ \sqrt{ \frac{S_1^2}{n_1} + \frac{S_2^2}{n_2} }} \sim t_{\nu},
\end{equation}\]</div>
<p>where <span class="math notranslate nohighlight">\(\nu\)</span> represents the degrees of freedom. The exact value of <span class="math notranslate nohighlight">\(\nu\)</span> will be calculated by something called Welch’s method, but we can let the software handle that details of the computation. You can keep in mind the intuition that if <span class="math notranslate nohighlight">\(S_1 \approx S_2\)</span>, then <span class="math notranslate nohighlight">\(\nu\)</span> will be about <span class="math notranslate nohighlight">\(n_1 + n_2 - 2\)</span>. On the other hand, if <span class="math notranslate nohighlight">\(S_1\)</span> and <span class="math notranslate nohighlight">\(S_2\)</span> are very different, then <span class="math notranslate nohighlight">\(\nu \approx \min({n_1, n_2})\)</span>.</p>
<p>Now that we have two separate samples, the T-distribution requires that <em>both</em> come from normal distributions. There are sophisticated ways to check this, but we will just visually assess the histograms.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># plot histograms of adelie and chinstrap body mass, faceted by species</span>
<span class="n">facetgrid</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">displot</span><span class="p">(</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">adelie</span><span class="p">,</span> <span class="n">chinstrap</span><span class="p">]),</span>
    <span class="n">x</span> <span class="o">=</span> <span class="s1">&#39;body_mass_g&#39;</span><span class="p">,</span>
    <span class="n">hue</span> <span class="o">=</span> <span class="s1">&#39;species&#39;</span><span class="p">,</span>
    <span class="n">col</span> <span class="o">=</span> <span class="s1">&#39;species&#39;</span><span class="p">,</span>
    <span class="n">kind</span> <span class="o">=</span> <span class="s1">&#39;hist&#39;</span><span class="p">,</span>
    <span class="n">stat</span> <span class="o">=</span> <span class="s1">&#39;density&#39;</span><span class="p">,</span>
    <span class="n">legend</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">facetgrid</span><span class="o">.</span><span class="n">set_titles</span><span class="p">(</span><span class="s1">&#39;Distribution of </span><span class="si">{col_name}</span><span class="s1"> Body Mass&#39;</span><span class="p">)</span>
<span class="n">facetgrid</span><span class="o">.</span><span class="n">set_xlabels</span><span class="p">(</span><span class="s1">&#39;Body Mass (g)&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
</div>
<p>These look appropriately normal-ish, and the large sample gives us extra wiggle room in the assumptions of the T-test. Moreover, the distributions don’t look too different, so we might start to expect that the true difference in means really is 0. So let’s perform the test!</p>
<p>The function we will use is a function from <code class="docutils literal notranslate"><span class="pre">statsmodels</span></code> called <code class="docutils literal notranslate"><span class="pre">ttest_ind</span></code>. To use this function, we first need to create a <code class="docutils literal notranslate"><span class="pre">CompareMeans</span></code> object from our two samples. After we’ve done that, we will be able to call the <code class="docutils literal notranslate"><span class="pre">ttest_ind</span></code> function on this object to perform the actual T-test.</p>
<p>We set the argument <code class="docutils literal notranslate"><span class="pre">value</span></code> equal to the difference of means under our null hypothesis. We set the argument <code class="docutils literal notranslate"><span class="pre">alternative</span></code> to “two-sided” to indicate that we have an two-sided alternative hypothesis. (Other possible values are “larger” and “smaller”.) Finally, we set the argument <code class="docutils literal notranslate"><span class="pre">usevar</span></code> to “unequal” to make sure that Welch’s method is used to calculate the degrees of freedom.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># set up our two samples (removing all observations with missing values)</span>
<span class="n">sample1</span> <span class="o">=</span> <span class="n">adelie</span><span class="p">[</span><span class="s1">&#39;body_mass_g&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span>
<span class="n">sample2</span> <span class="o">=</span> <span class="n">chinstrap</span><span class="p">[</span><span class="s1">&#39;body_mass_g&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span>

<span class="c1"># create a CompareMeans object from the two samples</span>
<span class="n">cm</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">weightstats</span><span class="o">.</span><span class="n">CompareMeans</span><span class="o">.</span><span class="n">from_data</span><span class="p">(</span><span class="n">sample1</span><span class="p">,</span> <span class="n">sample2</span><span class="p">)</span>

<span class="c1"># perform the two-sample t-test</span>
<span class="p">(</span><span class="n">stat</span><span class="p">,</span> <span class="n">pval</span><span class="p">,</span> <span class="n">df</span><span class="p">)</span> <span class="o">=</span> <span class="n">cm</span><span class="o">.</span><span class="n">ttest_ind</span><span class="p">(</span>
    <span class="n">value</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="c1"># null hypothesis: difference in means is 0</span>
    <span class="n">alternative</span> <span class="o">=</span> <span class="s1">&#39;two-sided&#39;</span><span class="p">,</span> <span class="c1"># two-sided alternative hypothesis</span>
    <span class="n">usevar</span> <span class="o">=</span> <span class="s1">&#39;unequal&#39;</span><span class="p">,</span> <span class="c1"># perform Welch&#39;s t-test</span>
<span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Results of T-test: test statistic is </span><span class="si">{</span><span class="n">stat</span><span class="si">:</span><span class="s1">.3f</span><span class="si">}</span><span class="s1"> with </span><span class="si">{</span><span class="n">df</span><span class="si">:</span><span class="s1">.3f</span><span class="si">}</span><span class="s1"> degrees of freedom.</span><span class="se">\n</span><span class="s1">P-value is </span><span class="si">{</span><span class="n">pval</span><span class="si">:</span><span class="s1">.3f</span><span class="si">}</span><span class="s1">.&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>We do not find any evidence of a difference in average body mass between these two species, so we fail to reject the null hypothesis.</p>
<p>It’s not as important in the situation where we’ve failed to reject the null hypothesis, but here is how to compute a confidence interval with this test.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">conflevel</span> <span class="o">=</span> <span class="mf">0.95</span>

<span class="c1"># compute confidence interval, using the same CompareMeans object as before</span>
<span class="p">(</span><span class="n">lower</span><span class="p">,</span> <span class="n">upper</span><span class="p">)</span> <span class="o">=</span> <span class="n">cm</span><span class="o">.</span><span class="n">tconfint_diff</span><span class="p">(</span>
    <span class="n">alpha</span> <span class="o">=</span> <span class="mi">1</span><span class="o">-</span><span class="n">conflevel</span><span class="p">,</span>
    <span class="n">alternative</span> <span class="o">=</span> <span class="s1">&#39;two-sided&#39;</span><span class="p">,</span>
    <span class="n">usevar</span> <span class="o">=</span> <span class="s1">&#39;unequal&#39;</span><span class="p">,</span> <span class="c1"># perform Welch&#39;s t-test</span>
<span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="nb">int</span><span class="p">(</span><span class="n">conflevel</span><span class="o">*</span><span class="mi">100</span><span class="p">)</span><span class="si">}</span><span class="s1">% confidence interval is (</span><span class="si">{</span><span class="n">lower</span><span class="si">:</span><span class="s1">.3f</span><span class="si">}</span><span class="s1">, </span><span class="si">{</span><span class="n">upper</span><span class="si">:</span><span class="s1">.3f</span><span class="si">}</span><span class="s1">).&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Note that this confidence interval contains 0. Since we have 95% confidence that the difference in the average mass of Adélie and Chinstrap penguins in the Palmer Station area is in this interval, this confirms our conclusion that we have no evidence to reject the null hypothesis.</p>
</section>
<section id="large-sample-vs-small-sample">
<h3>Large Sample vs Small Sample<a class="headerlink" href="#large-sample-vs-small-sample" title="Permalink to this heading">#</a></h3>
<p>Why do we need the extra assumption of a normally distributed population in the case of a small sample? In non-technical terms, because we have less information in the data, we need more information from elsewhere (in this case, assumptions) to be able to make conclusions.</p>
<p>In the large sample case, the Central Limit Theorem tells us that <span class="math notranslate nohighlight">\(\overline{X}\)</span> is normal. In the small sample case, if the sample comes from a normally distributed population, then <span class="math notranslate nohighlight">\(\overline{X}\)</span> will again be normal.</p>
<p>Below you can find plots of the sampling distribution of sample averages from both normal and non-normal distributions, each with a population mean of 1 and a standard deviation of 2. The top row looks at small samples (size <span class="math notranslate nohighlight">\(n=10\)</span>), one from a non-normal distribution (left) and the other from a normal distribution (right). We take the average and “studentize” according to the formula for <span class="math notranslate nohighlight">\(T\)</span> above <a class="reference internal" href="#equation-t-equation">(16)</a>.</p>
<p>Look first at the upper left plot. The histogram of small-sample averages from the non-normal distribution do not fit well with a T-distribution on 9 degrees of freedom. However, the small-sample averages from the normal distribution in the upper right plot do!</p>
<p>In the bottom row you can find histograms of simulated large sample averages (<span class="math notranslate nohighlight">\(n=50\)</span>), overlaid with the density function for a T-distribution on 49 degrees of freedom. The sample averages from both the non-normal (lower left) and normal (lower right) distributions end up fitting well with the T-distribution.</p>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">## Show four plots:</span>
<span class="c1">## Top left: sampling distribution of small-sample averages from non-normal distribution</span>
<span class="c1">## Top right: sampling distribution of small-sample averages from normal distribution</span>
<span class="c1">## Bottom left: sampling distribution of large-sample averages from non-normal distribution</span>
<span class="c1">## Bottom right: sampling distribution of large-sample averages from normal distribution</span>

<span class="k">def</span> <span class="nf">studentize</span><span class="p">(</span><span class="n">sample</span><span class="p">,</span> <span class="n">pop_mean</span><span class="p">):</span>
    <span class="k">return</span> <span class="p">(</span> <span class="n">sample</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span> <span class="o">-</span> <span class="n">pop_mean</span> <span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">sample</span><span class="o">.</span><span class="n">std</span><span class="p">()</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">sample</span><span class="p">)))</span>

<span class="c1"># top to bottom, left to right</span>
<span class="n">sample_means</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
    <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span>
        <span class="p">[</span><span class="n">studentize</span><span class="p">(</span><span class="n">scipy</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">gamma</span><span class="o">.</span><span class="n">rvs</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="mf">0.25</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mf">4.0</span><span class="p">,</span> <span class="n">size</span> <span class="o">=</span> <span class="mi">10</span><span class="p">),</span> <span class="mf">1.0</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1000</span><span class="p">)],</span>
        <span class="p">[</span><span class="n">studentize</span><span class="p">(</span><span class="n">scipy</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">norm</span><span class="o">.</span><span class="n">rvs</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mf">2.0</span><span class="p">,</span> <span class="n">size</span> <span class="o">=</span> <span class="mi">10</span><span class="p">),</span> <span class="mf">1.0</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1000</span><span class="p">)],</span>
        <span class="p">[</span><span class="n">studentize</span><span class="p">(</span><span class="n">scipy</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">gamma</span><span class="o">.</span><span class="n">rvs</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="mf">0.25</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mf">4.0</span><span class="p">,</span> <span class="n">size</span> <span class="o">=</span> <span class="mi">50</span><span class="p">),</span> <span class="mf">1.0</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1000</span><span class="p">)],</span>
        <span class="p">[</span><span class="n">studentize</span><span class="p">(</span><span class="n">scipy</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">norm</span><span class="o">.</span><span class="n">rvs</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mf">2.0</span><span class="p">,</span> <span class="n">size</span> <span class="o">=</span> <span class="mi">50</span><span class="p">),</span> <span class="mf">1.0</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1000</span><span class="p">)],</span>
    <span class="p">])</span>
<span class="p">)</span><span class="o">.</span><span class="n">T</span>
<span class="n">titles</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">[</span> <span class="s2">&quot;small sample, non-normal&quot;</span><span class="p">,</span> <span class="s2">&quot;small sample, normal&quot;</span> <span class="p">],</span>
    <span class="p">[</span> <span class="s2">&quot;large sample, non-normal&quot;</span><span class="p">,</span> <span class="s2">&quot;large sample, normal&quot;</span><span class="p">]</span>
<span class="p">]</span>

<span class="c1"># use default seaborn palette</span>
<span class="n">palette</span> <span class="o">=</span> <span class="nb">iter</span><span class="p">(</span><span class="n">sns</span><span class="o">.</span><span class="n">color_palette</span><span class="p">())</span>
<span class="n">histcolor</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="n">palette</span><span class="p">)</span>
<span class="n">tcolor</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="n">palette</span><span class="p">)</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span> <span class="n">sharex</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">sharey</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">6</span><span class="p">),</span> <span class="n">layout</span><span class="o">=</span><span class="s1">&#39;constrained&#39;</span><span class="p">)</span>

<span class="c1"># plot histogram</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">):</span>
        <span class="c1"># get simulated data to plot</span>
        <span class="n">plot_data</span> <span class="o">=</span> <span class="n">sample_means</span><span class="p">[</span><span class="mi">2</span><span class="o">*</span><span class="n">i</span><span class="o">+</span><span class="n">j</span><span class="p">]</span>
        <span class="c1"># plot histogram</span>
        <span class="n">sns</span><span class="o">.</span><span class="n">histplot</span><span class="p">(</span>
            <span class="n">ax</span> <span class="o">=</span> <span class="n">axs</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">],</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">plot_data</span><span class="p">,</span>
            <span class="n">stat</span> <span class="o">=</span> <span class="s1">&#39;density&#39;</span><span class="p">,</span>
            <span class="n">color</span> <span class="o">=</span> <span class="n">histcolor</span><span class="p">,</span>
            <span class="n">linewidth</span> <span class="o">=</span> <span class="mf">0.3</span><span class="p">,</span>
            <span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.6</span><span class="p">,</span>
            <span class="n">binwidth</span> <span class="o">=</span> <span class="mf">0.2</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="c1"># plot T-distribution</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
        <span class="n">axs</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
            <span class="n">x</span><span class="p">,</span>
            <span class="n">scipy</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">t</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">df</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">plot_data</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">),</span>
            <span class="n">color</span> <span class="o">=</span> <span class="n">tcolor</span><span class="p">,</span> 
            <span class="n">linewidth</span> <span class="o">=</span> <span class="mi">4</span><span class="p">,</span>
            <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;T-distribution&#39;</span> <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">j</span> <span class="o">==</span> <span class="mi">0</span> <span class="k">else</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="c1"># label only first t-distribution in legend</span>
        <span class="p">)</span>
        <span class="n">axs</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">([</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">])</span>
        <span class="n">axs</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">titles</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">])</span>
        <span class="n">axs</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper right&#39;</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s2">&quot;Sample Size and Normality for T-Distributions&quot;</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">13</span><span class="p">);</span>
</pre></div>
</div>
</div>
</details>
</div>
<p>This shows us that, in order to use the T-test with a small sample, it’s necessary to assume that our data comes from a normal distribution. But how we can tell if this assumption is true? This is a nuanced question. Because you don’t have much data to start with, it’s difficult to draw strong conclusions about the distribution it came from! Some textbooks will simply tell you to look for rules of thumb: as long as there are no outliers, or the graph looks roughly “mound-shaped”, you’re ok to proceed with the test. There are even hypothesis tests to quantify this or more sophisticated visuals to use, but they are outside of the scope of this chapter.</p>
</section>
<section id="robustness-to-assumptions">
<h3>Robustness to Assumptions<a class="headerlink" href="#robustness-to-assumptions" title="Permalink to this heading">#</a></h3>
<p>Statisticians have determined that the T-test is fairly “robust” to the normality assumptions. In simple terms, robustness means that you can still trust the results of the test, even if your assumptions are only approximately met. In this case, if your data comes from something that is close to normal, the T-test will still work properly. If that feels too imprecise, that’s ok! It can take some time to develop your understanding and intuition for this.</p>
</section>
</section>
<section id="id1">
<h2>Exercises<a class="headerlink" href="#id1" title="Permalink to this heading">#</a></h2>
<p>The <a class="reference external" href="https://en.wikipedia.org/wiki/Framingham_Heart_Study">Framingham Heart Study</a> is an ongoing study of cardiovascular health in the United States. The initial study followed over 5,000 volunteers from  Framingham, Massachusetts, USA over the course of several decades, and it still continues today. The study led to important findings in many areas, including a link between cholesterol and heart disease. (This exercise was inspired by an assignment from UC Berkeley’s <a class="reference external" href="http://data8.org/">Data 8</a>.)</p>
<p>We load in the data below from the file <code class="docutils literal notranslate"><span class="pre">framingham.csv</span></code>. There are a number of different interesting variables to explore, but we will focus on exploring total cholesterol levels (<code class="docutils literal notranslate"><span class="pre">TOTCHOL</span></code>) versus the occurence of heart disease (<code class="docutils literal notranslate"><span class="pre">ANYCHD</span></code>). The variable <code class="docutils literal notranslate"><span class="pre">ANYCHD</span></code> takes the value <code class="docutils literal notranslate"><span class="pre">0</span></code> if the patient does not have heart disease and the value <code class="docutils literal notranslate"><span class="pre">1</span></code> if they do.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">framingham</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;framingham.csv&quot;</span><span class="p">)</span>
<span class="n">framingham</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>We want to determine if there is a difference in average cholesterol levels between people with heart disease and those without.</p>
<ol class="arabic simple">
<li><p>State the hypotheses being tested.</p></li>
<li><p>Describe the assumptions of the T-test and comment on if they are valid for this example.</p></li>
<li><p>Compute the test statistic and <span class="math notranslate nohighlight">\(P\)</span>-value.</p></li>
<li><p>What is your conclusion?</p></li>
<li><p>Give a confidence interval for the difference in average total cholesterol.</p></li>
</ol>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./ProbStat/StatInf"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
                <footer class="bd-footer-article">
                  
<div class="footer-article-items footer-article__inner">
  
    <div class="footer-article-item"><!-- Previous / next buttons -->
<div class="prev-next-area">
    <a class="left-prev"
       href="02_Inference_Categorical.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Hypothesis Testing for Categorical Data</p>
      </div>
    </a>
    <a class="right-next"
       href="04_Regression.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Linear Regression</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div></div>
  
</div>

                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#the-palmer-penguins">The Palmer Penguins</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#the-students-t-distribution">The Student’s T-Distribution</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#the-t-test">The T-Test</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#the-t-test-in-python">The T-Test in Python</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercises">Exercises</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#two-sample-t-test">Two-Sample T-Test</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#the-test-statistic">The Test Statistic</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#large-sample-vs-small-sample">Large Sample vs Small Sample</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#robustness-to-assumptions">Robustness to Assumptions</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">Exercises</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Paul Isihara, Thomas VanDrunen and Claire Wagner, Editors
</p>

  </div>
  
  <div class="footer-item">
    
  <p class="copyright">
    
      © Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/bootstrap.js?digest=e353d410970836974a52"></script>
<script src="../../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>