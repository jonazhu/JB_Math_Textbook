

<!DOCTYPE html>


<html >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Foundations of Statistical Inference &#8212; An Introduction to Python Jupyter Notebooks for College Math Teachers</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="../../_static/styles/bootstrap.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=e353d410970836974a52" rel="stylesheet" />

  
  <link href="../../_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=e353d410970836974a52" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" href="../../_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=e353d410970836974a52" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52" />

    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script src="../../_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../_static/togglebutton.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../../_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'ProbStat/StatInf/01_Foundations';</script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Hypothesis Testing for Categorical Data" href="02_Inference_Categorical.html" />
    <link rel="prev" title="Section 0: Instructor Notes" href="00_Instructor_Notes.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="None"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
  

<a class="navbar-brand logo" href="../../intro.html">
  
  
  
  
    
    
      
    
    
    <img src="../../_static/logo.png" class="logo__image only-light" alt="Logo image"/>
    <script>document.write(`<img src="../../_static/logo.png" class="logo__image only-dark" alt="Logo image"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../../intro.html">
                    An Introduction to  Python Jupyter Notebooks for College Math Teachers
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">PREFACE</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../JMM23.html">JMM 2023</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../PatternsSOLUTION.html">Patterns</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">GETTING STARTED</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../PreCollege/GettingStarted/start.html">0. Getting Started with Jupyter Notebooks (JNBs)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../PreCollege/GettingStarted/Functions.html">1. Functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../PreCollege/GettingStarted/numpy.html">2 The Numerical Python (numpy) Library</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../PreCollege/GettingStarted/pandas.html">3 Pandas</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../PreCollege/GettingStarted/matplotlib.html">4 Matplotlib</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../PreCollege/GettingStarted/if.html">5. if Conditional Statements</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../PreCollege/GettingStarted/for.html">6. For Loops</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../PreCollege/GettingStarted/dataframes.html">7. Dataframes</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">PRE-COLLEGE STEAM OUTREACH Paul Isihara</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../DD.html">Data Detectives</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Celestial.html">Celestial Ministries  Outreach Program</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../PreCollege/Celestial/jnb1.html">1 Functions- Michael Jordan’s Highest Scoring Game</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../PreCollege/Celestial/jnb2.html">2 How bad is COVID by Chicago Zipcode</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../PreCollege/Celestial/jnb3.html">3. Pixel Images</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../PreCollege/Celestial/jnb4.html">4. Random Number Approximation of Pi</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../PreCollege/Celestial/jnb5.html">5. Name That Tune!</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../PreCollege/Celestial/jnb6.html">6. Word Clouds</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../PreCollege/Celestial/jnb7.html">7. Mapping Famous Chicagoans</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../PreCollege/Celestial/jnb8.html">8. Predicting Exemplary K-8 Chicago Schools</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../PreCollege/Celestial/jnb9.html">9. Simulating Formula One</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../PreCollege/Celestial/jnb10.html">10. It’s Christmas</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../PreCollege/Demo.html">12. After School Program Demo</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">PYTHON PROGRAMMING GUIDE Thomas VanDrunen</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../Intropy.html">Intro to Python</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">PROBABILITY MODELS Laura Gross, Yiheng Liang</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../Prob.html">Probability Models</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ProbIntro/chapter%20probability%20gross%20and%20liang_2023_06_08.html">Introduction</a></li>


</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">EXPLORATORY DATA ANALYSIS Laura Gross, Yiheng Liang</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../Data.html">Exploratory Data Analysis</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">STATISTICAL INFERENCE Peter Jantsch, Claire Wagner</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="00_Instructor_Notes.html">Section 0: Instructor Notes</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Foundations of Statistical Inference</a></li>
<li class="toctree-l1"><a class="reference internal" href="02_Inference_Categorical.html">Hypothesis Testing for Categorical Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="03_Inference_Numerical.html">Hypothesis Testing for Numerical Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="04_Regression.html">Linear Regression</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">CALCULUS  Inne Singgih</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../Undergrad/Calculus/Intro.html">1. Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Undergrad/Calculus/Functions.html">2. Functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Undergrad/Calculus/Sec3.html">3. Limits, Continuity, and Rates</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Undergrad/Calculus/Sec4.html">4 Derivatives</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Undergrad/Calculus/5int/5int.html">5. Integrals</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">CALCULUS FOR DAILY LIFE  Wheaton College Team</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../Undergrad/AppliedCalc/twocommodity.html">1. Linear Systems and the 2 Commodity Model</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Undergrad/AppliedCalc/marginal.html">2. Marginal and Average Cost</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Undergrad/AppliedCalc/design.html">3. Max/Min and Object Design</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Undergrad/AppliedCalc/cobbs.html">4. Optimization and Cobbs-Douglas Production</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Undergrad/AppliedCalc/rates.html">5. Related Rates and Volumes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Undergrad/AppliedCalc/football.html">6. Related Rates with Trig Functions and Football</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Undergrad/AppliedCalc/jnb7.html">7. Probability Distributions and Drive Thrus</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Undergrad/AppliedCalc/control.html">8. Normal Distribution and Process Control</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Undergrad/AppliedCalc/ols.html">9. Partial Derivatives and OLS Regression</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Undergrad/AppliedCalc/gini.html">10. Area Between Curves and the Gini Index</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Undergrad/AppliedCalc/income.html">11. Integral Test and Income Streams</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Undergrad/AppliedCalc/ode.html">12. Ordinary Differential Equations and Exponential Growth/Decay</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">LINEAR ALGEBRA Soheil Anbouhi</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../Linear.html">Linear Algebra</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Undergrad/Linear/0intro.html">0. Introduction</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../Undergrad/Linear/1system.html">1. Systems of Linear Equations</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-1"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../Undergrad/Linear/1_2sol.html">1.2 Solution Set of  Linear Systems</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../Undergrad/Linear/2matrix.html">2. Matrix Algebra</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-2"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../Undergrad/Linear/2_1det.html">2.1 Determinant</a></li>
</ul>
</li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">LINEAR ALGEBRA AND OPTIMIZATION FOR DATA ANALYSIS Wheaton College Team</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../Aplin.html">Applied Linear Algebra</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Advanced/LinearAlgebra/Introduction.html">1. Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Advanced/LinearAlgebra/OLS/jnb1.html">2. OLS Linear Regression</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Advanced/LinearAlgebra/KMeans/jnb2.html">3. K-means Clustering</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Advanced/LinearAlgebra/PCA/jnb3.html">4. Dimension Reduction by Principal Component Analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Advanced/LinearAlgebra/SVM/jnb4.html">5. Binary Classification of Labelled Data by Support Vector Machines</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">DIFFERENTIAL EQUATIONS Rachel Petrik</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../Undergrad/DifEq/Differential%20Equations.html">1. Overview of Chapter</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Undergrad/DifEq/DE%20-%20Section%202.html">2. Introduction to Differential Equations</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Undergrad/DifEq/DE%20-%20Section%203.html">3. First-Order Differential Equations</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">DIFFERENTIAL EQUATIONS FOR THE BENEFIT OF SOCIETY Wheaton College Team</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../Undergrad/AppliedDifEq/covid.html">1. Logistic Growth and COVID-19</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Undergrad/AppliedDifEq/sir.html">2. The Basic SIR Model</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Undergrad/AppliedDifEq/cholera.html">3. Cholera in Haiti</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Undergrad/AppliedDifEq/hiv/hiv.html">4. HIV-AIDS</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Undergrad/AppliedDifEq/cws/cws.html">5. CWS Model of Alzheimemer’s Disease</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Undergrad/AppliedDifEq/gravity/gravity.html">6. Gravity Fed Water Delivery</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">COMPLEX VARIABLES IN GROUNDWATER MODELING Wheaton College Team</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../Advanced/Complex/jnb1.html">1. Setting the Scene</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Advanced/Complex/jnb2.html">2. Complex Analysis Background</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Advanced/Complex/jnb3.html">3. Idealized Groundwater Flow</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Advanced/Complex/jnb4.html">4. Contaminant Extraction Modeling</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Advanced/Complex/Complex_Potentials.html">Complex Potentials</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Advanced/Complex/model.html">Fischer-Calo Contaminant Model</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">ADVANCED DATA ANALYSIS Ying Li, Jonathan Zhu</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../AdvData.html">Advanced Data Analysis</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book/issues/new?title=Issue%20on%20page%20%2FProbStat/StatInf/01_Foundations.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../../_sources/ProbStat/StatInf/01_Foundations.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>


<script>
document.write(`
  <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
  </button>
`);
</script>

<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Foundations of Statistical Inference</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#sampling-and-the-central-limit-theorem">Sampling and the Central Limit Theorem</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#confidence-intervals">Confidence Intervals</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#confidence-intervals-in-python-libraries">Confidence Intervals in Python Libraries</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#why-is-it-called-a-confidence-interval">Why Is It Called a Confidence Interval?</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#exercises">Exercises</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#the-central-limit-theorem-for-discrete-numerical-random-variables">The Central Limit Theorem for Discrete Numerical Random Variables</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#confidence-intervals-for-differences-of-means">Confidence Intervals for Differences of Means</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#confidence-intervals-for-categorical-data-proportions">Confidence Intervals for Categorical Data/Proportions</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="foundations-of-statistical-inference">
<h1>Foundations of Statistical Inference<a class="headerlink" href="#foundations-of-statistical-inference" title="Permalink to this headline">#</a></h1>
<p>This chapter is all about how to use statistics to make decision from data, a process known as statistical inference. Because data is usually incomplete and has a lot of variability, this decision making process inherently contains a lot of uncertainty. But the difficulty shouldn’t deter us! The statistical decision-making process is based on a robust theory of probability, and one of the easiest ways to illustrate this theory is using computation.</p>
<p>In this section we take a look at one of the main probability results that allows us to do statistical inference: the Central Limit Theorem. We’ll then show how the Central Limit Theorem leads us to the first tool of statistical inference, the confidence interval.</p>
<section id="sampling-and-the-central-limit-theorem">
<h2>Sampling and the Central Limit Theorem<a class="headerlink" href="#sampling-and-the-central-limit-theorem" title="Permalink to this headline">#</a></h2>
<p>To get us thinking about statistical decision-making, let’s imagine a hypothetical scenario where we are an agent for a football player (that’s <em>soccer</em> to Americans). As an agent, we want to negotiate a good deal for our client, who plays in the English Premier League. To do this we might need to first try to estimate the average salary for all players in the league.</p>
<p>Unlike a real-world statistical estimate, in this scenario we have access to the entire <em>population</em> of player salaries for the 2022-23 Premier League season. This data comes from <a class="reference external" href="https://fbref.com/en/comps/9/wages/Premier-League-Wages">FBref</a> and is in units of pounds (£, GBP) per week.</p>
<p>Here we will read in the data, which is in the file <code class="docutils literal notranslate"><span class="pre">EPL_wages_22_23.csv</span></code>, and display the first 10 rows. These correspond to the 10 highest paid players—you may recognize some of the names!</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">salaries</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;EPL_wages_22_23.csv&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Rk&quot;</span><span class="p">,</span><span class="s2">&quot;Notes&quot;</span><span class="p">,</span> <span class="s2">&quot;Player-additional&quot;</span><span class="p">,</span><span class="s2">&quot;Annual Wages&quot;</span><span class="p">])</span>
<span class="n">salaries</span><span class="p">[</span><span class="s2">&quot;Weekly Wages (GBP)&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">salaries</span><span class="p">[</span><span class="s2">&quot;Weekly Wages&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">extract</span><span class="p">(</span><span class="s1">&#39;(\d+)&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
<span class="n">salaries</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">NameError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="n">Cell</span> <span class="n">In</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">line</span> <span class="mi">1</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">salaries</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;EPL_wages_22_23.csv&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Rk&quot;</span><span class="p">,</span><span class="s2">&quot;Notes&quot;</span><span class="p">,</span> <span class="s2">&quot;Player-additional&quot;</span><span class="p">,</span><span class="s2">&quot;Annual Wages&quot;</span><span class="p">])</span>
<span class="g g-Whitespace">      </span><span class="mi">2</span> <span class="n">salaries</span><span class="p">[</span><span class="s2">&quot;Weekly Wages (GBP)&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">salaries</span><span class="p">[</span><span class="s2">&quot;Weekly Wages&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">extract</span><span class="p">(</span><span class="s1">&#39;(\d+)&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
<span class="g g-Whitespace">      </span><span class="mi">3</span> <span class="n">salaries</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>

<span class="ne">NameError</span>: name &#39;pd&#39; is not defined
</pre></div>
</div>
</div>
</div>
<p>One of the key ideas in statistics is that even if the distribution of the population (in this case, footballers’ weekly salaries) is not normal, the distribution of the average salary of a large number of <em>randomly selected</em> footballers <em>does</em> have an (approximately) normal distribution. Hence, even though any estimation we make from a sample contains some uncertainty, we can quantify that uncertainty and make the best decision possible.</p>
<p><em>Note:</em> Of course, there are probably a lot more helpful things to calculate than simply the average player salary. For instance, we could look at salaries of players with similar statistics. Take a look at the section on linear algebra and clustering. <strong>(add link here later)</strong></p>
<p>We begin by taking a look at the population of all player salaries. Note that this distribution is highly skewed, and far from being normal. In fact, the distribution of player salaries is modeled fairly well with an exponential distribution! Below, we calculate the mean and standard deviation of the weekly wages from this dataset, and compare the histogram of weekly wages to the normal distribution with the same mean and standard deviation as well as the exponential distribution with the same mean.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pop_mean</span> <span class="o">=</span> <span class="n">salaries</span><span class="p">[</span><span class="s2">&quot;Weekly Wages (GBP)&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="n">pop_sd</span> <span class="o">=</span> <span class="n">salaries</span><span class="p">[</span><span class="s2">&quot;Weekly Wages (GBP)&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">std</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Population mean is </span><span class="si">{</span><span class="n">pop_mean</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">, standard deviation is </span><span class="si">{</span><span class="n">pop_sd</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">weekly_wages</span> <span class="o">=</span> <span class="n">salaries</span><span class="p">[</span><span class="s1">&#39;Weekly Wages (GBP)&#39;</span><span class="p">]</span>

<span class="c1"># use default seaborn palette</span>
<span class="n">palette</span> <span class="o">=</span> <span class="nb">iter</span><span class="p">(</span><span class="n">sns</span><span class="o">.</span><span class="n">color_palette</span><span class="p">())</span>

<span class="c1"># plot histogram</span>
<span class="n">axis</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">histplot</span><span class="p">(</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">weekly_wages</span><span class="p">,</span>
    <span class="n">stat</span> <span class="o">=</span> <span class="s1">&#39;density&#39;</span><span class="p">,</span>
    <span class="n">color</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="n">palette</span><span class="p">),</span> <span class="c1"># use next color in palette</span>
    <span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.4</span><span class="p">,</span>
    <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;histogram of weekly wages&#39;</span>
<span class="p">)</span>

<span class="c1"># plot exponential distribution</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">max</span><span class="p">(</span><span class="n">weekly_wages</span><span class="p">),</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">axis</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
    <span class="n">x</span><span class="p">,</span>
    <span class="n">scipy</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">expon</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">weekly_wages</span><span class="p">)),</span>
    <span class="n">color</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="n">palette</span><span class="p">),</span> <span class="c1"># use next color in palette</span>
    <span class="n">linewidth</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span>
    <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;exponential distribution&#39;</span>
<span class="p">)</span>

<span class="c1"># plot normal distribution</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">100000</span><span class="p">,</span> <span class="nb">max</span><span class="p">(</span><span class="n">weekly_wages</span><span class="p">),</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">axis</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
    <span class="n">x</span><span class="p">,</span>
    <span class="n">scipy</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">norm</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">weekly_wages</span><span class="p">),</span> <span class="n">scale</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">weekly_wages</span><span class="p">)),</span>
    <span class="n">color</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="n">palette</span><span class="p">),</span> <span class="c1"># use next color in palette</span>
    <span class="n">linewidth</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span>
    <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;normal distribution&#39;</span>
<span class="p">)</span>

<span class="n">axis</span><span class="o">.</span><span class="n">ticklabel_format</span><span class="p">(</span><span class="n">style</span><span class="o">=</span><span class="s1">&#39;plain&#39;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">)</span>

<span class="n">axis</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Distribution of Weekly Wages&quot;</span><span class="p">)</span>
<span class="n">axis</span><span class="o">.</span><span class="n">legend</span><span class="p">();</span>
</pre></div>
</div>
</div>
</div>
<p>In our hypothetical scenario, let’s imagine that we didn’t have access to <em>all</em> of the data, but only knew the salaries for 35 random players. We could take the average salary of those 35 players, but would it be close to the real average salary of <em>all</em> the players?</p>
<p>The following code will take a random sample of 35 players, and compute the (sample) average of the salaries of those players. Is it close to the actual salary?</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">my_sample</span> <span class="o">=</span> <span class="n">salaries</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">35</span><span class="p">)</span>

<span class="n">sample_mean</span> <span class="o">=</span> <span class="n">my_sample</span><span class="p">[</span><span class="s2">&quot;Weekly Wages (GBP)&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="n">sample_sd</span> <span class="o">=</span> <span class="n">my_sample</span><span class="p">[</span><span class="s2">&quot;Weekly Wages (GBP)&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">std</span><span class="p">()</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Sample mean is </span><span class="si">{</span><span class="n">sample_mean</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>It’s important to note that this sample mean is just one possible value. If we had taken a different random sample of 35 players, we would get a different sample average. You can see this for yourself if you run the code several times. We thus understand the sample mean as a random variable.</p>
<p>As an example, if we randomly selected highly-paid players such as Cristiano Ronaldo, we would expect our sample average to be higher than the population average. If we randomly selected a lot of young players or reserves, we would expect our sample average to be lower. But how much lower or higher is possible? How much lower or higher should we expect? We can answer this question by understanding sampling distributions. In other words, if the sample mean is a random variable, what is its distribution?</p>
<p>Because we have access to the entire population of data, we can explore this idea through simulation. Instead of taking just one sample mean from a sample of size 35, we can take many of them and look at the possible values.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># calculate the means of 1000 random samples of size 35</span>
<span class="n">many_sample_means</span> <span class="o">=</span> <span class="p">[</span><span class="n">salaries</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">35</span><span class="p">)[</span><span class="s2">&quot;Weekly Wages (GBP)&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1000</span><span class="p">)]</span>

<span class="c1"># plot histogram of many_sample_means</span>
<span class="n">axis</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">histplot</span><span class="p">(</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">many_sample_means</span><span class="p">,</span>
    <span class="n">stat</span> <span class="o">=</span> <span class="s1">&#39;density&#39;</span><span class="p">,</span>
    <span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.6</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">axis</span><span class="o">.</span><span class="n">ticklabel_format</span><span class="p">(</span><span class="n">style</span><span class="o">=</span><span class="s1">&#39;plain&#39;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">)</span>
<span class="n">axis</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Average Weekly Wages (GBP)&quot;</span><span class="p">)</span>
<span class="n">axis</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Histogram of Many Sample Means&quot;</span><span class="p">);</span>
</pre></div>
</div>
</div>
</div>
<p>Now let’s compare this to the theory. What does the Central Limit Theorem tell us?</p>
<p>If the sample size is “large enough”, then the sample mean, considered as a random variable, is approximately normally distributed with the same mean as the population and with standard deviation equal to the population standard deviation divided by the sample size. In mathematical language,</p>
<div class="amsmath math notranslate nohighlight" id="equation-d5a37723-0c22-4e4c-a91b-f2b1974cb719">
<span class="eqno">(4)<a class="headerlink" href="#equation-d5a37723-0c22-4e4c-a91b-f2b1974cb719" title="Permalink to this equation">#</a></span>\[\begin{equation}
    \displaystyle \overline{X} \sim N\left(\mu, \frac{\sigma}{\sqrt{n}}\right),
\end{equation}\]</div>
<p>where <span class="math notranslate nohighlight">\(\overline{X}\)</span> is the sample mean, <span class="math notranslate nohighlight">\(\mu\)</span> is the population mean, <span class="math notranslate nohighlight">\(\sigma\)</span> is the population standard deviation, and <span class="math notranslate nohighlight">\(n\)</span> is the sample size.</p>
<p>In our case, <span class="math notranslate nohighlight">\(n = 35\)</span>, and the population mean and standard deviation were calculated above. Let’s replot our histogram of <code class="docutils literal notranslate"><span class="pre">many_sample_means</span></code>, along with the normal distribution with the same mean and standard deviation, and see how it matches up with the theory.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Same histogram as above, with normal distribution overlay</span>

<span class="c1"># use default seaborn palette</span>
<span class="n">palette</span> <span class="o">=</span> <span class="nb">iter</span><span class="p">(</span><span class="n">sns</span><span class="o">.</span><span class="n">color_palette</span><span class="p">())</span>

<span class="c1"># plot histogram</span>
<span class="n">histcolor</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="n">palette</span><span class="p">)</span> <span class="c1"># use next color in palette</span>
<span class="n">axis</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">histplot</span><span class="p">(</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">many_sample_means</span><span class="p">,</span>
    <span class="n">stat</span> <span class="o">=</span> <span class="s1">&#39;density&#39;</span><span class="p">,</span>
    <span class="n">color</span> <span class="o">=</span> <span class="n">histcolor</span><span class="p">,</span>
    <span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.6</span><span class="p">,</span>
    <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;histogram of</span><span class="se">\n</span><span class="s1">many_sample_means&#39;</span>
<span class="p">)</span>

<span class="c1"># plot normal distribution</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">many_sample_means</span><span class="p">),</span> <span class="nb">max</span><span class="p">(</span><span class="n">many_sample_means</span><span class="p">),</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">axis</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
    <span class="n">x</span><span class="p">,</span>
    <span class="n">scipy</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">norm</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">many_sample_means</span><span class="p">),</span> <span class="n">scale</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">many_sample_means</span><span class="p">)),</span>
    <span class="n">color</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="n">palette</span><span class="p">),</span> <span class="c1"># use next color in palette</span>
    <span class="n">linewidth</span> <span class="o">=</span> <span class="mi">4</span><span class="p">,</span>
    <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;normal distribution&#39;</span>
<span class="p">)</span>

<span class="n">axis</span><span class="o">.</span><span class="n">ticklabel_format</span><span class="p">(</span><span class="n">style</span><span class="o">=</span><span class="s1">&#39;plain&#39;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">)</span>
<span class="n">axis</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Average Weekly Wages (GBP)&quot;</span><span class="p">)</span>
<span class="n">axis</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Distribution of Many Sample Means&quot;</span><span class="p">)</span>
<span class="n">axis</span><span class="o">.</span><span class="n">legend</span><span class="p">();</span>
</pre></div>
</div>
</div>
</div>
<p>We now see that even though the average weekly salary of 35 players is variable, and changes based on which 35 players we get, overall we have a good idea of which values we’re likely to get!</p>
<p>All of this depends on the sample size being “large enough”, which leaves us with a big question: how large is large enough?</p>
<p>You can play around with the interactive widget below to try different sample sizes and see how well the theoretical normal distribution matches up with the sampling distribution. Given a sample size, the widget plots the average of 10000 random samples of that size from the salary data, overlaid with the normal distribution with the same mean and standard deviation.</p>
<p>Drag the slider to select different sample sizes, and click the labels in the legend to hide or show different parts of the graph. Notice how the histogram of the averages fits the normal distribution more closely as the sample size increases.</p>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Get the average of reps samples from data with the given sample size and replacement policy</span>
<span class="k">def</span> <span class="nf">get_sample_avg</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">size</span><span class="p">,</span> <span class="n">reps</span><span class="p">,</span> <span class="n">replace</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="k">return</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">size</span><span class="p">,</span> <span class="n">replace</span><span class="o">=</span><span class="n">replace</span><span class="p">)</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">())</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">reps</span><span class="p">)]</span>

<span class="c1"># Define sample sizes and number of repetitions for sampling</span>
<span class="n">sample_sizes</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">45</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">sample_sizes</span><span class="p">)</span>
<span class="n">reps</span> <span class="o">=</span> <span class="mi">10000</span>

<span class="c1"># Use default seaborn palette (reference: https://josephlemaitre.com/2022/06/use-a-seaborn-color-palette-for-plotly-figures/)</span>
<span class="n">plotly_palette</span> <span class="o">=</span> <span class="nb">iter</span><span class="p">([</span><span class="sa">f</span><span class="s2">&quot;rgb(</span><span class="si">{</span><span class="n">c</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="mi">256</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">c</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="mi">256</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">c</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="mi">256</span><span class="si">}</span><span class="s2">)&quot;</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">sns</span><span class="o">.</span><span class="n">color_palette</span><span class="p">()])</span>
<span class="n">histcolor</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="n">plotly_palette</span><span class="p">)</span>
<span class="n">normcolor</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="n">plotly_palette</span><span class="p">)</span>

<span class="c1"># Create figure</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">go</span><span class="o">.</span><span class="n">Figure</span><span class="p">()</span>

<span class="c1"># Set consistent limits for axes in all traces</span>
<span class="n">xlim</span> <span class="o">=</span> <span class="p">(</span><span class="mi">12000</span><span class="p">,</span> <span class="mi">200000</span><span class="p">)</span>
<span class="n">ylim</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">4.5e-05</span><span class="p">)</span>

<span class="c1"># Define which sample size will be initially visible</span>
<span class="c1"># (note that this is the index of the sample size)</span>
<span class="n">initial_sample_size_index</span> <span class="o">=</span> <span class="mi">0</span>

<span class="c1"># Get averages for all possible sample sizes</span>
<span class="c1"># averages[i] is the average of reps samples of size sample_sizes[i] (with replacement)</span>
<span class="n">averages</span> <span class="o">=</span> <span class="p">[</span><span class="n">get_sample_avg</span><span class="p">(</span><span class="n">salaries</span><span class="p">[</span><span class="s2">&quot;Weekly Wages (GBP)&quot;</span><span class="p">],</span> <span class="n">size</span><span class="p">,</span> <span class="n">reps</span><span class="p">,</span> <span class="n">replace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="k">for</span> <span class="n">size</span> <span class="ow">in</span> <span class="n">sample_sizes</span><span class="p">]</span>

<span class="c1"># Add histogram traces</span>
<span class="c1"># (the histogram for averages[i] is plotted as the ith trace, fig.data[i])</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">avg</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">averages</span><span class="p">):</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">add_trace</span><span class="p">(</span>
        <span class="n">go</span><span class="o">.</span><span class="n">Histogram</span><span class="p">(</span>
            <span class="c1"># initially, only the histogram for initial_sample_size should be visible</span>
            <span class="n">visible</span> <span class="o">=</span> <span class="kc">True</span> <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="n">initial_sample_size_index</span> <span class="k">else</span> <span class="kc">False</span><span class="p">,</span>
            <span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;histogram&lt;br&gt;of averages&quot;</span><span class="p">,</span> <span class="c1"># label for legend</span>
            <span class="n">x</span> <span class="o">=</span> <span class="n">avg</span><span class="p">,</span>
            <span class="n">marker</span> <span class="o">=</span> <span class="p">{</span> <span class="s2">&quot;color&quot;</span><span class="p">:</span> <span class="n">histcolor</span> <span class="p">},</span>
            <span class="n">hoverinfo</span> <span class="o">=</span> <span class="s2">&quot;x+y&quot;</span><span class="p">,</span>
            <span class="n">histnorm</span> <span class="o">=</span> <span class="s2">&quot;probability density&quot;</span><span class="p">,</span>
        <span class="p">)</span>
    <span class="p">)</span>

<span class="c1"># Add normal pdf traces</span>
<span class="c1"># (the normal pdf for averages[i] is plotted as the (i+n)th trace, fig.data[i+n])</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">*</span><span class="n">xlim</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">avg</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">averages</span><span class="p">):</span>
    <span class="c1"># determine x-axis limits</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">add_trace</span><span class="p">(</span>
        <span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span>
            <span class="c1"># initially, only the normal pdf for initial_sample_size should be visible</span>
            <span class="n">visible</span> <span class="o">=</span> <span class="kc">True</span> <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="n">initial_sample_size_index</span> <span class="k">else</span> <span class="kc">False</span><span class="p">,</span>
            <span class="n">line</span> <span class="o">=</span> <span class="p">{</span> <span class="s2">&quot;width&quot;</span><span class="p">:</span> <span class="mi">4</span> <span class="p">},</span>
            <span class="n">marker</span> <span class="o">=</span> <span class="p">{</span> <span class="s2">&quot;color&quot;</span><span class="p">:</span> <span class="n">normcolor</span> <span class="p">},</span>
            <span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;normal&lt;br&gt;distribution&quot;</span><span class="p">,</span> <span class="c1"># label for legend</span>
            <span class="n">hoverinfo</span> <span class="o">=</span> <span class="s2">&quot;x+y&quot;</span><span class="p">,</span>
            <span class="n">x</span> <span class="o">=</span> <span class="n">x</span><span class="p">,</span>
            <span class="n">y</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">norm</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">avg</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">avg</span><span class="p">))</span>
        <span class="p">)</span>
    <span class="p">)</span>
    
<span class="n">get_title</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">i</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;Averages of </span><span class="si">{</span><span class="n">reps</span><span class="si">}</span><span class="s2"> Random Samples of Size </span><span class="si">{</span><span class="n">sample_sizes</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span>

<span class="c1"># Create steps for the slider to select sample size</span>
<span class="n">steps</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
    <span class="n">steps</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
        <span class="s2">&quot;method&quot;</span><span class="p">:</span> <span class="s2">&quot;update&quot;</span><span class="p">,</span>
        <span class="s2">&quot;args&quot;</span><span class="p">:</span> <span class="p">[</span> <span class="c1"># arguments to pass to the update method</span>
            <span class="c1"># update visibility so only the histogram and normal pdf for this sample size are visible</span>
            <span class="p">{</span> <span class="s2">&quot;visible&quot;</span><span class="p">:</span> <span class="p">[</span><span class="kc">True</span> <span class="k">if</span> <span class="p">(</span><span class="n">j</span> <span class="o">==</span> <span class="n">i</span> <span class="ow">or</span> <span class="n">j</span><span class="o">-</span><span class="n">n</span> <span class="o">==</span> <span class="n">i</span><span class="p">)</span> <span class="k">else</span> <span class="kc">False</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">fig</span><span class="o">.</span><span class="n">data</span><span class="p">))]</span> <span class="p">},</span>
            <span class="c1"># update the title to reflect the change to the sample size</span>
            <span class="p">{</span> <span class="s2">&quot;title&quot;</span><span class="p">:</span> <span class="n">get_title</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="p">}</span>
        <span class="p">],</span>
        <span class="s2">&quot;label&quot;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">sample_sizes</span><span class="p">[</span><span class="n">i</span><span class="p">]),</span>
    <span class="p">})</span>

<span class="c1"># Create a slider using these steps and add it to fig</span>
<span class="n">fig</span><span class="o">.</span><span class="n">layout</span><span class="o">.</span><span class="n">sliders</span> <span class="o">=</span> <span class="p">[{</span>
    <span class="s2">&quot;active&quot;</span><span class="p">:</span> <span class="n">initial_sample_size_index</span><span class="p">,</span>
    <span class="s2">&quot;currentvalue&quot;</span><span class="p">:</span> <span class="p">{</span> <span class="s2">&quot;prefix&quot;</span><span class="p">:</span> <span class="s2">&quot;Sample Size: &quot;</span> <span class="p">},</span>
    <span class="s2">&quot;pad&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;t&quot;</span><span class="p">:</span> <span class="mi">50</span><span class="p">},</span>
    <span class="s2">&quot;steps&quot;</span><span class="p">:</span> <span class="n">steps</span><span class="p">,</span>
<span class="p">}]</span>

<span class="c1"># Set layout settings</span>
<span class="n">fig</span><span class="o">.</span><span class="n">update_layout</span><span class="p">(</span>
    <span class="n">title</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;x&quot;</span><span class="p">:</span> <span class="mf">0.5</span><span class="p">,</span>
        <span class="s2">&quot;text&quot;</span><span class="p">:</span> <span class="n">get_title</span><span class="p">(</span><span class="n">initial_sample_size_index</span><span class="p">)</span>
    <span class="p">},</span>
    <span class="n">xaxis</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;title&quot;</span><span class="p">:</span> <span class="s2">&quot;Average Weekly Wages (GBP)&quot;</span><span class="p">,</span>
        <span class="s2">&quot;range&quot;</span><span class="p">:</span> <span class="n">xlim</span><span class="p">,</span>
        <span class="s2">&quot;constrain&quot;</span><span class="p">:</span> <span class="s2">&quot;domain&quot;</span><span class="p">,</span>
    <span class="p">},</span>
    <span class="n">yaxis</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;title&quot;</span><span class="p">:</span> <span class="s2">&quot;Probability Density&quot;</span><span class="p">,</span>
        <span class="s2">&quot;tickformat&quot;</span><span class="p">:</span> <span class="s2">&quot;.2&quot;</span><span class="p">,</span>
        <span class="s2">&quot;range&quot;</span><span class="p">:</span> <span class="n">ylim</span><span class="p">,</span>
        <span class="s2">&quot;constrain&quot;</span><span class="p">:</span> <span class="s2">&quot;domain&quot;</span><span class="p">,</span>
    <span class="p">},</span>
    <span class="n">paper_bgcolor</span> <span class="o">=</span> <span class="s2">&quot;LightSteelBlue&quot;</span>
<span class="p">)</span>

<span class="c1"># Display figure</span>
<span class="n">fig</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</details>
</div>
<p>Statisticians will usually say that a sample size of 30 is large enough. Based on the widget above, would you agree with that? Do the distributions look approximately normal at that sample size?</p>
</section>
<section id="confidence-intervals">
<h2>Confidence Intervals<a class="headerlink" href="#confidence-intervals" title="Permalink to this headline">#</a></h2>
<p>In real life, the situation is much different. We will typically only have one sample, and hence one sample mean. We now know that if our sample size <span class="math notranslate nohighlight">\(n\)</span> is large enough, we are likely to be close to the true population mean. But how close are we? And can we quantify what “likely” means in this case?</p>
<p>The Central Limit Theorem (CLT) tells us where <span class="math notranslate nohighlight">\(\overline X\)</span> is likely to be in relation to <span class="math notranslate nohighlight">\(\mu\)</span>. Since <span class="math notranslate nohighlight">\(\displaystyle \overline{X} \sim N(\mu, \frac{\sigma}{\sqrt{n}})\)</span>, we know that 95% of the time, <span class="math notranslate nohighlight">\(\overline X\)</span> will fall within a distance of about 2 standard deviations from <span class="math notranslate nohighlight">\(\mu\)</span> (technically, the distance is more like 1.96). In other words, 95% of the area under the density function is between <span class="math notranslate nohighlight">\(\displaystyle \mu-1.96 \frac{\sigma}{\sqrt{n}}\)</span> and <span class="math notranslate nohighlight">\(\displaystyle \mu + 1.96  \frac{\sigma}{\sqrt{n}}\)</span>.</p>
<p>The plot below illustrates what 95% of the area under the standard normal density function looks like.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># create plot</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mf">8.5</span><span class="p">,</span><span class="mf">4.5</span><span class="p">))</span>

<span class="c1"># use default seaborn palette</span>
<span class="n">palette</span> <span class="o">=</span> <span class="nb">iter</span><span class="p">(</span><span class="n">sns</span><span class="o">.</span><span class="n">color_palette</span><span class="p">())</span>

<span class="c1"># plot standard normal pdf</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mf">3.5</span><span class="p">,</span> <span class="mf">3.5</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">norm</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="nb">next</span><span class="p">(</span><span class="n">palette</span><span class="p">),</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;pdf&#39;</span><span class="p">)</span>

<span class="c1"># set lower y-axis limit to 0</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_ylim</span><span class="p">()[</span><span class="mi">1</span><span class="p">])</span>

<span class="c1"># plot mean and standard deviation</span>
<span class="n">ax</span><span class="o">.</span><span class="n">vlines</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">ymin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">ymax</span><span class="o">=</span><span class="n">scipy</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">norm</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;dashed&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;grey&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;$\mu=0, \sigma=1$&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">vlines</span><span class="p">(</span><span class="n">x</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">ymin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">ymax</span><span class="o">=</span><span class="n">scipy</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">norm</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;dashed&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;grey&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">vlines</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">ymin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">ymax</span><span class="o">=</span><span class="n">scipy</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">norm</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;dashed&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;grey&#39;</span><span class="p">)</span>

<span class="c1"># plot and annotate x = ±1.96</span>
<span class="n">linecolor</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="n">palette</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="o">-</span><span class="mf">1.96</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;dashed&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">linecolor</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;$x = \pm1.96$&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="mf">1.96</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;dashed&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">linecolor</span><span class="p">)</span>
<span class="n">half_ylim</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">ax</span><span class="o">.</span><span class="n">get_ylim</span><span class="p">())</span><span class="o">/</span><span class="mi">2</span> <span class="c1"># coordinate at middle of y-axis</span>
<span class="n">ax</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span>
    <span class="s1">&#39;x = –1.96&#39;</span><span class="p">,</span>
    <span class="n">xy</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="mf">1.96</span><span class="p">,</span> <span class="n">half_ylim</span><span class="p">),</span>
    <span class="n">xytext</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="mf">25.5</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
    <span class="n">textcoords</span> <span class="o">=</span> <span class="s1">&#39;offset pixels&#39;</span><span class="p">,</span>
    <span class="n">fontsize</span> <span class="o">=</span> <span class="s1">&#39;medium&#39;</span>
<span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span>
    <span class="s1">&#39;x = 1.96&#39;</span><span class="p">,</span>
    <span class="n">xy</span> <span class="o">=</span> <span class="p">(</span><span class="mf">1.96</span><span class="p">,</span> <span class="n">half_ylim</span><span class="p">),</span>
    <span class="n">xytext</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="mf">25.5</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
    <span class="n">textcoords</span> <span class="o">=</span> <span class="s1">&#39;offset pixels&#39;</span><span class="p">,</span>
    <span class="n">fontsize</span> <span class="o">=</span> <span class="s1">&#39;medium&#39;</span>
<span class="p">)</span>

<span class="c1"># fill between x = ±1.96</span>
<span class="n">ax</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">where</span> <span class="o">=</span> <span class="p">(</span><span class="n">x</span> <span class="o">&gt;</span> <span class="o">-</span><span class="mf">1.96</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">x</span> <span class="o">&lt;</span> <span class="mf">1.96</span><span class="p">),</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.4</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;95</span><span class="si">% o</span><span class="s1">f area&#39;</span><span class="p">)</span>

<span class="c1"># set up legend, y-axis label, and title</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Density&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Standard Normal Distribution ($\mu=0, \sigma=1$)&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
</div>
<p>Now we know where <span class="math notranslate nohighlight">\(\overline X\)</span> is likely to fall in relation to <span class="math notranslate nohighlight">\(\mu\)</span>. We can express what we see in the graph as a probability:</p>
<div class="amsmath math notranslate nohighlight" id="equation-ce97d4e6-0f18-4831-99d2-6568b7c17591">
<span class="eqno">(5)<a class="headerlink" href="#equation-ce97d4e6-0f18-4831-99d2-6568b7c17591" title="Permalink to this equation">#</a></span>\[\begin{equation}
    P\left(\mu-1.96 \frac{\sigma}{\sqrt{n}} \le \overline X \le \mu + 1.96  \frac{\sigma}{\sqrt{n}}\right) = .95.
\end{equation}\]</div>
<p>With a little bit of algebraic manipulation, we can write this as an interval for <span class="math notranslate nohighlight">\(\mu\)</span>:</p>
<div class="amsmath math notranslate nohighlight" id="equation-93ec5d1d-fb81-4b3a-8bdc-6874162dec67">
<span class="eqno">(6)<a class="headerlink" href="#equation-93ec5d1d-fb81-4b3a-8bdc-6874162dec67" title="Permalink to this equation">#</a></span>\[\begin{equation}
    P\left(\overline{X}-1.96 \frac{\sigma}{\sqrt{n}} \le \mu \le \overline{X} + 1.96  \frac{\sigma}{\sqrt{n}}\right) = .95.
\end{equation}\]</div>
<p>In the real world, we’ll have a value of <span class="math notranslate nohighlight">\(\overline{X}\)</span>, and we want to know where <span class="math notranslate nohighlight">\(\mu\)</span> is. This second interval gives us exactly this! Look at what’s on the upper and lower side of the interval: (almost) all things we can calculate from the data, like <span class="math notranslate nohighlight">\(\overline X\)</span> and <span class="math notranslate nohighlight">\(n\)</span> (we’ll discuss how to handle the <span class="math notranslate nohighlight">\(\sigma\)</span> in a moment). This gives an interval for <span class="math notranslate nohighlight">\(\mu\)</span>, the population mean that we can’t calculate but want to know.</p>
<p>Let’s return to our hypothetical case. We have one sample of <span class="math notranslate nohighlight">\(n=35\)</span> players, and one observed sample mean. Since, hypothetically, we don’t know the population mean, can we give an interval where we think it is?</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># reference: https://matplotlib.org/stable/gallery/ticks/tick-formatters.html</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mf">6.4</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">))</span>

<span class="c1"># create number line by hiding unneeded elements of plot</span>
<span class="n">ax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_major_locator</span><span class="p">(</span><span class="n">ticker</span><span class="o">.</span><span class="n">NullLocator</span><span class="p">())</span>
<span class="k">for</span> <span class="n">spine</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;left&#39;</span><span class="p">,</span> <span class="s1">&#39;right&#39;</span><span class="p">,</span> <span class="s1">&#39;top&#39;</span><span class="p">]:</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="n">spine</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>

<span class="c1"># set up number line limits</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">1000</span><span class="o">*</span><span class="p">((</span><span class="n">sample_mean</span><span class="o">-</span><span class="mi">999</span><span class="p">)</span><span class="o">//</span><span class="mi">1000</span><span class="p">),</span> <span class="mi">1000</span><span class="o">*</span><span class="p">((</span><span class="n">sample_mean</span><span class="o">+</span><span class="mi">1999</span><span class="p">)</span><span class="o">//</span><span class="mi">1000</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

<span class="c1"># set up number line tick marks</span>
<span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_major_locator</span><span class="p">(</span><span class="n">ticker</span><span class="o">.</span><span class="n">MultipleLocator</span><span class="p">(</span><span class="mi">1000</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_minor_locator</span><span class="p">(</span><span class="n">ticker</span><span class="o">.</span><span class="n">MultipleLocator</span><span class="p">(</span><span class="mi">100</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_ticks_position</span><span class="p">(</span><span class="s1">&#39;bottom&#39;</span><span class="p">)</span>

<span class="c1"># plot sample mean</span>
<span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">sample_mean</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">s</span> <span class="o">=</span> <span class="mi">75</span><span class="p">,</span> <span class="n">clip_on</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span>
    <span class="s1">&#39;$\overline</span><span class="si">{X}</span><span class="s1">$&#39;</span><span class="p">,</span>
    <span class="n">xy</span> <span class="o">=</span> <span class="p">(</span><span class="n">sample_mean</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
    <span class="n">xytext</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="mi">4</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span>
    <span class="n">textcoords</span> <span class="o">=</span> <span class="s1">&#39;offset pixels&#39;</span><span class="p">,</span>
    <span class="n">fontsize</span> <span class="o">=</span> <span class="s1">&#39;large&#39;</span><span class="p">,</span>
<span class="p">)</span>

<span class="c1"># plot possible locations for population mean</span>
<span class="n">ax</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span>
    <span class="s1">&#39;$\mu$?&#39;</span><span class="p">,</span>
    <span class="n">xy</span> <span class="o">=</span> <span class="p">(</span><span class="n">sample_mean</span><span class="o">+</span><span class="mi">275</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
    <span class="n">xytext</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="mi">20</span><span class="p">,</span> <span class="mi">50</span><span class="p">),</span>
    <span class="n">textcoords</span> <span class="o">=</span> <span class="s1">&#39;offset pixels&#39;</span><span class="p">,</span>
    <span class="n">arrowprops</span> <span class="o">=</span> <span class="p">{</span> <span class="s1">&#39;arrowstyle&#39;</span><span class="p">:</span> <span class="s1">&#39;-&gt;&#39;</span><span class="p">,</span> <span class="s1">&#39;shrinkA&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;shrinkB&#39;</span><span class="p">:</span> <span class="mi">5</span> <span class="p">},</span>
    <span class="n">fontsize</span> <span class="o">=</span> <span class="s1">&#39;large&#39;</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span>
    <span class="s1">&#39;&#39;</span><span class="p">,</span>
    <span class="n">xy</span> <span class="o">=</span> <span class="p">(</span><span class="n">sample_mean</span><span class="o">-</span><span class="mi">350</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
    <span class="n">xytext</span> <span class="o">=</span> <span class="p">(</span><span class="n">sample_mean</span><span class="o">+</span><span class="mi">175</span><span class="p">,</span> <span class="mf">1.75</span><span class="p">),</span>
    <span class="n">arrowprops</span> <span class="o">=</span> <span class="p">{</span> <span class="s1">&#39;arrowstyle&#39;</span><span class="p">:</span> <span class="s1">&#39;-&gt;&#39;</span><span class="p">,</span> <span class="s1">&#39;shrinkA&#39;</span><span class="p">:</span> <span class="mi">7</span><span class="p">,</span> <span class="s1">&#39;shrinkB&#39;</span><span class="p">:</span> <span class="mi">7</span> <span class="p">},</span>
<span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span>
    <span class="s1">&#39;&#39;</span><span class="p">,</span>
    <span class="n">xy</span> <span class="o">=</span> <span class="p">(</span><span class="n">sample_mean</span><span class="o">+</span><span class="mi">500</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
    <span class="n">xytext</span> <span class="o">=</span> <span class="p">(</span><span class="n">sample_mean</span><span class="o">+</span><span class="mi">250</span><span class="p">,</span> <span class="mf">1.75</span><span class="p">),</span>
    <span class="n">arrowprops</span> <span class="o">=</span> <span class="p">{</span> <span class="s1">&#39;arrowstyle&#39;</span><span class="p">:</span> <span class="s1">&#39;-&gt;&#39;</span><span class="p">,</span> <span class="s1">&#39;shrinkA&#39;</span><span class="p">:</span> <span class="mi">7</span><span class="p">,</span> <span class="s1">&#39;shrinkB&#39;</span><span class="p">:</span> <span class="mi">7</span> <span class="p">},</span>
<span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Sample Mean vs. Population Mean&#39;</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="mf">2.5</span><span class="p">);</span>
</pre></div>
</div>
</div>
</div>
<p>We know from above that there is a 95% probability that the interval <span class="math notranslate nohighlight">\(\left(\overline{X}-1.96 \frac{\sigma}{\sqrt{n}}, \overline{X} + 1.96  \frac{\sigma}{\sqrt{n}}\right)\)</span> contains <span class="math notranslate nohighlight">\(\mu\)</span>. Let’s compute it!</p>
<p>We have access to the sample mean <span class="math notranslate nohighlight">\(\overline X\)</span>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Sample mean is </span><span class="si">{</span><span class="n">sample_mean</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>We don’t know the population standard deviation <span class="math notranslate nohighlight">\(\sigma\)</span>, but we might expect that the sample standard deviation <span class="math notranslate nohighlight">\(S\)</span> is sufficiently close. If you don’t believe that, we could also use a T-distribution, introduced in the next section. But in this case, our sample size is <span class="math notranslate nohighlight">\(n=35\)</span>, which is large enough to use <span class="math notranslate nohighlight">\(S\)</span> in place of <span class="math notranslate nohighlight">\(\sigma\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Sample standard deviation is </span><span class="si">{</span><span class="n">sample_sd</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Let’s put it all together based on our formula above:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">lower_ci</span> <span class="o">=</span> <span class="n">sample_mean</span> <span class="o">-</span> <span class="mf">1.96</span> <span class="o">*</span> <span class="n">sample_sd</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">35</span><span class="p">)</span>
<span class="n">upper_ci</span> <span class="o">=</span> <span class="n">sample_mean</span> <span class="o">+</span> <span class="mf">1.96</span> <span class="o">*</span> <span class="n">sample_sd</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">35</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;95% confidence interval is (</span><span class="si">{</span><span class="n">lower_ci</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">upper_ci</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">).&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>We are 95% confident that the average weekly salary for premier league players falls in the interval we calculated.</p>
<p>In our case, we actually have access to the real population parameter. Does our calculated interval actually contain the true population mean <span class="math notranslate nohighlight">\(\mu\)</span>? Let’s visualize it:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># create plot</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mf">6.4</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;95% Confidence Interval&quot;</span><span class="p">);</span>

<span class="c1"># set up limits for x-axis (reference: https://stackoverflow.com/a/3411435)</span>
<span class="n">least</span> <span class="o">=</span> <span class="nb">min</span><span class="p">([</span><span class="n">lower_ci</span><span class="p">,</span> <span class="n">upper_ci</span><span class="p">,</span> <span class="n">pop_mean</span><span class="p">])</span>
<span class="n">greatest</span> <span class="o">=</span> <span class="nb">max</span><span class="p">([</span><span class="n">lower_ci</span><span class="p">,</span> <span class="n">upper_ci</span><span class="p">,</span> <span class="n">pop_mean</span><span class="p">])</span>
<span class="n">power_of_10</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">least</span><span class="p">))))</span>
<span class="n">get_bound</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="nb">int</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="o">-</span><span class="n">power_of_10</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">get_bound</span><span class="p">(</span><span class="n">least</span><span class="p">)</span> <span class="o">-</span> <span class="mi">10</span><span class="o">**</span><span class="n">power_of_10</span><span class="p">,</span> <span class="n">get_bound</span><span class="p">(</span><span class="n">greatest</span><span class="p">)</span> <span class="o">+</span> <span class="mi">10</span><span class="o">**</span><span class="n">power_of_10</span><span class="p">)</span>

<span class="c1"># create number line by hiding unneeded elements of plot</span>
<span class="n">ax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_major_locator</span><span class="p">(</span><span class="n">ticker</span><span class="o">.</span><span class="n">NullLocator</span><span class="p">())</span>
<span class="k">for</span> <span class="n">spine</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;left&#39;</span><span class="p">,</span> <span class="s1">&#39;right&#39;</span><span class="p">,</span> <span class="s1">&#39;top&#39;</span><span class="p">]:</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="n">spine</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>

<span class="c1"># set up number line tick marks (reference: https://matplotlib.org/stable/gallery/ticks/tick-formatters.html)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_major_locator</span><span class="p">(</span><span class="n">ticker</span><span class="o">.</span><span class="n">MultipleLocator</span><span class="p">(</span><span class="mi">10</span> <span class="o">**</span> <span class="n">power_of_10</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_minor_locator</span><span class="p">(</span><span class="n">ticker</span><span class="o">.</span><span class="n">MultipleLocator</span><span class="p">(</span><span class="mi">10</span> <span class="o">**</span> <span class="p">(</span><span class="n">power_of_10</span><span class="o">-</span><span class="mi">1</span><span class="p">)))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_ticks_position</span><span class="p">(</span><span class="s1">&#39;bottom&#39;</span><span class="p">)</span>

<span class="c1"># plot confidence interval</span>
<span class="n">ax</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">lower_ci</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;dashed&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">upper_ci</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;dashed&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">lower_ci</span><span class="p">,</span> <span class="n">upper_ci</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">y1</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="mi">2</span><span class="p">,</span> <span class="n">y2</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="mi">2</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

<span class="c1"># plot and annotate sample and population means</span>
<span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">pop_mean</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">s</span> <span class="o">=</span> <span class="mi">75</span><span class="p">,</span> <span class="n">clip_on</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span>
    <span class="s1">&#39;$\mu$&#39;</span><span class="p">,</span>
    <span class="n">xy</span> <span class="o">=</span> <span class="p">(</span><span class="n">pop_mean</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
    <span class="n">xytext</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="mi">4</span><span class="p">,</span> <span class="mi">15</span><span class="p">),</span>
    <span class="n">textcoords</span> <span class="o">=</span> <span class="s1">&#39;offset pixels&#39;</span><span class="p">,</span>
    <span class="n">fontsize</span> <span class="o">=</span> <span class="s1">&#39;large&#39;</span><span class="p">,</span>
<span class="p">);</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="confidence-intervals-in-python-libraries">
<h2>Confidence Intervals in Python Libraries<a class="headerlink" href="#confidence-intervals-in-python-libraries" title="Permalink to this headline">#</a></h2>
<p>We don’t always have to calculate confidence intervals by hand. There are many Python libraries that will do this for you! One way is to use the <code class="docutils literal notranslate"><span class="pre">scipy.stats</span></code> library. We’ll also find in other sections that much of the statistical inference code we run will automatically provide a confidence interval. The previous demonstrations will hopefully be helpful for you to know what’s going on beneath the surface of the code and to give you a bit more <em>confidence</em> in the computation.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">confidence_level</span> <span class="o">=</span> <span class="mf">0.95</span>
<span class="p">(</span><span class="n">lower_ci</span><span class="p">,</span> <span class="n">upper_ci</span><span class="p">)</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">norm</span><span class="o">.</span><span class="n">interval</span><span class="p">(</span>
    <span class="n">confidence_level</span><span class="p">,</span>
    <span class="n">loc</span><span class="o">=</span><span class="n">sample_mean</span><span class="p">,</span>
    <span class="n">scale</span><span class="o">=</span><span class="n">sample_sd</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">35</span><span class="p">)</span>
<span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;95% confidence interval is (</span><span class="si">{</span><span class="n">lower_ci</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">upper_ci</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">).&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Of course, 95% is not the only value we could use for the confidence level, though it is the most common. If we wanted to be more certain, we could increase that value. If precision was less important, we could decrease it. It all depends on the context in which you are working!</p>
<p>In later sections, we will primarily compute confidence intervals for means using the T distribution, rather than the normal distribution. The difference between the intervals is discussed in those places.</p>
</section>
<section id="why-is-it-called-a-confidence-interval">
<h2>Why Is It Called a Confidence Interval?<a class="headerlink" href="#why-is-it-called-a-confidence-interval" title="Permalink to this headline">#</a></h2>
<p>The number 95% is a probability, but it is not the probability that <span class="math notranslate nohighlight">\(\mu\)</span>, the population mean, is in the interval. The population mean doesn’t change, and hence it is either in the given interval or not—no probabilties involved! So what does the 95% confidence mean?</p>
<p>The probability 95% concerns the interval itself, which depends on the data that we used. A different sample would give us different data, and hence a different interval. The “confidence” in “95% confidence” refers to the sampling process. Another way to say this is that 95% of all the possible confidence intervals we could construct in this way contain the true population mean.</p>
<p>Since we have access to an entire population of footballers’ salaries, we can take many samples and construct many sample means and confidence intervals. If we did this, how many would we expect to have the true average weekly salary (the population mean)?</p>
<p>You can play around with the interactive widget below to explore this idea. Given a confidence level, the widget takes 25 random samples of size 35 from the salary data and plots a confidence interval for each one. (This widget is inspired by the OpenIntro <a class="reference external" href="https://openintro.shinyapps.io/confidence_intervals/">lab on confidence intervals</a>, which is licensed under a <a class="reference external" href="http://creativecommons.org/licenses/by-sa/4.0/">Creative Commons Attribution-ShareAlike 4.0 International License</a>.)</p>
<p>Drag the slider to select different confidence levels, and click the labels in the legend to hide or show different parts of the graph. Notice how different confidence levels result in different numbers of confidence intervals containing the population mean. (These numbers might not exactly match the confidence level, but that’s because we’re only constructing 25 confidence intervals, which is far short of the <em>total</em> number of possible confidence intervals we could construct.)</p>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sample_size</span> <span class="o">=</span> <span class="mi">35</span> <span class="c1"># size of each sample</span>
<span class="n">num_samples</span> <span class="o">=</span> <span class="mi">25</span> <span class="c1"># number of samples to take for each confidence level</span>
<span class="n">conflevels</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mf">0.60</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">)</span> <span class="c1"># confidence levels</span>
<span class="n">num_conflevels</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">conflevels</span><span class="p">)</span>

<span class="n">x_with_mu</span> <span class="o">=</span> <span class="p">[[]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_conflevels</span><span class="p">)]</span>
<span class="n">x_without_mu</span> <span class="o">=</span> <span class="p">[[]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_conflevels</span><span class="p">)]</span>
<span class="n">y_with_mu</span> <span class="o">=</span> <span class="p">[[]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_conflevels</span><span class="p">)]</span>
<span class="n">y_without_mu</span> <span class="o">=</span> <span class="p">[[]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_conflevels</span><span class="p">)]</span>

<span class="c1"># for each confidence level in conflevels, generate confidence intervals</span>
<span class="c1"># from num_samples samples of size sample_size, splitting them into</span>
<span class="c1"># those containing mu and those not containing mu</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">conflevel</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">conflevels</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_samples</span><span class="p">):</span>
        <span class="p">(</span><span class="n">lower_ci</span><span class="p">,</span> <span class="n">upper_ci</span><span class="p">)</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">weightstats</span><span class="o">.</span><span class="n">zconfint</span><span class="p">(</span>
            <span class="n">x1</span> <span class="o">=</span> <span class="n">salaries</span><span class="p">[</span><span class="s2">&quot;Weekly Wages (GBP)&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">sample_size</span><span class="p">),</span>
            <span class="n">alpha</span> <span class="o">=</span> <span class="mi">1</span><span class="o">-</span><span class="n">conflevel</span>
        <span class="p">)</span>
        <span class="k">if</span> <span class="n">lower_ci</span> <span class="o">&lt;=</span> <span class="n">pop_mean</span> <span class="o">&lt;=</span> <span class="n">upper_ci</span><span class="p">:</span>
            <span class="n">x_with_mu</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">lower_ci</span><span class="p">,</span> <span class="n">upper_ci</span><span class="p">])</span>
            <span class="n">y_with_mu</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">j</span><span class="p">,</span><span class="n">j</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">x_without_mu</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">lower_ci</span><span class="p">,</span> <span class="n">upper_ci</span><span class="p">])</span>
            <span class="n">y_without_mu</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">j</span><span class="p">,</span><span class="n">j</span><span class="p">])</span>

<span class="c1"># create figure</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">go</span><span class="o">.</span><span class="n">Figure</span><span class="p">()</span>

<span class="c1"># set up colors (using default seaborn palette)</span>
<span class="n">plotly_palette</span> <span class="o">=</span> <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;rgb(</span><span class="si">{</span><span class="n">c</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="mi">256</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">c</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="mi">256</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">c</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="mi">256</span><span class="si">}</span><span class="s2">)&quot;</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">sns</span><span class="o">.</span><span class="n">color_palette</span><span class="p">()]</span>
<span class="n">confint_with_mu_color</span> <span class="o">=</span> <span class="n">plotly_palette</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">confint_without_mu_color</span> <span class="o">=</span> <span class="n">plotly_palette</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
<span class="n">mean_color</span> <span class="o">=</span> <span class="n">plotly_palette</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

<span class="c1"># index of initially visible conflevel</span>
<span class="n">initial_conflevel</span> <span class="o">=</span> <span class="mi">0</span>

<span class="c1"># for each confidence level</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_conflevels</span><span class="p">):</span>
    <span class="c1"># add a trace for each confidence level containing mu</span>
    <span class="k">for</span> <span class="n">j</span><span class="p">,</span> <span class="p">(</span><span class="n">ci</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">x_with_mu</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">y_with_mu</span><span class="p">[</span><span class="n">i</span><span class="p">])):</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">add_trace</span><span class="p">(</span>
            <span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span>
                <span class="n">visible</span> <span class="o">=</span> <span class="kc">True</span> <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="n">initial_conflevel</span> <span class="k">else</span> <span class="kc">False</span><span class="p">,</span>
                <span class="n">x</span> <span class="o">=</span> <span class="n">ci</span><span class="p">,</span>
                <span class="n">y</span> <span class="o">=</span> <span class="n">y</span><span class="p">,</span>
                <span class="n">line</span> <span class="o">=</span> <span class="p">{</span> <span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="n">confint_with_mu_color</span><span class="p">,</span> <span class="s1">&#39;width&#39;</span><span class="p">:</span> <span class="mi">3</span> <span class="p">},</span>
                <span class="n">marker</span> <span class="o">=</span> <span class="p">{</span> <span class="s2">&quot;size&quot;</span><span class="p">:</span> <span class="mi">10</span> <span class="p">},</span>
                <span class="n">mode</span> <span class="o">=</span> <span class="s1">&#39;lines+markers&#39;</span><span class="p">,</span>
                <span class="n">hovertemplate</span> <span class="o">=</span> <span class="s1">&#39;%</span><span class="si">{x:.2f}</span><span class="s1">&lt;extra&gt;&lt;/extra&gt;&#39;</span><span class="p">,</span>
                <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;confidence intervals&lt;br&gt;containing the&lt;br&gt;population mean&#39;</span><span class="p">,</span>
                <span class="n">legendgroup</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">conflevels</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="si">}</span><span class="s1">_with_mu&#39;</span><span class="p">,</span> <span class="c1"># group confidence intervals for this confidence level together</span>
                <span class="n">showlegend</span> <span class="o">=</span> <span class="kc">True</span> <span class="k">if</span> <span class="n">j</span> <span class="o">==</span> <span class="mi">0</span> <span class="k">else</span> <span class="kc">False</span><span class="p">,</span> <span class="c1"># display legend entry only for first confidence interval</span>
            <span class="p">)</span>
        <span class="p">)</span>
    <span class="c1"># add a trace for each confidence level not containing mu</span>
    <span class="k">for</span> <span class="n">j</span><span class="p">,</span> <span class="p">(</span><span class="n">ci</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">x_without_mu</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">y_without_mu</span><span class="p">[</span><span class="n">i</span><span class="p">])):</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">add_trace</span><span class="p">(</span>
            <span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span>
                <span class="n">visible</span> <span class="o">=</span> <span class="kc">True</span> <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="n">initial_conflevel</span> <span class="k">else</span> <span class="kc">False</span><span class="p">,</span>
                <span class="n">x</span> <span class="o">=</span> <span class="n">ci</span><span class="p">,</span>
                <span class="n">y</span> <span class="o">=</span> <span class="n">y</span><span class="p">,</span>
                <span class="n">line</span> <span class="o">=</span> <span class="p">{</span> <span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="n">confint_without_mu_color</span><span class="p">,</span> <span class="s1">&#39;width&#39;</span><span class="p">:</span> <span class="mi">3</span> <span class="p">},</span>
                <span class="n">marker</span> <span class="o">=</span> <span class="p">{</span> <span class="s2">&quot;size&quot;</span><span class="p">:</span> <span class="mi">10</span> <span class="p">},</span>
                <span class="n">mode</span> <span class="o">=</span> <span class="s1">&#39;lines+markers&#39;</span><span class="p">,</span>
                <span class="n">hovertemplate</span> <span class="o">=</span> <span class="s1">&#39;%</span><span class="si">{x:.2f}</span><span class="s1">&lt;extra&gt;&lt;/extra&gt;&#39;</span><span class="p">,</span>
                <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;confidence intervals&lt;br&gt;not containing the&lt;br&gt;population mean&#39;</span><span class="p">,</span>
                <span class="n">legendgroup</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">conflevels</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="si">}</span><span class="s1">_without_mu&#39;</span><span class="p">,</span> <span class="c1"># group confidence intervals for this confidence level together</span>
                <span class="n">showlegend</span> <span class="o">=</span> <span class="kc">True</span> <span class="k">if</span> <span class="n">j</span> <span class="o">==</span> <span class="mi">0</span> <span class="k">else</span> <span class="kc">False</span><span class="p">,</span> <span class="c1"># display legend entry only for first confidence interval</span>
            <span class="p">)</span>
        <span class="p">)</span>

<span class="c1"># add trace for population mean</span>
<span class="n">fig</span><span class="o">.</span><span class="n">add_trace</span><span class="p">(</span>
    <span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span>
        <span class="n">visible</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="c1"># always visible</span>
        <span class="n">x</span> <span class="o">=</span> <span class="p">[</span><span class="n">pop_mean</span><span class="p">]</span><span class="o">*</span><span class="mi">2</span><span class="p">,</span>
        <span class="n">y</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">num_samples</span><span class="p">],</span>
        <span class="n">marker</span> <span class="o">=</span> <span class="p">{</span> <span class="s1">&#39;size&#39;</span><span class="p">:</span> <span class="mi">0</span> <span class="p">},</span>
        <span class="n">mode</span> <span class="o">=</span> <span class="s1">&#39;lines&#39;</span><span class="p">,</span>
        <span class="n">line</span> <span class="o">=</span> <span class="p">{</span> <span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="n">mean_color</span><span class="p">,</span> <span class="s1">&#39;width&#39;</span><span class="p">:</span> <span class="mf">3.5</span><span class="p">,</span> <span class="s1">&#39;dash&#39;</span><span class="p">:</span> <span class="s1">&#39;dash&#39;</span> <span class="p">},</span>
        <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;population mean&#39;</span><span class="p">,</span>
        <span class="n">legendrank</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="c1"># place first in legend</span>
        <span class="n">hoverinfo</span> <span class="o">=</span> <span class="s1">&#39;none&#39;</span><span class="p">,</span>
    <span class="p">)</span>
<span class="p">)</span>

<span class="c1"># get title for graph given index of confidence level</span>
<span class="k">def</span> <span class="nf">get_title</span><span class="p">(</span><span class="n">i</span><span class="p">):</span>
    <span class="n">num_with_mu</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">x_with_mu</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
    <span class="k">return</span> <span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">num_samples</span><span class="si">}</span><span class="s1"> Confidence Intervals with </span><span class="si">{</span><span class="nb">int</span><span class="p">(</span><span class="n">conflevels</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="mi">100</span><span class="p">)</span><span class="si">}</span><span class="s1">% Confidence&lt;br&gt;&lt;br&gt;&#39;</span> <span class="o">+</span>
        <span class="sa">f</span><span class="s1">&#39;&lt;sup&gt;</span><span class="si">{</span><span class="n">num_with_mu</span><span class="si">}</span><span class="s1"> of the </span><span class="si">{</span><span class="n">num_samples</span><span class="si">}</span><span class="s1"> confidence intervals in this graph &#39;</span> <span class="o">+</span>
        <span class="sa">f</span><span class="s1">&#39;(</span><span class="si">{</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x_with_mu</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">/</span><span class="n">num_samples</span><span class="p">)</span><span class="o">*</span><span class="mi">100</span><span class="si">:</span><span class="s1">.0f</span><span class="si">}</span><span class="s1">%) contain the population mean.&lt;/sup&gt;&#39;</span><span class="p">)</span>

<span class="c1"># create steps for the slider to select confidence level</span>
<span class="n">steps</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_conflevels</span><span class="p">):</span>
    <span class="n">steps</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
        <span class="s1">&#39;method&#39;</span><span class="p">:</span> <span class="s1">&#39;update&#39;</span><span class="p">,</span>
        <span class="s1">&#39;args&#39;</span><span class="p">:</span> <span class="p">[</span> <span class="c1"># arguments to pass to the update method</span>
            <span class="c1"># update visibility so only the histogram and normal pdf for this sample size are visible</span>
            <span class="p">{</span>
                <span class="s2">&quot;visible&quot;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ravel</span><span class="p">([[</span><span class="kc">True</span><span class="p">]</span><span class="o">*</span><span class="n">num_samples</span> <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="n">j</span> <span class="k">else</span> <span class="p">[</span><span class="kc">False</span><span class="p">]</span><span class="o">*</span><span class="n">num_samples</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_conflevels</span><span class="p">)]),</span> <span class="kc">True</span><span class="p">)</span>
            <span class="p">},</span>
            <span class="c1"># update the title to reflect the change to the sample size</span>
            <span class="p">{</span>
                <span class="s1">&#39;title&#39;</span><span class="p">:</span> <span class="n">get_title</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
            <span class="p">}</span>
        <span class="p">],</span>
        <span class="s1">&#39;label&#39;</span><span class="p">:</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="nb">int</span><span class="p">(</span><span class="n">conflevels</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="mi">100</span><span class="p">)</span><span class="si">}</span><span class="s1">%&#39;</span><span class="p">,</span>
    <span class="p">})</span>

<span class="c1"># create a slider using these steps and add it to fig</span>
<span class="n">fig</span><span class="o">.</span><span class="n">layout</span><span class="o">.</span><span class="n">sliders</span> <span class="o">=</span> <span class="p">[{</span>
    <span class="s1">&#39;active&#39;</span><span class="p">:</span> <span class="n">initial_conflevel</span><span class="p">,</span>
    <span class="s1">&#39;currentvalue&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;prefix&#39;</span><span class="p">:</span> <span class="s1">&#39;Confidence Level: &#39;</span><span class="p">},</span>
    <span class="s1">&#39;pad&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;t&#39;</span><span class="p">:</span> <span class="mi">50</span><span class="p">},</span>
    <span class="s1">&#39;steps&#39;</span><span class="p">:</span> <span class="n">steps</span><span class="p">,</span>
<span class="p">}]</span>

<span class="c1"># set layout settings</span>
<span class="n">fig</span><span class="o">.</span><span class="n">update_layout</span><span class="p">(</span>
    <span class="n">title</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;x&quot;</span><span class="p">:</span> <span class="mf">0.5</span><span class="p">,</span>
        <span class="s2">&quot;text&quot;</span><span class="p">:</span> <span class="n">get_title</span><span class="p">(</span><span class="n">initial_conflevel</span><span class="p">)</span>
    <span class="p">},</span>
    <span class="n">xaxis</span> <span class="o">=</span> <span class="p">{</span> <span class="s2">&quot;title&quot;</span><span class="p">:</span> <span class="s2">&quot;Average Weekly Wages (GBP)&quot;</span> <span class="p">},</span>
    <span class="n">yaxis</span> <span class="o">=</span> <span class="p">{</span> <span class="s2">&quot;visible&quot;</span><span class="p">:</span> <span class="kc">False</span> <span class="p">},</span> <span class="c1"># hide y-axis</span>
    <span class="n">paper_bgcolor</span> <span class="o">=</span> <span class="s2">&quot;LightSteelBlue&quot;</span>
<span class="p">)</span>

<span class="c1"># show figure</span>
<span class="n">fig</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</details>
</div>
</section>
<section id="exercises">
<h2>Exercises<a class="headerlink" href="#exercises" title="Permalink to this headline">#</a></h2>
<ol class="arabic simple">
<li><p>Use the widget above to construct 25 different 90% confidence intervals for the average weekly wages of Premier League players. How many of the 25 contain the true population mean? Is this the number you expect? Would it be possible for exactly 90% of the intervals to contain the true population mean?</p></li>
<li><p>Choose your own confidence level, and construct a single confidence interval for the average weekly wages of a Premier League player. Describe your interval in a complete sentence.</p></li>
</ol>
</section>
<section id="the-central-limit-theorem-for-discrete-numerical-random-variables">
<h2>The Central Limit Theorem for Discrete Numerical Random Variables<a class="headerlink" href="#the-central-limit-theorem-for-discrete-numerical-random-variables" title="Permalink to this headline">#</a></h2>
<p>Finally, we want to note that this theory holds for any numerical distribution, even one that is discrete!  In the widget below, we demonstrate the CLT for discrete distributions by approximating the sample average of a number of dice rolls.</p>
<figure>
    <img src='https://upload.wikimedia.org/wikipedia/commons/thumb/c/c4/2-Dice-Icon.svg/240px-2-Dice-Icon.svg.png' alt='Dice icon by Steaphan Greene, licensed under CC BY-SA 3.0.'>
    <figcaption>Dice icon by Steaphan Greene, licensed under CC BY-SA 3.0.</figcaption>
</figure>
<p>Given a sample size, the widget simulates rolling a die that many times and then takes the average of the rolls. It does this 10000 times and then plots the histogram of the resulting averages, overlaid with the normal distribution with the same mean and standard deviation.</p>
<p>Drag the slider to select different sample sizes, and click the labels in the legend to hide or show different parts of the graph. Notice how the histogram of the averages fits the normal distribution more closely as the sample size increases.</p>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Outcomes of rolling a die</span>
<span class="n">die_outcomes</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">7</span><span class="p">))</span>

<span class="c1"># Get the average of reps samples from data with the given sample size and replacement policy</span>
<span class="k">def</span> <span class="nf">get_sample_avg</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">size</span><span class="p">,</span> <span class="n">reps</span><span class="p">,</span> <span class="n">replace</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="k">return</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">size</span><span class="p">,</span> <span class="n">replace</span><span class="o">=</span><span class="n">replace</span><span class="p">)</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">())</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">reps</span><span class="p">)]</span>

<span class="c1"># Define sample sizes and number of repetitions for sampling</span>
<span class="n">sample_sizes</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">sample_sizes</span><span class="p">)</span>
<span class="n">reps</span> <span class="o">=</span> <span class="mi">10000</span>

<span class="c1"># Use default seaborn palette (reference: https://josephlemaitre.com/2022/06/use-a-seaborn-color-palette-for-plotly-figures/)</span>
<span class="n">plotly_palette</span> <span class="o">=</span> <span class="nb">iter</span><span class="p">([</span><span class="sa">f</span><span class="s2">&quot;rgb(</span><span class="si">{</span><span class="n">c</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="mi">256</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">c</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="mi">256</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">c</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="mi">256</span><span class="si">}</span><span class="s2">)&quot;</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">sns</span><span class="o">.</span><span class="n">color_palette</span><span class="p">()])</span>
<span class="n">histcolor</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="n">plotly_palette</span><span class="p">)</span>
<span class="n">normcolor</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="n">plotly_palette</span><span class="p">)</span>

<span class="c1"># Create figure</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">go</span><span class="o">.</span><span class="n">Figure</span><span class="p">()</span>

<span class="c1"># Set consistent limits for axes in all traces</span>
<span class="n">xlim</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>
<span class="n">ylim</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

<span class="c1"># Define which sample size will be initially visible</span>
<span class="c1"># (note that this is the index of the sample size)</span>
<span class="n">initial_sample_size_index</span> <span class="o">=</span> <span class="mi">0</span>

<span class="n">get_title</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">i</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;Averages of </span><span class="si">{</span><span class="n">reps</span><span class="si">}</span><span class="s2"> Random Samples of Size </span><span class="si">{</span><span class="n">sample_sizes</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span>

<span class="c1"># Get averages for all possible sample sizes</span>
<span class="c1"># averages[i] is the average of reps samples of size sample_sizes[i] (with replacement)</span>
<span class="n">averages</span> <span class="o">=</span> <span class="p">[</span><span class="n">get_sample_avg</span><span class="p">(</span><span class="n">die_outcomes</span><span class="p">,</span> <span class="n">size</span><span class="p">,</span> <span class="n">reps</span><span class="p">,</span> <span class="n">replace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="k">for</span> <span class="n">size</span> <span class="ow">in</span> <span class="n">sample_sizes</span><span class="p">]</span>

<span class="c1"># Add histogram traces</span>
<span class="c1"># (the histogram for averages[i] is plotted as the ith trace, fig.data[i])</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">avg</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">averages</span><span class="p">):</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">add_trace</span><span class="p">(</span>
        <span class="n">go</span><span class="o">.</span><span class="n">Histogram</span><span class="p">(</span>
            <span class="c1"># initially, only the histogram for initial_sample_size should be visible</span>
            <span class="n">visible</span> <span class="o">=</span> <span class="kc">True</span> <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="n">initial_sample_size_index</span> <span class="k">else</span> <span class="kc">False</span><span class="p">,</span>
            <span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;histogram&lt;br&gt;of averages&quot;</span><span class="p">,</span> <span class="c1"># label for legend</span>
            <span class="n">x</span> <span class="o">=</span> <span class="n">avg</span><span class="p">,</span>
            <span class="n">marker</span> <span class="o">=</span> <span class="p">{</span> <span class="s2">&quot;color&quot;</span><span class="p">:</span> <span class="n">histcolor</span> <span class="p">},</span>
            <span class="n">hoverinfo</span> <span class="o">=</span> <span class="s2">&quot;x+y&quot;</span><span class="p">,</span>
            <span class="n">xbins</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;size&quot;</span> <span class="p">:</span> <span class="mi">1</span><span class="o">/</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)},</span>
            <span class="n">histnorm</span> <span class="o">=</span> <span class="s2">&quot;probability density&quot;</span><span class="p">,</span>
        <span class="p">)</span>
    <span class="p">)</span>

<span class="c1"># Add normal pdf traces</span>
<span class="c1"># (the normal pdf for averages[i] is plotted as the (i+n)th trace, fig.data[i+n])</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">avg</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">averages</span><span class="p">):</span>
    <span class="c1"># determine x-axis limits</span>
    <span class="k">if</span> <span class="n">xlim</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">*</span><span class="n">xlim</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1"># use the same x-axis limits as averages[i]</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">fig</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">x</span><span class="p">),</span> <span class="nb">max</span><span class="p">(</span><span class="n">fig</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">x</span><span class="p">),</span> <span class="mi">100</span><span class="p">)</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">add_trace</span><span class="p">(</span>
        <span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span>
            <span class="c1"># initially, only the normal pdf for initial_sample_size should be visible</span>
            <span class="n">visible</span> <span class="o">=</span> <span class="kc">True</span> <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="n">initial_sample_size_index</span> <span class="k">else</span> <span class="kc">False</span><span class="p">,</span>
            <span class="n">line</span> <span class="o">=</span> <span class="p">{</span> <span class="s2">&quot;width&quot;</span><span class="p">:</span> <span class="mi">6</span> <span class="p">},</span>
            <span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;normal&lt;br&gt;distribution&quot;</span><span class="p">,</span> <span class="c1"># label for legend</span>
            <span class="n">x</span> <span class="o">=</span> <span class="n">x</span><span class="p">,</span>
            <span class="n">y</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">norm</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">avg</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">avg</span><span class="p">)),</span>
            <span class="n">marker</span> <span class="o">=</span> <span class="p">{</span> <span class="s2">&quot;color&quot;</span><span class="p">:</span> <span class="n">normcolor</span> <span class="p">},</span>
            <span class="n">hoverinfo</span> <span class="o">=</span> <span class="s2">&quot;x+y&quot;</span><span class="p">,</span>
        <span class="p">)</span>
    <span class="p">)</span>

<span class="c1"># Create steps for the slider to select sample size</span>
<span class="n">steps</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
    <span class="n">steps</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
        <span class="s2">&quot;method&quot;</span><span class="p">:</span> <span class="s2">&quot;update&quot;</span><span class="p">,</span>
        <span class="s2">&quot;args&quot;</span><span class="p">:</span> <span class="p">[</span> <span class="c1"># arguments to pass to the update method</span>
            <span class="c1"># update visibility so only the histogram and normal pdf for this sample size are visible</span>
            <span class="p">{</span> <span class="s2">&quot;visible&quot;</span><span class="p">:</span> <span class="p">[</span><span class="kc">True</span> <span class="k">if</span> <span class="p">(</span><span class="n">j</span> <span class="o">==</span> <span class="n">i</span> <span class="ow">or</span> <span class="n">j</span><span class="o">-</span><span class="n">n</span> <span class="o">==</span> <span class="n">i</span><span class="p">)</span> <span class="k">else</span> <span class="kc">False</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">fig</span><span class="o">.</span><span class="n">data</span><span class="p">))]</span> <span class="p">},</span>
            <span class="c1"># update the title to reflect the change to the sample size</span>
            <span class="p">{</span> <span class="s2">&quot;title&quot;</span><span class="p">:</span> <span class="n">get_title</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="p">}</span>
        <span class="p">],</span>
        <span class="s2">&quot;label&quot;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">sample_sizes</span><span class="p">[</span><span class="n">i</span><span class="p">]),</span>
    <span class="p">})</span>

<span class="c1"># Create a slider using these steps and add it to fig</span>
<span class="n">fig</span><span class="o">.</span><span class="n">layout</span><span class="o">.</span><span class="n">sliders</span> <span class="o">=</span> <span class="p">[{</span>
    <span class="s2">&quot;active&quot;</span><span class="p">:</span> <span class="n">initial_sample_size_index</span><span class="p">,</span>
    <span class="s2">&quot;currentvalue&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;prefix&quot;</span><span class="p">:</span> <span class="s2">&quot;Sample Size: &quot;</span><span class="p">},</span>
    <span class="s2">&quot;pad&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;t&quot;</span><span class="p">:</span> <span class="mi">50</span><span class="p">},</span>
    <span class="s2">&quot;steps&quot;</span><span class="p">:</span> <span class="n">steps</span><span class="p">,</span>
<span class="p">}]</span>

<span class="c1"># Set layout settings</span>
<span class="n">fig</span><span class="o">.</span><span class="n">update_layout</span><span class="p">(</span>
    <span class="n">title</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;x&quot;</span><span class="p">:</span> <span class="mf">0.5</span><span class="p">,</span>
        <span class="s2">&quot;text&quot;</span><span class="p">:</span> <span class="n">get_title</span><span class="p">(</span><span class="n">initial_sample_size_index</span><span class="p">)</span>
    <span class="p">},</span>
    <span class="n">xaxis</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;title&quot;</span><span class="p">:</span> <span class="s2">&quot;Average Die Outcome&quot;</span><span class="p">,</span>
        <span class="s2">&quot;range&quot;</span><span class="p">:</span> <span class="n">xlim</span><span class="p">,</span>
        <span class="s2">&quot;constrain&quot;</span><span class="p">:</span> <span class="s2">&quot;domain&quot;</span><span class="p">,</span>
    <span class="p">},</span>
    <span class="n">yaxis</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;title&quot;</span><span class="p">:</span> <span class="s2">&quot;Probability Density&quot;</span><span class="p">,</span>
        <span class="s2">&quot;range&quot;</span><span class="p">:</span> <span class="n">ylim</span><span class="p">,</span>
        <span class="s2">&quot;constrain&quot;</span><span class="p">:</span> <span class="s2">&quot;domain&quot;</span><span class="p">,</span>
    <span class="p">},</span>
    <span class="n">paper_bgcolor</span> <span class="o">=</span> <span class="s2">&quot;LightSteelBlue&quot;</span>
<span class="p">)</span>

<span class="c1"># Display figure</span>
<span class="n">fig</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</details>
</div>
</section>
<section id="confidence-intervals-for-differences-of-means">
<h2>Confidence Intervals for Differences of Means<a class="headerlink" href="#confidence-intervals-for-differences-of-means" title="Permalink to this headline">#</a></h2>
<p>Coming soon: Lab or exercises, with some theory walkthrough</p>
</section>
<section id="confidence-intervals-for-categorical-data-proportions">
<h2>Confidence Intervals for Categorical Data/Proportions<a class="headerlink" href="#confidence-intervals-for-categorical-data-proportions" title="Permalink to this headline">#</a></h2>
<p>We can also calculate confidence intervals for population proportions and differences of proportions. We’ll explore that in the next section alongside hypothesis testing!</p>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./ProbStat/StatInf"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
                <footer class="bd-footer-article">
                  
<div class="footer-article-items footer-article__inner">
  
    <div class="footer-article-item"><!-- Previous / next buttons -->
<div class="prev-next-area">
    <a class="left-prev"
       href="00_Instructor_Notes.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Section 0: Instructor Notes</p>
      </div>
    </a>
    <a class="right-next"
       href="02_Inference_Categorical.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Hypothesis Testing for Categorical Data</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div></div>
  
</div>

                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#sampling-and-the-central-limit-theorem">Sampling and the Central Limit Theorem</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#confidence-intervals">Confidence Intervals</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#confidence-intervals-in-python-libraries">Confidence Intervals in Python Libraries</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#why-is-it-called-a-confidence-interval">Why Is It Called a Confidence Interval?</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#exercises">Exercises</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#the-central-limit-theorem-for-discrete-numerical-random-variables">The Central Limit Theorem for Discrete Numerical Random Variables</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#confidence-intervals-for-differences-of-means">Confidence Intervals for Differences of Means</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#confidence-intervals-for-categorical-data-proportions">Confidence Intervals for Categorical Data/Proportions</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Paul Isihara and Thomas VanDrunen, Editors
</p>

  </div>
  
  <div class="footer-item">
    
  <p class="copyright">
    
      © Copyright 2022.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/bootstrap.js?digest=e353d410970836974a52"></script>
<script src="../../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>