

<!DOCTYPE html>


<html >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Hypothesis Testing for Categorical Data &#8212; An Introduction to Python Jupyter Notebooks for College Math Teachers</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=e353d410970836974a52" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=e353d410970836974a52" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" href="../_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=e353d410970836974a52" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52" />

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'Stat/02_Inference_Categorical';</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="None"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
  

<a class="navbar-brand logo" href="../intro.html">
  
  
  
  
    
    
      
    
    
    <img src="../_static/logo.png" class="logo__image only-light" alt="Logo image"/>
    <script>document.write(`<img src="../_static/logo.png" class="logo__image only-dark" alt="Logo image"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../intro.html">
                    An Introduction to  Python Jupyter Notebooks for College Math Teachers
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">PREFACE</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../JMM23.html">JMM 2023</a></li>
<li class="toctree-l1"><a class="reference internal" href="../PatternsSOLUTION.html">Patterns</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">GETTING STARTED</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../PreCollege/GettingStarted/start.html">0. Getting Started with Jupyter Notebooks (JNBs)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../PreCollege/GettingStarted/Functions.html">1. Functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../PreCollege/GettingStarted/numpy.html">2 The Numerical Python (numpy) Library</a></li>
<li class="toctree-l1"><a class="reference internal" href="../PreCollege/GettingStarted/pandas.html">3 Pandas</a></li>
<li class="toctree-l1"><a class="reference internal" href="../PreCollege/GettingStarted/matplotlib.html">4 Matplotlib</a></li>
<li class="toctree-l1"><a class="reference internal" href="../PreCollege/GettingStarted/if.html">5. if Conditional Statements</a></li>
<li class="toctree-l1"><a class="reference internal" href="../PreCollege/GettingStarted/for.html">6. For Loops</a></li>
<li class="toctree-l1"><a class="reference internal" href="../PreCollege/GettingStarted/dataframes.html">7. Dataframes</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">PRE-COLLEGE STEAM OUTREACH Paul Isihara</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../DD.html">Data Detectives</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Celestial.html">Celestial Ministries  Outreach Program</a></li>
<li class="toctree-l1"><a class="reference internal" href="../PreCollege/Celestial/jnb1.html">1 Functions- Michael Jordan’s Highest Scoring Game</a></li>
<li class="toctree-l1"><a class="reference internal" href="../PreCollege/Celestial/jnb2.html">2 How bad is COVID by Chicago Zipcode</a></li>
<li class="toctree-l1"><a class="reference internal" href="../PreCollege/Celestial/jnb3.html">3. Pixel Images</a></li>
<li class="toctree-l1"><a class="reference internal" href="../PreCollege/Celestial/jnb4.html">4. Random Number Approximation of Pi</a></li>
<li class="toctree-l1"><a class="reference internal" href="../PreCollege/Celestial/jnb5.html">5. Name That Tune!</a></li>
<li class="toctree-l1"><a class="reference internal" href="../PreCollege/Celestial/jnb6.html">6. Word Clouds</a></li>
<li class="toctree-l1"><a class="reference internal" href="../PreCollege/Celestial/jnb7.html">7. Mapping Famous Chicagoans</a></li>
<li class="toctree-l1"><a class="reference internal" href="../PreCollege/Celestial/jnb8.html">8. Predicting Exemplary K-8 Chicago Schools</a></li>
<li class="toctree-l1"><a class="reference internal" href="../PreCollege/Celestial/jnb9.html">9. Simulating Formula One</a></li>
<li class="toctree-l1"><a class="reference internal" href="../PreCollege/Celestial/jnb10.html">10. It’s Christmas</a></li>
<li class="toctree-l1"><a class="reference internal" href="../PreCollege/Demo.html">12. After School Program Demo</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">PYTHON PROGRAMMING GUIDE Thomas VanDrunen</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../Intropy.html">Intro to Python</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">PROBABILITY MODELS Laura Gross, Yiheng Liang</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../Prob.html">Probability Models</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">EXPLORATORY DATA ANALYSIS Laura Gross, Yiheng Liang</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../Data.html">Exploratory Data Analysis</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">STATISTICAL INFERENCE Peter Jantsch, Claire Wagner</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../Stat.html">Statistical Inference</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">CALCULUS  Inne Singgih</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../Undergrad/Calculus/Intro.html">1. Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Undergrad/Calculus/Functions.html">2. Functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Undergrad/Calculus/Sec3.html">3. Limits, Continuity, and Rates</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Undergrad/Calculus/Sec4.html">4 Derivatives</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">CALCULUS FOR DAILY LIFE  Paul Isihara, Sam Carlson, Ziling Zhong</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../Undergrad/AppliedCalc/twocommodity.html">1. Linear Systems and the 2 Commodity Model</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Undergrad/AppliedCalc/marginal.html">2. Marginal and Average Cost</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Undergrad/AppliedCalc/design.html">3. Max/Min and Object Design</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Undergrad/AppliedCalc/cobbs.html">4. Optimization and Cobbs-Douglas Production</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Undergrad/AppliedCalc/rates.html">5. Related Rates and Volumes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Undergrad/AppliedCalc/football.html">6. Related Rates with Trig Functions and Football</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Undergrad/AppliedCalc/jnb7.html">7. Probability Distributions and Drive Thrus</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Undergrad/AppliedCalc/control.html">8. Normal Distribution and Process Control</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Undergrad/AppliedCalc/ols.html">9. Partial Derivatives and OLS Regression</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Undergrad/AppliedCalc/gini.html">10. Area Between Curves and the Gini Index</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Undergrad/AppliedCalc/income.html">11. Integral Test and Income Streams</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Undergrad/AppliedCalc/ode.html">12. Ordinary Differential Equations and Exponential Growth/Decay</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">LINEAR ALGEBRA Soheil Anbouhi</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../Linear.html">Linear Algebra</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Undergrad/Linear/0intro.html">0. Introduction</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../Undergrad/Linear/1system.html">1. Systems of Linear Equations</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-1"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../Undergrad/Linear/1_2sol.html">1.2 Solution Set of  Linear Systems</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../Undergrad/Linear/2matrix.html">2. Matrix Algebra</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-2"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../Undergrad/Linear/2_1det.html">2.1 Determinant</a></li>
</ul>
</li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">LINEAR ALGEBRA AND OPTIMIZATION FOR DATA ANALYSIS Wheaton College Team</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../Aplin.html">Applied Linear Algebra</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Advanced/LinearAlgebra/Introduction.html">1. Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Advanced/LinearAlgebra/OLS/jnb1.html">2. OLS Linear Regression</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Advanced/LinearAlgebra/KMeans/jnb2.html">3. K-means Clustering</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Advanced/LinearAlgebra/PCA/jnb3.html">4. Dimension Reduction by Principal Component Analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Advanced/LinearAlgebra/SVM/jnb4.html">5. Binary Classification of Labelled Data by Support Vector Machines</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">DIFFERENTIAL EQUATIONS Rachel Petrik</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../DifEq.html">Differential Equations</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">COMPLEX VARIABLES IN GROUNDWATER MODELING Wheaton College Team</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../Advanced/Complex/jnb1.html">1. Setting the Scene</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Advanced/Complex/jnb2.html">2. Complex Analysis Background</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Advanced/Complex/jnb3.html">3. Idealized Groundwater Flow</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Advanced/Complex/jnb4.html">4. Contaminant Extraction Modeling</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Advanced/Complex/Complex_Potentials.html">Complex Potentials</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Advanced/Complex/model.html">Fischer-Calo Contaminant Model</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">ADVANCED DATA ANALYSIS Ying Li, Jonathan Zhu</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../AdvData.html">Advanced Data Analysis</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book/issues/new?title=Issue%20on%20page%20%2FStat/02_Inference_Categorical.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/Stat/02_Inference_Categorical.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>


<script>
document.write(`
  <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
  </button>
`);
</script>

<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Hypothesis Testing for Categorical Data</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#statistical-decision-making-the-hypothesis-test">Statistical Decision Making: The Hypothesis Test</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#the-wellcome-global-monitor-survey">The Wellcome Global Monitor Survey</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#making-a-hypothesis">Making a Hypothesis</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#how-much-evidence-do-we-need">How Much Evidence Do We Need?</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#the-test-statistic-using-data-to-decide">The Test Statistic: Using Data to Decide</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#making-a-decision">Making a Decision</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#difference-of-two-proportions">Difference of Two Proportions</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#using-python-for-the-test">Using Python for the test</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#exercises">Exercises</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-1">Exercise 1</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-2">Exercise 2</a></li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># import libraries</span>
<span class="c1"># Always run this cell first!</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="kn">import</span> <span class="nn">scipy</span>
<span class="kn">import</span> <span class="nn">statsmodels.api</span> <span class="c1"># appear to need to import the api as well as the library itself for the interpreter to find the modules</span>
<span class="kn">import</span> <span class="nn">statsmodels</span> <span class="k">as</span> <span class="nn">sm</span>

<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="o">%</span><span class="k">matplotlib</span> inline
<span class="kn">import</span> <span class="nn">plotly.graph_objects</span> <span class="k">as</span> <span class="nn">go</span>
<span class="kn">import</span> <span class="nn">plotly.offline</span>
<span class="n">plotly</span><span class="o">.</span><span class="n">offline</span><span class="o">.</span><span class="n">init_notebook_mode</span><span class="p">(</span><span class="n">connected</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="c1"># make plotly work with Jupyter Notebook using CDN</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">ModuleNotFoundError</span><span class="g g-Whitespace">                       </span>Traceback (most recent call last)
<span class="n">Cell</span> <span class="n">In</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">line</span> <span class="mi">7</span>
<span class="g g-Whitespace">      </span><span class="mi">4</span> <span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="g g-Whitespace">      </span><span class="mi">6</span> <span class="kn">import</span> <span class="nn">scipy</span>
<span class="ne">----&gt; </span><span class="mi">7</span> <span class="kn">import</span> <span class="nn">statsmodels.api</span> <span class="c1"># appear to need to import the api as well as the library itself for the interpreter to find the modules</span>
<span class="g g-Whitespace">      </span><span class="mi">8</span> <span class="kn">import</span> <span class="nn">statsmodels</span> <span class="k">as</span> <span class="nn">sm</span>
<span class="g g-Whitespace">     </span><span class="mi">10</span> <span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="ne">ModuleNotFoundError</span>: No module named &#39;statsmodels&#39;
</pre></div>
</div>
</div>
</div>
<section class="tex2jax_ignore mathjax_ignore" id="hypothesis-testing-for-categorical-data">
<h1>Hypothesis Testing for Categorical Data<a class="headerlink" href="#hypothesis-testing-for-categorical-data" title="Permalink to this headline">#</a></h1>
<section id="statistical-decision-making-the-hypothesis-test">
<h2>Statistical Decision Making: The Hypothesis Test<a class="headerlink" href="#statistical-decision-making-the-hypothesis-test" title="Permalink to this headline">#</a></h2>
<p>In the last section, we saw how probabilty theory can help us to estimate how close a sample average is to the true average of a population using a confidence interval.</p>
<p>In this section, we will look at another important tool in the statistician’s repetoire, the statistical test of hypotheses. Hypothesis testing works much like the scientific method: we make a hypothesis about how the world works, construct an experiment to test it, gather data from the experiment, and then evaluate how closely that data fits the hypothesis.</p>
<p>Let’s look at this process in the context of an example.</p>
<section id="the-wellcome-global-monitor-survey">
<h3>The Wellcome Global Monitor Survey<a class="headerlink" href="#the-wellcome-global-monitor-survey" title="Permalink to this headline">#</a></h3>
<p>The Wellcome Global Monitor survey, which is part of the World Gallup Poll, asks people around the world about their views on topics related to science and health. The <a class="reference external" href="https://doi.org/10.5255/UKDA-SN-8466-2">most recent data</a>, as of writing, is from 2018 and is available under a <a class="reference external" href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution 4.0 International License</a>. The data consists of survey answers from over 140,000 people in 144 different countries, collected in person or by telephone.</p>
<p>One of our goals in this chapter is to help you understand the statistical decision making process, and, through learning more, to have more confidence about how scientists move forward in their understanding. As a statistician and educator, I’m very interested in the level of trust people have in scientists and the scientific process.</p>
<p>Hence, we are going to look today at the Wellcome Global Monitor’s Trust in Scientists Index, which measures how much each respondent trusts scientists based on their answers to five of the questions in the survey:</p>
<ul class="simple">
<li><p>“How much do you trust scientists in your country?”</p></li>
<li><p>“In general, how much do you trust scientists to find out accurate information about the world?”</p></li>
<li><p>“How much do you trust scientists working in colleges/universities in this country to do their work with the intention of benefiting the public?”</p></li>
<li><p>“How much do you trust scientists working in colleges/universities in this country to be open and honest about who is paying for their work?”</p></li>
<li><p>“How much do you trust scientists working for companies in this country to do their work with the intention of benefiting the public?”</p></li>
</ul>
<p>The answers are combined to rank each respondent’s level of trust in scientists from “High Trust” to “Low Trust”. Respondents that did not answer enough of the questions are recorded as “No Score”.</p>
<p>The survey data we have is contained in a file named <code class="docutils literal notranslate"><span class="pre">wellcome_global_monitor_2018.csv</span></code>. This file contains a subset of the attributes from the original dataset, replacing numerical codes with their textual equivalents. The column labeled <code class="docutils literal notranslate"><span class="pre">Trust_Index</span></code> (originally named “WGM_Indexr”) contains the Trust in Scientists Index.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">wgm</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;wellcome_global_monitor_2018.csv&#39;</span><span class="p">)</span>
<span class="n">wgm</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">head</span><span class="p">()</span> <span class="c1"># display 5 randomly sampled rows</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Country</th>
      <th>Q12</th>
      <th>Q13</th>
      <th>Age</th>
      <th>AgeCategories</th>
      <th>Gender</th>
      <th>Education</th>
      <th>Urban_Rural</th>
      <th>Trust_Index_Numeric</th>
      <th>Trust_Index</th>
      <th>trustsScience_Q12</th>
      <th>trustsScientists_Q13</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>144197</th>
      <td>Uruguay</td>
      <td>A lot</td>
      <td>Some</td>
      <td>71.0</td>
      <td>50+</td>
      <td>Female</td>
      <td>Tertiary</td>
      <td>Lives in city or suburb of city</td>
      <td>3.6</td>
      <td>High trust</td>
      <td>Yes</td>
      <td>Yes</td>
    </tr>
    <tr>
      <th>139725</th>
      <td>The Gambia</td>
      <td>A lot</td>
      <td>A lot</td>
      <td>85.0</td>
      <td>50+</td>
      <td>Female</td>
      <td>Primary</td>
      <td>Lives in rural area or small town</td>
      <td>3.8</td>
      <td>High trust</td>
      <td>Yes</td>
      <td>Yes</td>
    </tr>
    <tr>
      <th>145079</th>
      <td>Uzbekistan</td>
      <td>A lot</td>
      <td>A lot</td>
      <td>25.0</td>
      <td>15 to 29</td>
      <td>Female</td>
      <td>Secondary</td>
      <td>Lives in rural area or small town</td>
      <td>4.0</td>
      <td>High trust</td>
      <td>Yes</td>
      <td>Yes</td>
    </tr>
    <tr>
      <th>17699</th>
      <td>Poland</td>
      <td>A lot</td>
      <td>(Don't Know)</td>
      <td>44.0</td>
      <td>30 to 49</td>
      <td>Male</td>
      <td>Secondary</td>
      <td>Lives in rural area or small town</td>
      <td>3.0</td>
      <td>Medium trust</td>
      <td>Yes</td>
      <td>(Don't Know)</td>
    </tr>
    <tr>
      <th>6032</th>
      <td>Turkey</td>
      <td>Some</td>
      <td>Not much</td>
      <td>18.0</td>
      <td>15 to 29</td>
      <td>Female</td>
      <td>Secondary</td>
      <td>Lives in city or suburb of city</td>
      <td>1.6</td>
      <td>Low trust</td>
      <td>Yes</td>
      <td>No</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Let’s take a deeper look at the Trust in Scientists Index and see what levels of trust were recorded.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">wgm</span><span class="p">[</span><span class="s2">&quot;Trust_Index&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Medium trust    77137
Low trust       28460
High trust      26161
No score        17256
Name: Trust_Index, dtype: int64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># create dataframe from counts of &quot;Trust_Index&quot; values</span>
<span class="n">levels</span> <span class="o">=</span> <span class="n">wgm</span><span class="p">[</span><span class="s2">&quot;Trust_Index&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Count&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;index&quot;</span><span class="p">:</span> <span class="s2">&quot;Trust_Level&quot;</span><span class="p">})</span>

<span class="c1"># create bar plot</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">barplot</span><span class="p">(</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">levels</span><span class="p">,</span>
    <span class="n">x</span> <span class="o">=</span> <span class="s2">&quot;Trust_Level&quot;</span><span class="p">,</span>
    <span class="n">y</span> <span class="o">=</span> <span class="s2">&quot;Count&quot;</span><span class="p">,</span>
    <span class="n">order</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;No score&quot;</span><span class="p">,</span> <span class="s2">&quot;Low trust&quot;</span><span class="p">,</span> <span class="s2">&quot;Medium trust&quot;</span><span class="p">,</span> <span class="s2">&quot;High trust&quot;</span><span class="p">]</span>
<span class="p">)</span>

<span class="c1"># label each bar with the corresponding value</span>
<span class="k">for</span> <span class="n">container</span> <span class="ow">in</span> <span class="n">ax</span><span class="o">.</span><span class="n">containers</span><span class="p">:</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">bar_label</span><span class="p">(</span><span class="n">container</span><span class="p">)</span>

<span class="c1"># set axis labels and title</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Trust in Scientists Index, Worldwide&quot;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/272ac52b262b0f1b66dbb7c95a605cab79e0de3c851c577fba7a84ad79f29e48.png" src="../_images/272ac52b262b0f1b66dbb7c95a605cab79e0de3c851c577fba7a84ad79f29e48.png" />
</div>
</div>
<p>In what follows, we are going to narrow our analysis to focus in on one country. In this case, we will look at the United States. If you’re interested in a different country, later on you’ll get a chance to repeat this analysis for a different country in the exercises. Or, if you’re using the interactive notebook, you can change the code to use a different country!</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">wgm_usa</span> <span class="o">=</span> <span class="n">wgm</span><span class="p">[</span><span class="n">wgm</span><span class="p">[</span><span class="s1">&#39;Country&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;United States&quot;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<p>Here’s what the levels of trust for the sample from the United States look like:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">wgm_usa</span><span class="p">[</span><span class="s2">&quot;Trust_Index&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Medium trust    563
High trust      282
Low trust       116
No score         45
Name: Trust_Index, dtype: int64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># create dataframe from counts of &quot;Trust_Index&quot; values</span>
<span class="n">levels</span> <span class="o">=</span> <span class="n">wgm_usa</span><span class="p">[</span><span class="s2">&quot;Trust_Index&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Count&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;index&quot;</span><span class="p">:</span> <span class="s2">&quot;Trust_Level&quot;</span><span class="p">})</span>

<span class="c1"># create bar plot</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">barplot</span><span class="p">(</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">levels</span><span class="p">,</span>
    <span class="n">x</span> <span class="o">=</span> <span class="s2">&quot;Trust_Level&quot;</span><span class="p">,</span>
    <span class="n">y</span> <span class="o">=</span> <span class="s2">&quot;Count&quot;</span><span class="p">,</span>
    <span class="n">order</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;No score&quot;</span><span class="p">,</span> <span class="s2">&quot;Low trust&quot;</span><span class="p">,</span> <span class="s2">&quot;Medium trust&quot;</span><span class="p">,</span> <span class="s2">&quot;High trust&quot;</span><span class="p">]</span>
<span class="p">)</span>

<span class="c1"># label each bar with the corresponding value</span>
<span class="k">for</span> <span class="n">container</span> <span class="ow">in</span> <span class="n">ax</span><span class="o">.</span><span class="n">containers</span><span class="p">:</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">bar_label</span><span class="p">(</span><span class="n">container</span><span class="p">)</span>

<span class="c1"># set axis labels and title</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Trust in Scientists Index for the United States&quot;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/459703fd3c53ff669ef97e67001ab214454473fc2d58551793fd9995b655a612.png" src="../_images/459703fd3c53ff669ef97e67001ab214454473fc2d58551793fd9995b655a612.png" />
</div>
</div>
</section>
<section id="making-a-hypothesis">
<h3>Making a Hypothesis<a class="headerlink" href="#making-a-hypothesis" title="Permalink to this headline">#</a></h3>
<p>The first step in a hypothesis test is to determine the hypotheses that we are comparing. We are comparing two opposing views of the world: either it works like this, or it doesn’t. These views are best understood in terms of <em>models</em>—a framework for understanding how the world works.</p>
<p>For example, perhaps I think that the proportion of residents in the United States who have a high trust in scientists is large, say over 0.25. In this situation, the two models are statistical: we are hypothesizing about the proportion from a population. Either the proportion of people in our chosen country who have high trust in scientists is 0.25, or it’s more than that. In mathematical terms, we’ll write this as</p>
<div class="amsmath math notranslate nohighlight" id="equation-c1b2115d-0c36-4975-bff4-a596b8753794">
<span class="eqno">()<a class="headerlink" href="#equation-c1b2115d-0c36-4975-bff4-a596b8753794" title="Permalink to this equation">#</a></span>\[\begin{equation}
    H_0: p = 0.25, \\
    H_1: p &gt; 0.25.
\end{equation}\]</div>
<p>In other words, our null hypothesis, <span class="math notranslate nohighlight">\(H_0\)</span>, is that the proportion is 0.25. Our alternative hypothesis, <span class="math notranslate nohighlight">\(H_1\)</span>, is that the proportion is greater than 0.25. Remember that the null hypothesis should always be in the form “population parameter equals something”.</p>
<p>We can make hypotheses about other parameters, such as mean or standard deviation, but we’ll start here by working with proportions.</p>
<p>The statistical hypothesis test is the method for making a decision between these two models. We gather data and see how well the data fits with what we would expect based on the null hypothesis.</p>
</section>
<section id="how-much-evidence-do-we-need">
<h3>How Much Evidence Do We Need?<a class="headerlink" href="#how-much-evidence-do-we-need" title="Permalink to this headline">#</a></h3>
<p>After we have determined the hypotheses, the next step is to determine our threshold for making a decision. How much evidence do we need to reject our null hypothesis in favor of the alternative hypothesis? Another way to think about this is, how much risk are we willing to take to be wrong?</p>
<p>In this case, there are actaully <em>two</em> ways to make the wrong conclusion: we could reject our null hypothesis when it is actually true (called a <strong>Type I error</strong>), or we could fail to reject the null hypothesis when it is actually false (a <strong>Type II error</strong>). We won’t go any deeper into Type II error at the moment, but it is just as important to consider!</p>
<p>The “risk level” or “evidence threshold” associated with the first type of wrong conclusion is denoted by the Greek letter <span class="math notranslate nohighlight">\(\alpha\)</span> (alpha). For any given example, the value should be chosen based on both the context of the problem and the risk of making a Type I error that you are willing to take. Typical values for <span class="math notranslate nohighlight">\(\alpha\)</span> in scientific literature are 0.1, 0.05, and 0.01, but these values are somewhat arbitrary.</p>
<p>For instance, imagine you are trying to determine if a new medical treatment is more effective than a previous treatment. Suppose the new treatment has more potential for harmful side-effects than the previous treatment. In this case, you would want to be very sure the new treatment is better before you start using it widely, so you would want to set your <span class="math notranslate nohighlight">\(\alpha\)</span>-value to something smaller to make sure that the risk of making a Type I error is not too large.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.05</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="the-test-statistic-using-data-to-decide">
<h3>The Test Statistic: Using Data to Decide<a class="headerlink" href="#the-test-statistic-using-data-to-decide" title="Permalink to this headline">#</a></h3>
<p>After determining the value of <span class="math notranslate nohighlight">\(\alpha\)</span>, the next step of a real-world study would be to gather the data we need and make a decision. In the statistics classroom, you typically have the data or summary statistics already available to you, as we do in this case.</p>
<p>We are asking questions about the proportion of people in the United States who have high trust in scientists. It would be impossible to get an answer from every single person in the entire country! However, the Wellcome Global Monitor data gives us answers from a large representative sample of people in the USA. So we can use this data to get a statistically sound idea of what the true proportion in the entire population is.</p>
<p>Let’s compare the proportion from the sample to what the null hypothesis says it should be. If the sample proportion is close to what the null hypothesis says it should be, that would mean that the null hypothesis is probably right. On the other hand, if it is different, perhaps the null hypothesis is wrong!</p>
<p>We can compute the sample proportion of people with high trust in scientists by taking the total number of people in the sample with a high trust score and dividing it by the total sample size:</p>
<div class="amsmath math notranslate nohighlight" id="equation-31da6b54-8b72-48c2-87e3-1354be53206d">
<span class="eqno">()<a class="headerlink" href="#equation-31da6b54-8b72-48c2-87e3-1354be53206d" title="Permalink to this equation">#</a></span>\[\begin{equation}
\hat p = \frac{\mbox{num. of respondents with high trust in scientists}}{\mbox{num. of respondents}}.
\end{equation}\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># number of successes (i.e., people with high trust in scientists)</span>
<span class="n">count</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">wgm_usa</span><span class="p">[</span><span class="n">wgm_usa</span><span class="p">[</span><span class="s2">&quot;Trust_Index&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;High trust&quot;</span><span class="p">])</span>

<span class="c1"># sample size (i.e., the total number of observations)</span>
<span class="n">nobs</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">wgm_usa</span><span class="p">[</span><span class="s2">&quot;Trust_Index&quot;</span><span class="p">])</span>

<span class="c1"># compute sample proportion</span>
<span class="n">p_hat</span> <span class="o">=</span>  <span class="n">count</span> <span class="o">/</span> <span class="n">nobs</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;The sample proportion is </span><span class="si">{</span><span class="n">p_hat</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">. There are </span><span class="si">{</span><span class="n">nobs</span><span class="si">}</span><span class="s2"> total observations.&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>The sample proportion is 0.280. There are 1006 total observations.
</pre></div>
</div>
</div>
</div>
<p>This is clearly more than <span class="math notranslate nohighlight">\(0.25\)</span>, the value in our null hypothesis! But remember that the sample proportion is variable, so it won’t be <em>exactly</em> the same as the population proportion. So is this evidence for the alternative hypothesis?</p>
<p>We could ask a better question: is the sample proportion of 0.28 a lot different from our null hypothesis or just a little bit different? We can answer this using probability theory. Just like in the last section, the theoretical foundation for the hypothesis test is the Central Limit Theorem. Remember that if the sample size <span class="math notranslate nohighlight">\(n\)</span> is large enough, sample proportions have a normal distribution, where the mean is the population proportion <span class="math notranslate nohighlight">\(p\)</span>, and the standard deviation is the population standard deviation <span class="math notranslate nohighlight">\(\sqrt{p(1-p)}\)</span> divided by <span class="math notranslate nohighlight">\(\sqrt{n}\)</span>:</p>
<div class="math notranslate nohighlight">
\[ \hat{p} \sim N\left(p, \sqrt{\frac{p(1-p)}{n}} \right). \]</div>
<p>Above we can see that <span class="math notranslate nohighlight">\(n = 1006\)</span>. If we assume the null hypothesis is true, then we also know what to fill in for <span class="math notranslate nohighlight">\(p\)</span>:</p>
<div class="math notranslate nohighlight">
\[ \hat{p} \sim N\left(.25, \sqrt{\frac{.25(1-.25)}{1006}} \right). \]</div>
<p>We call this the <strong>null distribution</strong>, since it is the distribution of the sample statistic under the assumption that the null hypothesis is true.</p>
<p>Back to the question: is the difference between the observed value of <span class="math notranslate nohighlight">\(\hat p\)</span> and the value that the null hypothesis says it should be a big difference or small difference? One way to answer that question would be to <strong>standardize</strong> by taking the difference between the sample mean and the (hypothesized) population mean and dividing by the standard deviation:</p>
<div class="amsmath math notranslate nohighlight" id="equation-f084f4e1-7365-470d-afa6-047cd4d2b18f">
<span class="eqno">()<a class="headerlink" href="#equation-f084f4e1-7365-470d-afa6-047cd4d2b18f" title="Permalink to this equation">#</a></span>\[\begin{equation}
Z = \frac{\hat p - .25}{\sqrt{\frac{.25(1-.25)}{1006} }} \sim N(0,1)
\end{equation}\]</div>
<p>This gives us the standardized test statistic Z, which has a standard normal distribution (<span class="math notranslate nohighlight">\(\mu = 0, \sigma = 1\)</span>)—again assuming that the null hypothesis is true.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># standardize it</span>
<span class="n">z_obs</span> <span class="o">=</span> <span class="p">(</span> <span class="n">p_hat</span> <span class="o">-</span> <span class="mf">0.25</span> <span class="p">)</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span> <span class="mf">0.25</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="mf">0.25</span><span class="p">)</span> <span class="o">/</span> <span class="n">nobs</span> <span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;The observed value of the test statistic Z is </span><span class="si">{</span><span class="n">z_obs</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>The observed value of the test statistic Z is 2.221.
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># dictionary with properties of each distribution</span>
<span class="n">distributions</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">{</span>
        <span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;Null Distribution of $\hat</span><span class="si">{p}</span><span class="s1">$&#39;</span><span class="p">,</span>
        <span class="s1">&#39;mean&#39;</span><span class="p">:</span> <span class="mf">0.25</span><span class="p">,</span> <span class="s1">&#39;sd&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mf">0.25</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="mf">0.25</span><span class="p">)</span><span class="o">/</span><span class="n">nobs</span><span class="p">),</span>
        <span class="s1">&#39;stat&#39;</span><span class="p">:</span> <span class="n">p_hat</span><span class="p">,</span> <span class="s1">&#39;stat_label&#39;</span><span class="p">:</span> <span class="s1">&#39;$\hat</span><span class="si">{p}</span><span class="s1">_</span><span class="si">{obs}</span><span class="s1">$&#39;</span>
    <span class="p">},</span>
    <span class="p">{</span>
        <span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;Null distribution of $Z$&#39;</span><span class="p">,</span>
        <span class="s1">&#39;mean&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;sd&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
        <span class="s1">&#39;stat&#39;</span><span class="p">:</span> <span class="n">z_obs</span><span class="p">,</span> <span class="s1">&#39;stat_label&#39;</span><span class="p">:</span> <span class="s1">&#39;$Z_</span><span class="si">{obs}</span><span class="s1">$&#39;</span>
    <span class="p">}</span>
<span class="p">]</span>

<span class="c1"># create plot</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">distributions</span><span class="p">),</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>

<span class="c1"># use default seaborn palette</span>
<span class="n">palette</span> <span class="o">=</span> <span class="nb">iter</span><span class="p">(</span><span class="n">sns</span><span class="o">.</span><span class="n">color_palette</span><span class="p">())</span>
<span class="n">pdfcolor</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="n">palette</span><span class="p">)</span>
<span class="n">statcolor</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="n">palette</span><span class="p">)</span>

<span class="c1"># for each distribution, plot the pdf, mean, and relevant statistic</span>
<span class="k">for</span> <span class="n">ax</span><span class="p">,</span> <span class="n">distr</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">axes</span><span class="p">,</span> <span class="n">distributions</span><span class="p">):</span>
    <span class="c1"># plot pdf</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">distr</span><span class="p">[</span><span class="s1">&#39;mean&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="mf">3.5</span><span class="o">*</span><span class="n">distr</span><span class="p">[</span><span class="s1">&#39;sd&#39;</span><span class="p">],</span> <span class="n">distr</span><span class="p">[</span><span class="s1">&#39;mean&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="mf">3.5</span><span class="o">*</span><span class="n">distr</span><span class="p">[</span><span class="s1">&#39;sd&#39;</span><span class="p">],</span> <span class="mi">100</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">scipy</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">norm</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">distr</span><span class="p">[</span><span class="s1">&#39;mean&#39;</span><span class="p">],</span> <span class="n">distr</span><span class="p">[</span><span class="s1">&#39;sd&#39;</span><span class="p">]),</span> <span class="n">color</span><span class="o">=</span><span class="n">pdfcolor</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;pdf&#39;</span><span class="p">)</span>
    <span class="c1"># plot mean</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">vlines</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">distr</span><span class="p">[</span><span class="s1">&#39;mean&#39;</span><span class="p">],</span> <span class="n">ymin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">ymax</span><span class="o">=</span><span class="n">scipy</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">norm</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">distr</span><span class="p">[</span><span class="s1">&#39;mean&#39;</span><span class="p">],</span> <span class="n">distr</span><span class="p">[</span><span class="s1">&#39;mean&#39;</span><span class="p">],</span> <span class="n">distr</span><span class="p">[</span><span class="s1">&#39;sd&#39;</span><span class="p">]),</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;dashed&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;grey&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;$\mu$&#39;</span><span class="p">)</span>
    <span class="c1"># plot statistic</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">distr</span><span class="p">[</span><span class="s1">&#39;stat&#39;</span><span class="p">],</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;dashed&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">statcolor</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">distr</span><span class="p">[</span><span class="s1">&#39;stat_label&#39;</span><span class="p">])</span>
    <span class="c1"># set y-axis limits to start at 0</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_ylim</span><span class="p">()[</span><span class="mi">1</span><span class="p">])</span>
    <span class="c1"># set title</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">distr</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">])</span>
    <span class="c1"># display legend</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper left&#39;</span><span class="p">)</span>
    
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Density&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/8a53520576d6a4084ac92233a7c11035f1bc4c0029a7c78fa22b69c9ddc4ed08.png" src="../_images/8a53520576d6a4084ac92233a7c11035f1bc4c0029a7c78fa22b69c9ddc4ed08.png" />
</div>
</div>
<p>This changes our difference to units of standard deviations. In other words, the sample proportion is 2.221 standard deviations above the mean value of 0.</p>
<p>Think about it another way: if the null hypothesis is true, then most of the time <span class="math notranslate nohighlight">\(\hat p\)</span> will be close to <span class="math notranslate nohighlight">\(p=0.25\)</span>, and hence <span class="math notranslate nohighlight">\(Z\)</span> will be close to 0. But <span class="math notranslate nohighlight">\(\hat p\)</span> varies, and hence <span class="math notranslate nohighlight">\(Z\)</span> is variable. So how likely is it that <span class="math notranslate nohighlight">\(Z\)</span> would be 2.221 standard deviations from what the null hypothesis says it should be most of the time? And how far away does it need to be before we would start to doubt the null hypothesis?</p>
</section>
<section id="making-a-decision">
<h3>Making a Decision<a class="headerlink" href="#making-a-decision" title="Permalink to this headline">#</a></h3>
<p>Now that we have a hypothesis and have calculated a test statistic to try to evaluate the hypothesis, we are ready to make a conclusion. Under the null hypothesis, we know the distribution of the sample statistic <span class="math notranslate nohighlight">\(\hat p\)</span>. However, we have just one observation of the sample proportion.</p>
<p>So we ask, if the null hypothesis is true and the population proportion really is 0.25, how likely is it that we would observe the value of 0.28 or something even further away from 0.25? Or translated to <span class="math notranslate nohighlight">\(Z\)</span>-space, how likely is it to get a test statistic that is 2.221 or larger?</p>
<p>We can use <code class="docutils literal notranslate"><span class="pre">scipy.stats</span></code> to compute directly compute this probability from a <span class="math notranslate nohighlight">\(N(0,1)\)</span> distribution using the CDF function. We subtract the probability from 1 since the CDF always gives the probability to the <em>left</em> of a number, and we want the probability that <span class="math notranslate nohighlight">\(Z\)</span> is <em>larger</em> or to the right of 2.221.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="mi">1</span> <span class="o">-</span> <span class="n">scipy</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">cdf</span><span class="p">(</span><span class="n">z_obs</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.013183855477092332
</pre></div>
</div>
</div>
</div>
<p>This value is called the <span class="math notranslate nohighlight">\(P\)</span>-value, and it measures the probability of observing a value at least as much greater than 0.25 as the value we actually observed is (assuming the null hypothesis is true). As the figure below shows, the <span class="math notranslate nohighlight">\(P\)</span>-value is the area under the probability density function of Z that is to the right of <span class="math notranslate nohighlight">\(Z_{obs}\)</span>. The smaller this area is, the less likely it is that, if the null hypothesis is indeed true and we took additional samples from our population, we would observe values of Z that are greater than or equal to <span class="math notranslate nohighlight">\(Z_{obs}\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># graph illustrating the P-value</span>

<span class="c1"># create plot</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mf">8.5</span><span class="p">,</span><span class="mf">4.5</span><span class="p">))</span>

<span class="c1"># use default seaborn palette</span>
<span class="n">palette</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">color_palette</span><span class="p">()</span>
<span class="n">normcolor</span> <span class="o">=</span> <span class="n">palette</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">zcolor</span> <span class="o">=</span> <span class="n">palette</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="n">arrowcolor</span> <span class="o">=</span> <span class="n">palette</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span>

<span class="c1"># plot standard normal pdf (pdf of Z)</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">150</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">norm</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">normcolor</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">2.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;pdf of Z&#39;</span><span class="p">)</span>

<span class="c1"># set lower y-axis limit to 0</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_ylim</span><span class="p">()[</span><span class="mi">1</span><span class="p">])</span>
<span class="n">half_ylim</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">ax</span><span class="o">.</span><span class="n">get_ylim</span><span class="p">())</span><span class="o">/</span><span class="mi">2</span> <span class="c1"># coordinate at middle of y-axis</span>

<span class="c1"># plot and annotate Z_obs</span>
<span class="n">ax</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">z_obs</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;dashed&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">zcolor</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;$x = Z_</span><span class="si">{obs}</span><span class="s1">$&#39;</span><span class="p">)</span>

<span class="c1"># fill area under pdf represented by p-value</span>
<span class="n">ax</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">where</span> <span class="o">=</span> <span class="p">(</span><span class="n">x</span> <span class="o">&gt;=</span> <span class="n">z_obs</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="n">normcolor</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;area measured</span><span class="se">\n</span><span class="s1">by $P$-value&#39;</span><span class="p">)</span>

<span class="c1"># annotate directions of increasing and decreasing likelihood</span>
<span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span>
    <span class="n">s</span> <span class="o">=</span> <span class="s1">&#39;less likely&#39;</span><span class="p">,</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">z_obs</span> <span class="o">+</span> <span class="mf">0.4</span><span class="p">,</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">half_ylim</span><span class="p">,</span>
    <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">,</span>
    <span class="n">va</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span>
    <span class="n">size</span> <span class="o">=</span> <span class="mi">12</span><span class="p">,</span>
    <span class="n">bbox</span> <span class="o">=</span> <span class="p">{</span> <span class="s1">&#39;boxstyle&#39;</span><span class="p">:</span> <span class="s1">&#39;rarrow&#39;</span><span class="p">,</span> <span class="s1">&#39;facecolor&#39;</span><span class="p">:</span> <span class="s1">&#39;thistle&#39;</span><span class="p">,</span> <span class="s1">&#39;edgecolor&#39;</span><span class="p">:</span> <span class="n">arrowcolor</span><span class="p">,</span> <span class="s1">&#39;linewidth&#39;</span><span class="p">:</span> <span class="mi">2</span> <span class="p">}</span>
<span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span>
    <span class="n">s</span> <span class="o">=</span> <span class="s1">&#39;more likely&#39;</span><span class="p">,</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">z_obs</span> <span class="o">-</span> <span class="mf">0.4</span><span class="p">,</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">half_ylim</span><span class="p">,</span>
    <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;right&#39;</span><span class="p">,</span>
    <span class="n">va</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span>
    <span class="n">size</span> <span class="o">=</span> <span class="mi">12</span><span class="p">,</span>
    <span class="n">bbox</span> <span class="o">=</span> <span class="p">{</span> <span class="s1">&#39;boxstyle&#39;</span><span class="p">:</span> <span class="s1">&#39;larrow&#39;</span><span class="p">,</span> <span class="s1">&#39;facecolor&#39;</span><span class="p">:</span> <span class="s1">&#39;thistle&#39;</span><span class="p">,</span> <span class="s1">&#39;edgecolor&#39;</span><span class="p">:</span> <span class="n">arrowcolor</span><span class="p">,</span> <span class="s1">&#39;linewidth&#39;</span><span class="p">:</span> <span class="mi">2</span> <span class="p">}</span>
<span class="p">)</span>

<span class="c1"># set up legend, y-axis label, and title</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper left&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Density&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Likelihood of Observing $Z_</span><span class="si">{obs}</span><span class="s1">$ (Or a More Extreme Value) Under $H_</span><span class="si">{0}</span><span class="s1">$&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/b942a3904b8db88786bc6249540d6bd225fb86164dc34b8af33390c7541ef506.png" src="../_images/b942a3904b8db88786bc6249540d6bd225fb86164dc34b8af33390c7541ef506.png" />
</div>
</div>
<p>In some sense, the <span class="math notranslate nohighlight">\(P\)</span>-value quantifies the evidence you have <em>against</em> the null hypothesis. If the <span class="math notranslate nohighlight">\(P\)</span>-value is small, then that means that if the null hypothesis is really true, then it is unlikely that you would get the value of <span class="math notranslate nohighlight">\(\hat p\)</span> that you did. In other words, a small <span class="math notranslate nohighlight">\(P\)</span>-value indicates that the data is in disagreement with the statistical model given by the null hypothesis.</p>
<p>Based on the <span class="math notranslate nohighlight">\(P\)</span>-value, we can make our decision. A <span class="math notranslate nohighlight">\(P\)</span>-value is small enough if it is below the threshold of <span class="math notranslate nohighlight">\(\alpha\)</span> that we set previously. If the <span class="math notranslate nohighlight">\(P\)</span>-value is less than <span class="math notranslate nohighlight">\(\alpha\)</span>, then our test statistic is incompatible with the null hypothesis, and we will <strong>reject the null hypothesis</strong>. But if the <span class="math notranslate nohighlight">\(P\)</span>-value is greater than or equal to <span class="math notranslate nohighlight">\(\alpha\)</span>, then our data is compatible with the null hypothesis, and we will <strong>fail to reject the null hypothesis</strong>.</p>
<p>In this case, we have chosen <span class="math notranslate nohighlight">\(\alpha = 0.05\)</span>, and our <span class="math notranslate nohighlight">\(P\)</span>-value is 0.013. Since <span class="math notranslate nohighlight">\(0.013 &lt; 0.05\)</span>, we will reject the null hypothesis.</p>
<p><strong>Note:</strong> Make sure you understand the difference between the population proportion <span class="math notranslate nohighlight">\(p\)</span> and the <span class="math notranslate nohighlight">\(P\)</span>-value—they are very different! We chose to capitalize the <span class="math notranslate nohighlight">\(P\)</span> in <span class="math notranslate nohighlight">\(P\)</span>-value to make this distinction more clear, but this is not the way you will find it in every book.</p>
<p>In Python, we can put this all together using the <code class="docutils literal notranslate"><span class="pre">statsmodels</span></code> library, which we imported at the top of the notebook and gave the alias <code class="docutils literal notranslate"><span class="pre">sm</span></code>.</p>
<p>A test for proportions using <code class="docutils literal notranslate"><span class="pre">statsmodels</span></code> is performed below by calling <code class="docutils literal notranslate"><span class="pre">sm.stats.proportion.proportions_ztest(...)</span></code>. The name <code class="docutils literal notranslate"><span class="pre">proportions_ztest</span></code> indicates that we will be using the standard normal distribution to model the test statistic.</p>
<p>The arguments required by the test are all of the things we calculated above: the number of people with high trust in scientists (<code class="docutils literal notranslate"><span class="pre">count</span></code>), the sample size (<code class="docutils literal notranslate"><span class="pre">nobs</span></code>), and the hypothesized value of the proportion (<code class="docutils literal notranslate"><span class="pre">p0</span></code>). Because the alternative hypothesis is that <span class="math notranslate nohighlight">\(p &gt; 0.25\)</span>, we add <code class="docutils literal notranslate"><span class="pre">alternative</span> <span class="pre">=</span> <span class="pre">&quot;larger&quot;</span></code>. Other possibilities for the alternative hypothesis are <code class="docutils literal notranslate"><span class="pre">&quot;smaller&quot;</span></code> or <code class="docutils literal notranslate"><span class="pre">&quot;two-sided&quot;</span></code>. The code returns the test statistic and the <span class="math notranslate nohighlight">\(P\)</span>-value associated with the hypothesis test.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">p0</span> <span class="o">=</span> <span class="mf">0.25</span> <span class="c1"># proportion under null hypothesis</span>
<span class="p">(</span><span class="n">stat</span><span class="p">,</span> <span class="n">pval</span><span class="p">)</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">proportion</span><span class="o">.</span><span class="n">proportions_ztest</span><span class="p">(</span>
    <span class="n">count</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">wgm_usa</span><span class="p">[</span><span class="n">wgm_usa</span><span class="p">[</span><span class="s2">&quot;Trust_Index&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;High trust&quot;</span><span class="p">]),</span> <span class="c1"># number of successes</span>
    <span class="n">nobs</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">wgm_usa</span><span class="p">[</span><span class="s2">&quot;Trust_Index&quot;</span><span class="p">]),</span> <span class="c1"># number of observations</span>
    <span class="n">value</span> <span class="o">=</span> <span class="n">p0</span><span class="p">,</span>
    <span class="n">alternative</span> <span class="o">=</span> <span class="s2">&quot;larger&quot;</span><span class="p">,</span>
    <span class="n">prop_var</span> <span class="o">=</span> <span class="n">p0</span><span class="p">,</span> <span class="c1"># use proportion under null hypothesis to calculate variance for test statistic</span>
<span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Z-test for proportion: test statistic is </span><span class="si">{</span><span class="n">stat</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">, P-value is </span><span class="si">{</span><span class="n">pval</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Z-test for proportion: test statistic is 2.221, P-value is 0.013.
</pre></div>
</div>
</div>
</div>
<p>As you can see, <code class="docutils literal notranslate"><span class="pre">statsmodels</span></code> gives us the same test statistic and <span class="math notranslate nohighlight">\(P\)</span>-value that we found earlier. As before, since <span class="math notranslate nohighlight">\(0.013 &lt; 0.05\)</span>, we reject the null hypothesis. Note that the output of the code doesn’t tell you what conclusion to make. Remember again that <span class="math notranslate nohighlight">\(\alpha\)</span>, the threshold for making your conclusion, is context-dependent, and the <span class="math notranslate nohighlight">\(P\)</span>-value is just one part of making a decision.</p>
</section>
</section>
<section id="difference-of-two-proportions">
<h2>Difference of Two Proportions<a class="headerlink" href="#difference-of-two-proportions" title="Permalink to this headline">#</a></h2>
<p>We can also use hypothesis testing to compare two proportions. This test is most common when you want to see if a population proportion is the same in two independent populations. For example, maybe we want to see if the proportion of men in the United States who have high trust in scientists (<span class="math notranslate nohighlight">\(p_1\)</span>) is different than the proportion of women in the United States who have high trust in scientists (<span class="math notranslate nohighlight">\(p_2\)</span>). Our two hypotheses are</p>
<div class="amsmath math notranslate nohighlight" id="equation-73233057-43d7-4007-9100-2f89a366abb7">
<span class="eqno">()<a class="headerlink" href="#equation-73233057-43d7-4007-9100-2f89a366abb7" title="Permalink to this equation">#</a></span>\[\begin{equation}
    H_0: p_1 - p_2 = 0, \\
    H_1: p_1 - p_2 \neq 0.
\end{equation}\]</div>
<p>The main difference between this set of hypotheses and the previous set of hypotheses is that we aren’t making a claim about whether the difference is bigger or smaller than a given value, just that it is different from that value. This will come into play later on when we quantify our evidence using the <span class="math notranslate nohighlight">\(P\)</span>-value.</p>
<p>Just as before, we will use the sample proportions of men and women from our survey to make a determination between the two hypotheses. Let’s take a look at these:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># divide into two data sets</span>
<span class="n">wgm_m</span> <span class="o">=</span> <span class="n">wgm_usa</span><span class="p">[</span><span class="n">wgm_usa</span><span class="p">[</span><span class="s1">&#39;Gender&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;Male&quot;</span><span class="p">]</span>
<span class="n">wgm_f</span> <span class="o">=</span> <span class="n">wgm_usa</span><span class="p">[</span><span class="n">wgm_usa</span><span class="p">[</span><span class="s1">&#39;Gender&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;Female&quot;</span><span class="p">]</span>

<span class="c1"># number of successes (i.e., people with high trust in scientists)</span>
<span class="n">count_m</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">wgm_m</span><span class="p">[</span><span class="n">wgm_m</span><span class="p">[</span><span class="s2">&quot;Trust_Index&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;High trust&quot;</span><span class="p">])</span>
<span class="n">count_f</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">wgm_f</span><span class="p">[</span><span class="n">wgm_f</span><span class="p">[</span><span class="s2">&quot;Trust_Index&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;High trust&quot;</span><span class="p">])</span>

<span class="c1"># sample size (i.e., the total number of observations)</span>
<span class="n">nobs_m</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">wgm_m</span><span class="p">[</span><span class="s2">&quot;Trust_Index&quot;</span><span class="p">])</span>
<span class="n">nobs_f</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">wgm_f</span><span class="p">[</span><span class="s2">&quot;Trust_Index&quot;</span><span class="p">])</span>

<span class="c1"># compute sample proportion</span>
<span class="n">p_hat_m</span> <span class="o">=</span>  <span class="n">count_m</span> <span class="o">/</span> <span class="n">nobs_m</span>
<span class="n">p_hat_f</span> <span class="o">=</span> <span class="n">count_f</span> <span class="o">/</span> <span class="n">nobs_f</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;The sample proportion for men is </span><span class="si">{</span><span class="n">p_hat_m</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">. There are </span><span class="si">{</span><span class="n">nobs_m</span><span class="si">}</span><span class="s2"> total observations for men.&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;The sample proportion for women is </span><span class="si">{</span><span class="n">p_hat_f</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">. There are </span><span class="si">{</span><span class="n">nobs_f</span><span class="si">}</span><span class="s2"> total observations for women.&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>The sample proportion for men is 0.262. There are 542 total observations for men.
The sample proportion for women is 0.302. There are 464 total observations for women.
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># get dataframe</span>
<span class="n">levels</span> <span class="o">=</span> <span class="n">wgm_usa</span><span class="p">[[</span><span class="s2">&quot;Gender&quot;</span><span class="p">,</span> <span class="s2">&quot;Trust_Index&quot;</span><span class="p">]]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Count&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;Trust_Index&quot;</span><span class="p">:</span> <span class="s2">&quot;Trust_Level&quot;</span><span class="p">})</span>

<span class="c1"># create bar plot</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">barplot</span><span class="p">(</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">levels</span><span class="p">,</span>
    <span class="n">x</span> <span class="o">=</span> <span class="s2">&quot;Trust_Level&quot;</span><span class="p">,</span>
    <span class="n">y</span> <span class="o">=</span> <span class="s2">&quot;Count&quot;</span><span class="p">,</span>
    <span class="n">hue</span> <span class="o">=</span> <span class="s2">&quot;Gender&quot;</span><span class="p">,</span>
    <span class="n">order</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;No score&quot;</span><span class="p">,</span> <span class="s2">&quot;Low trust&quot;</span><span class="p">,</span> <span class="s2">&quot;Medium trust&quot;</span><span class="p">,</span> <span class="s2">&quot;High trust&quot;</span><span class="p">]</span>
<span class="p">)</span>
<span class="k">for</span> <span class="n">container</span> <span class="ow">in</span> <span class="n">ax</span><span class="o">.</span><span class="n">containers</span><span class="p">:</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">bar_label</span><span class="p">(</span><span class="n">container</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Trust in Scientists Index&quot;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/9a4ab7b2e00cd77f94795878c67c20fff2424627eeff768f32bf2f480f771cd6.png" src="../_images/9a4ab7b2e00cd77f94795878c67c20fff2424627eeff768f32bf2f480f771cd6.png" />
</div>
</div>
<p>Overall, in our sample we see a difference of about 0.04 between the proportions of men and women who have high trust in scientists. Again we ask, is that a large difference?</p>
<p>Recall that if our sample sizes <span class="math notranslate nohighlight">\(n_1\)</span> and <span class="math notranslate nohighlight">\(n_2\)</span> are large enough,</p>
<div class="amsmath math notranslate nohighlight" id="equation-c72118dc-8c70-4d7e-92f5-a0f73f3d1779">
<span class="eqno">()<a class="headerlink" href="#equation-c72118dc-8c70-4d7e-92f5-a0f73f3d1779" title="Permalink to this equation">#</a></span>\[\begin{equation}
    \hat p_1 - \hat p_2 \sim N\left(p_1 - p_2, \sqrt{ \frac{p_1(1-p_1)}{n_1} + \frac{p_2(1-p_2)}{n_2}  } \right).
\end{equation}\]</div>
<p>and hence</p>
<div class="amsmath math notranslate nohighlight" id="equation-a4a1d847-1f04-47cb-8188-9c17f7ae73a4">
<span class="eqno">()<a class="headerlink" href="#equation-a4a1d847-1f04-47cb-8188-9c17f7ae73a4" title="Permalink to this equation">#</a></span>\[\begin{equation}
    Z = \frac{\hat p_1 - \hat p_2 - (p_1 - p_2)}{ \sqrt{ \frac{p_1(1-p_1)}{n_1} + \frac{p_2(1-p_2)}{n_2}  } } \sim N(0,1).
\end{equation}\]</div>
<p>The null hypothesis tells us what to fill in for <span class="math notranslate nohighlight">\(p_1-p_2\)</span>, but it doesn’t hypothesize directly about the values of <span class="math notranslate nohighlight">\(p_1\)</span> or <span class="math notranslate nohighlight">\(p_2\)</span>. However, it does hypothesize that <span class="math notranslate nohighlight">\(p_1 = p_2\)</span>, and it that is true, then our estimates <span class="math notranslate nohighlight">\(\hat p_1\)</span> and <span class="math notranslate nohighlight">\(\hat p_2\)</span> are estimating the same thing. In that case, we can combine them to estimate the variance. Define <span class="math notranslate nohighlight">\(p\)</span> to be the common value of <span class="math notranslate nohighlight">\(p_1 = p_2 = p\)</span>. Then the variance of our test statistic is</p>
<div class="amsmath math notranslate nohighlight" id="equation-fb144bb5-1cc5-4c62-81d3-93381aa00b92">
<span class="eqno">()<a class="headerlink" href="#equation-fb144bb5-1cc5-4c62-81d3-93381aa00b92" title="Permalink to this equation">#</a></span>\[\begin{equation}
\sqrt{ \frac{p_1(1-p_1)}{n_1} + \frac{p_2(1-p_2)}{n_2}  }  = \sqrt{ \frac{p(1-p)}{n_1} + \frac{p(1-p)}{n_2}  } = \sqrt{ p(1-p)\left( \frac{1}{n_1} + \frac{1}{n_2}\right)  },
\end{equation}\]</div>
<p>and we can estimate <span class="math notranslate nohighlight">\(p\)</span> using</p>
<div class="amsmath math notranslate nohighlight" id="equation-f19b1784-29f3-4434-9c6b-85ac4f840690">
<span class="eqno">()<a class="headerlink" href="#equation-f19b1784-29f3-4434-9c6b-85ac4f840690" title="Permalink to this equation">#</a></span>\[\begin{equation}
    p \approx \hat p = \frac{\mbox{num. of male respondents with high trust in scientists} + \mbox{num. of female respondents with high trust in scientists}}{\mbox{num. of male respondents} + \mbox{num. of female respondents}}.
\end{equation}\]</div>
<p>We call <span class="math notranslate nohighlight">\(\hat p\)</span> the <strong>pooled sample proportion</strong>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">p_hat</span> <span class="o">=</span> <span class="p">(</span><span class="n">count_m</span> <span class="o">+</span> <span class="n">count_f</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">nobs_m</span> <span class="o">+</span> <span class="n">nobs_f</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;The pooled sample proportion is </span><span class="si">{</span><span class="n">p_hat</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>The pooled sample proportion is 0.280.
</pre></div>
</div>
</div>
</div>
<p>Now, using the formula for <span class="math notranslate nohighlight">\(Z\)</span> above, we can calculate the test statistic.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">z_obs</span> <span class="o">=</span> <span class="p">(</span><span class="n">p_hat_m</span> <span class="o">-</span> <span class="n">p_hat_f</span><span class="p">)</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span> <span class="n">p_hat</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">p_hat</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">nobs_m</span> <span class="o">+</span> <span class="mi">1</span><span class="o">/</span><span class="n">nobs_f</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;The observed value of the test statistic Z is </span><span class="si">{</span><span class="n">z_obs</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>The observed value of the test statistic Z is -1.399.
</pre></div>
</div>
</div>
</div>
<p>Now that we have the test statistic, we can quantify the evidence that we have in relation to our two hypotheses. Since the alternative hypothesis is just interested in finding differences from 0, then values of <span class="math notranslate nohighlight">\(Z\)</span> that are a lot above 0 <em>or</em> a lot below 0 would be evidence against the null hypothesis.</p>
<p>In other words, if <span class="math notranslate nohighlight">\(p_1 - p_2\)</span> really is 0, then <span class="math notranslate nohighlight">\(Z\)</span> will be close to 0 most of the time. If it’s not, then it is more likely that <span class="math notranslate nohighlight">\(Z\)</span> is far from 0. We can quantify this through the <span class="math notranslate nohighlight">\(P\)</span>-value, which again is calculating the probability that we would observe a value a least as far from 0 as the one that we did. We double the value from the CDF here to get the <span class="math notranslate nohighlight">\(P\)</span>-value since “far away” includes both the positive and negative directions.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">abs_z_obs</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">z_obs</span><span class="p">)</span>

<span class="c1"># create plot</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mf">8.5</span><span class="p">,</span><span class="mf">4.5</span><span class="p">))</span>

<span class="c1"># use default seaborn palette</span>
<span class="n">palette</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">color_palette</span><span class="p">()</span>
<span class="n">normcolor</span> <span class="o">=</span> <span class="n">palette</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">zcolor</span> <span class="o">=</span> <span class="n">palette</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="n">arrowcolor</span> <span class="o">=</span> <span class="n">palette</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span>

<span class="c1"># plot standard normal pdf (pdf of Z)</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">150</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">norm</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">normcolor</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">2.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;pdf of Z&#39;</span><span class="p">)</span>

<span class="c1"># set lower y-axis limit to 0</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_ylim</span><span class="p">()[</span><span class="mi">1</span><span class="p">])</span>
<span class="n">half_ylim</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">ax</span><span class="o">.</span><span class="n">get_ylim</span><span class="p">())</span><span class="o">/</span><span class="mi">2</span> <span class="c1"># coordinate at middle of y-axis</span>

<span class="c1"># plot and annotate Z_obs and -Z_obs</span>
<span class="n">ax</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">z_obs</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;dashed&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">zcolor</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;$x = \pm$ $Z_</span><span class="si">{obs}</span><span class="s1">$&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="o">-</span><span class="n">z_obs</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;dashed&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">zcolor</span><span class="p">)</span>

<span class="c1"># fill area under pdf represented by p-value</span>
<span class="n">ax</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">where</span> <span class="o">=</span> <span class="p">(</span><span class="n">x</span> <span class="o">&lt;</span> <span class="o">-</span><span class="n">abs_z_obs</span><span class="p">)</span> <span class="o">|</span> <span class="p">(</span><span class="n">x</span> <span class="o">&gt;</span> <span class="n">abs_z_obs</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="n">normcolor</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;area measured</span><span class="se">\n</span><span class="s1">by $P$-value&#39;</span><span class="p">)</span>

<span class="c1"># annotate directions of increasing and decreasing likelihood</span>
<span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span>
    <span class="n">s</span> <span class="o">=</span> <span class="s1">&#39;less likely&#39;</span><span class="p">,</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">abs_z_obs</span> <span class="o">+</span> <span class="mf">0.4</span><span class="p">,</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">half_ylim</span><span class="p">,</span>
    <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">,</span>
    <span class="n">va</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span>
    <span class="n">size</span> <span class="o">=</span> <span class="mi">12</span><span class="p">,</span>
    <span class="n">bbox</span> <span class="o">=</span> <span class="p">{</span> <span class="s1">&#39;boxstyle&#39;</span><span class="p">:</span> <span class="s1">&#39;rarrow&#39;</span><span class="p">,</span> <span class="s1">&#39;facecolor&#39;</span><span class="p">:</span> <span class="s1">&#39;thistle&#39;</span><span class="p">,</span> <span class="s1">&#39;edgecolor&#39;</span><span class="p">:</span> <span class="n">arrowcolor</span><span class="p">,</span> <span class="s1">&#39;linewidth&#39;</span><span class="p">:</span> <span class="mi">2</span> <span class="p">}</span>
<span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span>
    <span class="n">s</span> <span class="o">=</span> <span class="s1">&#39;more likely&#39;</span><span class="p">,</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">abs_z_obs</span> <span class="o">-</span> <span class="mf">0.4</span><span class="p">,</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">half_ylim</span> <span class="o">+</span> <span class="mf">0.04</span><span class="p">,</span>
    <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;right&#39;</span><span class="p">,</span>
    <span class="n">va</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span>
    <span class="n">size</span> <span class="o">=</span> <span class="mi">12</span><span class="p">,</span>
    <span class="n">bbox</span> <span class="o">=</span> <span class="p">{</span> <span class="s1">&#39;boxstyle&#39;</span><span class="p">:</span> <span class="s1">&#39;larrow&#39;</span><span class="p">,</span> <span class="s1">&#39;facecolor&#39;</span><span class="p">:</span> <span class="s1">&#39;thistle&#39;</span><span class="p">,</span> <span class="s1">&#39;edgecolor&#39;</span><span class="p">:</span> <span class="n">arrowcolor</span><span class="p">,</span> <span class="s1">&#39;linewidth&#39;</span><span class="p">:</span> <span class="mi">2</span> <span class="p">}</span>
<span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span>
    <span class="n">s</span> <span class="o">=</span> <span class="s1">&#39;more likely&#39;</span><span class="p">,</span>
    <span class="n">x</span> <span class="o">=</span> <span class="o">-</span><span class="n">abs_z_obs</span> <span class="o">+</span> <span class="mf">0.4</span><span class="p">,</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">half_ylim</span> <span class="o">-</span> <span class="mf">0.04</span><span class="p">,</span>
    <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">,</span>
    <span class="n">va</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span>
    <span class="n">size</span> <span class="o">=</span> <span class="mi">12</span><span class="p">,</span>
    <span class="n">bbox</span> <span class="o">=</span> <span class="p">{</span> <span class="s1">&#39;boxstyle&#39;</span><span class="p">:</span> <span class="s1">&#39;rarrow&#39;</span><span class="p">,</span> <span class="s1">&#39;facecolor&#39;</span><span class="p">:</span> <span class="s1">&#39;thistle&#39;</span><span class="p">,</span> <span class="s1">&#39;edgecolor&#39;</span><span class="p">:</span> <span class="n">arrowcolor</span><span class="p">,</span> <span class="s1">&#39;linewidth&#39;</span><span class="p">:</span> <span class="mi">2</span> <span class="p">}</span>
<span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span>
    <span class="n">s</span> <span class="o">=</span> <span class="s1">&#39;less likely&#39;</span><span class="p">,</span>
    <span class="n">x</span> <span class="o">=</span> <span class="o">-</span><span class="n">abs_z_obs</span> <span class="o">-</span> <span class="mf">0.4</span><span class="p">,</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">half_ylim</span><span class="p">,</span>
    <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;right&#39;</span><span class="p">,</span>
    <span class="n">va</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span>
    <span class="n">size</span> <span class="o">=</span> <span class="mi">12</span><span class="p">,</span>
    <span class="n">bbox</span> <span class="o">=</span> <span class="p">{</span> <span class="s1">&#39;boxstyle&#39;</span><span class="p">:</span> <span class="s1">&#39;larrow&#39;</span><span class="p">,</span> <span class="s1">&#39;facecolor&#39;</span><span class="p">:</span> <span class="s1">&#39;thistle&#39;</span><span class="p">,</span> <span class="s1">&#39;edgecolor&#39;</span><span class="p">:</span> <span class="n">arrowcolor</span><span class="p">,</span> <span class="s1">&#39;linewidth&#39;</span><span class="p">:</span> <span class="mi">2</span> <span class="p">}</span>
<span class="p">)</span>

<span class="c1"># set up legend, y-axis label, and title</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper left&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Density&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Likelihood of Observing $Z_</span><span class="si">{obs}</span><span class="s1">$ (Or a More Extreme Value) Under $H_</span><span class="si">{0}</span><span class="s1">$&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/33524cc7a421c13f18dc674940a93bf1424d9173b8f4d243b9426356bef64837.png" src="../_images/33524cc7a421c13f18dc674940a93bf1424d9173b8f4d243b9426356bef64837.png" />
</div>
</div>
<p>Let’s see what this <span class="math notranslate nohighlight">\(P\)</span>-value is:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="n">scipy</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">cdf</span><span class="p">(</span><span class="n">z_obs</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.1619277283048255
</pre></div>
</div>
</div>
</div>
<p>This <span class="math notranslate nohighlight">\(P\)</span>-value is fairly large (<span class="math notranslate nohighlight">\(&gt;0.05\)</span>), indicating that if the null hypothesis is true, it’s not unlikely that we would observe a difference of 4% in our sample. So we fail to reject the null hypothesis because we do not find evidence in our data of a difference of high trust in scientists between men and women in the United States.</p>
</section>
<section id="using-python-for-the-test">
<h2>Using Python for the test<a class="headerlink" href="#using-python-for-the-test" title="Permalink to this headline">#</a></h2>
<p>Of course, we’re here to see how to perform these tests using Python code! The function to perform the test is the same as the one from the previous section, except this time the arguments <code class="docutils literal notranslate"><span class="pre">count</span></code> and <code class="docutils literal notranslate"><span class="pre">nobs</span></code> each take a list containing the relevant information from both of our samples. We have changed the value of the argument <code class="docutils literal notranslate"><span class="pre">alternative</span></code> to account for the fact that we are performing a <code class="docutils literal notranslate"><span class="pre">two-sided</span></code> test.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">p0</span> <span class="o">=</span> <span class="mi">0</span> <span class="c1"># proportion under null hypothesis</span>
<span class="p">(</span><span class="n">stat</span><span class="p">,</span> <span class="n">pval</span><span class="p">)</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">proportion</span><span class="o">.</span><span class="n">proportions_ztest</span><span class="p">(</span>
    <span class="n">count</span> <span class="o">=</span> <span class="p">[</span>
        <span class="n">count_m</span><span class="p">,</span> <span class="c1"># number of successes for sample 1</span>
        <span class="n">count_f</span><span class="p">,</span> <span class="c1"># number of successes for sample 2</span>
    <span class="p">],</span>
    <span class="n">nobs</span> <span class="o">=</span> <span class="p">[</span>
        <span class="n">nobs_m</span><span class="p">,</span> <span class="c1"># number of observations for sample 1</span>
        <span class="n">nobs_f</span><span class="p">,</span> <span class="c1"># number of observations for sample 2</span>
    <span class="p">],</span>
    <span class="n">value</span> <span class="o">=</span> <span class="n">p0</span><span class="p">,</span>
    <span class="n">alternative</span> <span class="o">=</span> <span class="s2">&quot;two-sided&quot;</span><span class="p">,</span>
    <span class="n">prop_var</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="c1"># use pooled sample proportion to calculate variance for test statistic</span>
<span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Z-test for difference of two proportions: test statistic is </span><span class="si">{</span><span class="n">stat</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">, P-value is </span><span class="si">{</span><span class="n">pval</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Z-test for difference of two proportions: test statistic is -1.399, P-value is 0.162.
</pre></div>
</div>
</div>
</div>
<p>Again, these values match up with what we did before, so the conclusion is the same!</p>
</section>
<section id="exercises">
<h2>Exercises<a class="headerlink" href="#exercises" title="Permalink to this headline">#</a></h2>
<section id="exercise-1">
<h3>Exercise 1<a class="headerlink" href="#exercise-1" title="Permalink to this headline">#</a></h3>
<p>To get some practice, we are going to look at trust in scientists in a different country.</p>
<ol class="arabic simple">
<li><p>Pick another country (perhaps your country of origin or another country you are interested in) and filter the observations to just include responses from that country. For example, here is how to do that for the United States.</p></li>
</ol>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">wgm_usa</span> <span class="o">=</span> <span class="n">wgm</span><span class="p">[</span><span class="n">wgm</span><span class="p">[</span><span class="s1">&#39;Country&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;United States&quot;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<ol class="arabic simple" start="2">
<li><p>Make a hypothesis about the proportion of all the people in your chosen country that have <code class="docutils literal notranslate"><span class="pre">High</span> <span class="pre">trust</span></code> in scientists. For example, do you think it is over 20%? Under 15%? Make any hypothesis you like.</p></li>
<li><p>Choose a level of <span class="math notranslate nohighlight">\(\alpha\)</span>.</p></li>
<li><p>Compute the value of <span class="math notranslate nohighlight">\(\hat p\)</span>.</p></li>
<li><p>Run a hypothesis test using <code class="docutils literal notranslate"><span class="pre">statsmodels</span></code>.</p></li>
<li><p>Write your conlcusion in a complete sentence. Be sure to report the test statistic and the <span class="math notranslate nohighlight">\(P\)</span>-value. If you found a significant result, give a confidence interval for the proportion.</p></li>
</ol>
</section>
<section id="exercise-2">
<h3>Exercise 2<a class="headerlink" href="#exercise-2" title="Permalink to this headline">#</a></h3>
<ol class="arabic simple">
<li><p>Pick a second country of interest.</p></li>
<li><p>Write hypotheses to test whether the proportion of people in the first country with high trust in scientists is higher than the same proportion in the second country.</p></li>
<li><p>Choose a level of <span class="math notranslate nohighlight">\(\alpha\)</span>.</p></li>
<li><p>Run the hypothesis test using <code class="docutils literal notranslate"><span class="pre">statsmodels</span></code>.</p></li>
<li><p>Write your conlcusion in a complete sentence. Be sure to report the test statistic and the <span class="math notranslate nohighlight">\(P\)</span>-value. If you found a significant difference, give a confidence interval for the difference in proportions.</p></li>
</ol>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./Stat"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
                <footer class="bd-footer-article">
                  
<div class="footer-article-items footer-article__inner">
  
    <div class="footer-article-item"><!-- Previous / next buttons -->
<div class="prev-next-area">
</div></div>
  
</div>

                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#statistical-decision-making-the-hypothesis-test">Statistical Decision Making: The Hypothesis Test</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#the-wellcome-global-monitor-survey">The Wellcome Global Monitor Survey</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#making-a-hypothesis">Making a Hypothesis</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#how-much-evidence-do-we-need">How Much Evidence Do We Need?</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#the-test-statistic-using-data-to-decide">The Test Statistic: Using Data to Decide</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#making-a-decision">Making a Decision</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#difference-of-two-proportions">Difference of Two Proportions</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#using-python-for-the-test">Using Python for the test</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#exercises">Exercises</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-1">Exercise 1</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-2">Exercise 2</a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Paul Isihara and Thomas VanDrunen, Editors
</p>

  </div>
  
  <div class="footer-item">
    
  <p class="copyright">
    
      © Copyright 2022.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=e353d410970836974a52"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>